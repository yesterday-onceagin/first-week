(function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(a){return 0==a?0:0<a?1:-1});var l={subtract:function(a,c){return{x:a.x-c.x,y:a.y-c.y}},dotProduct:function(a,c){return a.x*c.x+a.y*c.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,c){return{x:a.x*c,y:a.y*c}}},p=Math.pow(2,-65),t=function(a,c){for(var b=[],d=c.length-1,k=2*d-1,v=[],e=[],g=[],r=[],m=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],h=0;h<=d;h++)v[h]=l.subtract(c[h],a);for(h=0;h<=d-1;h++)e[h]=l.subtract(c[h+
1],c[h]),e[h]=l.scale(e[h],3);for(h=0;h<=d-1;h++)for(var p=0;p<=d;p++)g[h]||(g[h]=[]),g[h][p]=l.dotProduct(e[h],v[p]);for(h=0;h<=k;h++)r[h]||(r[h]=[]),r[h].y=0,r[h].x=parseFloat(h)/k;k=d-1;for(v=0;v<=d+k;v++)for(e=Math.min(v,d),h=Math.max(0,v-k);h<=e;h++)j=v-h,r[h+j].y+=g[j][h]*m[j][h];d=c.length-1;r=q(r,2*d-1,b,0);k=l.subtract(a,c[0]);g=l.square(k);for(h=m=0;h<r;h++)k=l.subtract(a,n(c,d,b[h],null,null)),k=l.square(k),k<g&&(g=k,m=b[h]);k=l.subtract(a,c[d]);k=l.square(k);k<g&&(g=k,m=1);return{location:m,
distance:g}},q=function(a,c,b,d){var f=[],v=[],k=[],e=[],g=0,r,m;m=Math.sgn(a[0].y);for(var h=1;h<=c;h++)r=Math.sgn(a[h].y),r!=m&&g++,m=r;switch(g){case 0:return 0;case 1:if(64<=d)return b[0]=(a[0].x+a[c].x)/2,1;var x,g=a[0].y-a[c].y;r=a[c].x-a[0].x;m=a[0].x*a[c].y-a[c].x*a[0].y;h=max_distance_below=0;for(x=1;x<c;x++){var l=g*a[x].x+r*a[x].y+m;l>h?h=l:l<max_distance_below&&(max_distance_below=l)}x=r;h=1/(0*x-1*g)*(1*(m-h)-0*x);x=r;r=m-max_distance_below;g=1/(0*x-1*g)*(1*r-0*x);if(Math.max(h,g)-Math.min(h,
g)<p)return k=a[c].x-a[0].x,e=a[c].y-a[0].y,b[0]=0+1/(0*k-1*e)*1*(k*(a[0].y-0)-e*(a[0].x-0)),1}n(a,c,.5,f,v);a=q(f,c,k,d+1);c=q(v,c,e,d+1);for(d=0;d<a;d++)b[d]=k[d];for(d=0;d<c;d++)b[d+a]=e[d];return a+c},n=function(a,c,b,d,k){for(var f=[[]],e=0;e<=c;e++)f[0][e]=a[e];for(a=1;a<=c;a++)for(e=0;e<=c-a;e++)f[a]||(f[a]=[]),f[a][e]||(f[a][e]={}),f[a][e].x=(1-b)*f[a-1][e].x+b*f[a-1][e+1].x,f[a][e].y=(1-b)*f[a-1][e].y+b*f[a-1][e+1].y;if(null!=d)for(e=0;e<=c;e++)d[e]=f[e][0];if(null!=k)for(e=0;e<=c;e++)k[e]=
f[c-e][e];return f[c][0]},h={},b=function(a){var c=h[a];if(!c){var c=[],b=function(a){return function(c){return a}},d=function(){return function(a){return a}},e=function(){return function(a){return 1-a}},k=function(a){return function(c){for(var b=1,d=0;d<a.length;d++)b*=a[d](c);return b}};c.push(new function(){return function(c){return Math.pow(c,a)}});for(var g=1;g<a;g++){for(var r=[new b(a)],m=0;m<a-g;m++)r.push(new d);for(m=0;m<g;m++)r.push(new e);c.push(new k(r))}c.push(new function(){return function(c){return Math.pow(1-
c,a)}});h[a]=c}return c},g=function(a,c){for(var f=b(a.length-1),d=0,e=0,k=0;k<a.length;k++)d+=a[k].x*f[k](c),e+=a[k].y*f[k](c);return{x:d,y:e}},r=function(a,c){return Math.sqrt(Math.pow(a.x-c.x,2)+Math.pow(a.y-c.y,2))},m=function(a){return a[0].x==a[1].x&&a[0].y==a[1].y},e=function(a,c,b){if(m(a))return{point:a[0],location:c};for(var d=g(a,c),f=0,k=0<b?1:-1,e=null;f<Math.abs(b);)c+=.005*k,e=g(a,c),f+=r(e,d),d=e;return{point:e,location:c}},k=function(a,c){var b=g(a,c);c=g(a.slice(0,a.length-1),c);
a=c.y-b.y;b=c.x-b.x;return 0==a?Infinity:Math.atan(a/b)};this.jsBezier={distanceFromCurve:t,gradientAtPoint:k,gradientAtPointAlongCurveFrom:function(a,b,f){b=e(a,b,f);1<b.location&&(b.location=1);0>b.location&&(b.location=0);return k(a,b.location)},nearestPointOnCurve:function(a,b){a=t(a,b);return{point:n(b,b.length-1,a.location,null,null),location:a.location}},pointOnCurve:g,pointAlongCurveFrom:function(a,b,f){return e(a,b,f).point},perpendicularToCurveAt:function(a,b,f,d){b=e(a,b,null==d?0:d);a=
k(a,b.location);d=Math.atan(-1/a);a=f/2*Math.sin(d);f=f/2*Math.cos(d);return[{x:b.point.x+f,y:b.point.y+a},{x:b.point.x-f,y:b.point.y-a}]},locationAlongCurveFrom:function(a,b,f){return e(a,b,f).location},getLength:function(a){if(m(a))return 0;for(var b=g(a,0),f=0,d=0,k;1>d;)d+=.005,k=g(a,d),f+=r(k,b),b=k;return f}}}).call("undefined"!==typeof window?window:this);
(function(){var l=this.Biltong={},p=function(b,g,r){b="[object Array]"===Object.prototype.toString.call(b)?b:[b.x,b.y];g="[object Array]"===Object.prototype.toString.call(g)?g:[g.x,g.y];return r(b,g)},t=l.gradient=function(b,g){return p(b,g,function(b,g){return g[0]==b[0]?g[1]>b[1]?Infinity:-Infinity:g[1]==b[1]?g[0]>b[0]?0:-0:(g[1]-b[1])/(g[0]-b[0])})};l.normal=function(b,g){return-1/t(b,g)};l.lineLength=function(b,g){return p(b,g,function(b,g){return Math.sqrt(Math.pow(g[1]-b[1],2)+Math.pow(g[0]-
b[0],2))})};var q=l.quadrant=function(b,g){return p(b,g,function(b,g){return g[0]>b[0]?g[1]>b[1]?2:1:g[0]==b[0]?g[1]>b[1]?2:1:g[1]>b[1]?3:4})};l.theta=function(b,g){return p(b,g,function(b,g){var e=t(b,g),e=Math.atan(e);b=q(b,g);if(4==b||3==b)e+=Math.PI;0>e&&(e+=2*Math.PI);return e})};l.intersects=function(b,g){var r=b.x,h=b.x+b.w,e=b.y;b=b.y+b.h;var k=g.x,a=g.x+g.w,c=g.y;g=g.y+g.h;return r<=k&&k<=h&&e<=c&&c<=b||r<=a&&a<=h&&e<=c&&c<=b||r<=k&&k<=h&&e<=g&&g<=b||r<=a&&k<=h&&e<=g&&g<=b||k<=r&&r<=a&&c<=
e&&e<=g||k<=h&&h<=a&&c<=e&&e<=g||k<=r&&r<=a&&c<=b&&b<=g||k<=h&&r<=a&&c<=b&&b<=g};l.encloses=function(b,g,r){var h=b.x,e=b.x+b.w,k=b.y;b=b.y+b.h;var a=g.x,c=g.x+g.w,f=g.y;g=g.y+g.h;return(r?h<=a&&e>=c:h<a&&e>c)&&(r?k<=f&&b>=g:k<f&&b>g)};var n=[null,[1,-1],[1,1],[-1,1],[-1,-1]],h=[null,[-1,-1],[-1,1],[1,1],[1,-1]];l.pointOnLine=function(b,g,r){var m=t(b,g);g=q(b,g);g=0<r?n[g]:h[g];m=Math.atan(m);return{x:b.x+Math.abs(r*Math.cos(m))*g[0],y:b.y+Math.abs(r*Math.sin(m))*g[1]}};l.perpendicularLineTo=function(b,
g,r){b=t(b,g);var h=Math.atan(-1/b);b=r/2*Math.sin(h);r=r/2*Math.cos(h);return[{x:g.x+r,y:g.y+b},{x:g.x-r,y:g.y-b}]}}).call("undefined"!==typeof window?window:this);
(function(){var l=-1<navigator.userAgent.toLowerCase().indexOf("android"),p=function(a,b,c){c=c||a.parentNode;b=c.querySelectorAll(b);for(c=0;c<b.length;c++)if(b[c]===a)return!0;return!1},t=function(a){return"string"==typeof a||a.constructor===String?document.getElementById(a):a},q=function(a,b,c,d){if(d){if("undefined"!==typeof a.path)return{path:a.path,end:a.path.indexOf(c)};var f={path:[],end:-1},k=function(a){f.path.push(a);a===c?f.end=f.path.length-1:null!=a.parentNode&&k(a.parentNode)};k(b);
return f}return{path:[b],end:1}},n=function(a,b){for(var c=0,d=a.length;c<d&&a[c]!=b;c++);c<a.length&&a.splice(c,1)},h=1,b=function(a,b,c){var d=h++;a.__ta=a.__ta||{};a.__ta[b]=a.__ta[b]||{};a.__ta[b][d]=c;return c.__tauid=d},g=function(a,b,c,d){if(null==a)return c;var f=a.split(","),k=function(d){k.__tauid=c.__tauid;var e,v=q(d,d.srcElement||d.target,b,null!=a);if(-1!=v.end)for(var g=0;g<v.end;g++){e=v.path[g];for(var u=0;u<f.length;u++)p(e,f[u],b)&&c.apply(e,arguments)}};r(c,d,k);return k},r=function(a,
b,c){a.__taExtra=a.__taExtra||[];a.__taExtra.push([b,c])},m=function(a,b,c,f){if(d&&v[b]){var k=g(f,a,c,v[b]);D(a,v[b],k,c)}"focus"===b&&null==a.getAttribute("tabindex")&&a.setAttribute("tabindex","1");D(a,b,g(f,a,c,b),c)},e=function(a,b,c,d){null==a.__taSmartClicks&&(m(a,"mousedown",function(b){a.__tad=B(b)},d),m(a,"mouseup",function(b){a.__tau=B(b)},d),m(a,"click",function(b){if(a.__tad&&a.__tau&&a.__tad[0]===a.__tau[0]&&a.__tad[1]===a.__tau[1])for(var c=0;c<a.__taSmartClicks.length;c++)a.__taSmartClicks[c].apply(b.srcElement||
b.target,[b])},d),a.__taSmartClicks=[]);a.__taSmartClicks.push(c);c.__taUnstore=function(){n(a.__taSmartClicks,c)}},k={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},a=function(a,b){return function(c,d,f,e){if("contextmenu"==d&&u)m(c,d,f,e);else{if(null==c.__taTapHandler){var v=c.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},g=function(){v.down=!1},r=function(){v.taps=0};m(c,"mousedown",function(d){var f=d.srcElement||d.target;d=
q(d,f,c,null!=e);for(var k=!1,u=0;u<d.end&&!k;u++)for(var f=d.path[u],h=0;h<v.downSelectors.length;h++)if(null==v.downSelectors[h]||p(f,v.downSelectors[h],c)){v.down=!0;setTimeout(g,a);setTimeout(r,b);k=!0;break}});m(c,"mouseup",function(a){if(v.down){var b=a.srcElement||a.target,d;v.taps++;var f=C(a).length,e;for(e in k)if(k.hasOwnProperty(e)&&(d=k[e],d.touches===f&&(1===d.taps||d.taps===v.taps)))for(var u=0;u<v[e].length;u++){d=q(a,b,c,null!=v[e][u][1]);for(var g=0;g<d.end;g++)if(b=d.path[g],null==
v[e][u][1]||p(b,v[e][u][1],c)){v[e][u][0].apply(b,[a]);break}}}})}c.__taTapHandler.downSelectors.push(e);c.__taTapHandler[d].push([f,e]);f.__taUnstore=function(){n(c.__taTapHandler[d],f)}}}},c=function(a,b,c,d){for(var f in c.__tamee[a])c.__tamee[a].hasOwnProperty(f)&&c.__tamee[a][f].apply(d,[b])},f=function(){var a=[];return function(d,f,e,k){if(!d.__tamee){d.__tamee={over:!1,mouseenter:[],mouseexit:[]};var v=function(b){var f=b.srcElement||b.target;if(null==k&&f==d&&!d.__tamee.over||p(f,k,d)&&(null==
f.__tamee||!f.__tamee.over))c("mouseenter",b,d,f),f.__tamee=f.__tamee||{},f.__tamee.over=!0,a.push(f)},u=function(b){for(var f=b.srcElement||b.target,e=0;e<a.length;e++)f!=a[e]||p(b.relatedTarget||b.toElement,"*",f)||(f.__tamee.over=!1,a.splice(e,1),c("mouseexit",b,d,f))};D(d,"mouseover",g(k,d,v,"mouseover"),v);D(d,"mouseout",g(k,d,u,"mouseout"),u)}e.__taUnstore=function(){delete d.__tamee[f][e.__tauid]};b(d,f,e);d.__tamee[f][e.__tauid]=e}},d="ontouchstart"in document.documentElement,u="onmousedown"in
document.documentElement,v={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},H=function(){var a=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}(),w=-1<H&&9>H,M=function(a,b){if(null==a)return[0,0];a=C(a);a=a.item?a.item(0):a[0];return[a[b+"X"],a[b+"Y"]]},B=function(a){return null==a?[0,0]:w?[a.clientX+document.documentElement.scrollLeft,a.clientY+document.documentElement.scrollTop]:
M(a,"page")},C=function(a){return a.touches&&0<a.touches.length?a.touches:a.changedTouches&&0<a.changedTouches.length?a.changedTouches:a.targetTouches&&0<a.targetTouches.length?a.targetTouches:[a]},D=function(a,c,d,f){b(a,c,d);f.__tauid=d.__tauid;if(a.addEventListener)a.addEventListener(c,d,!1);else if(a.attachEvent){var e=c+d.__tauid;a["e"+e]=d;a[e]=function(){a["e"+e]&&a["e"+e](window.event)};a.attachEvent("on"+c,a[e])}},x=function(a,b,c){null!=c&&F(a,function(){var f=t(this);f.__ta&&f.__ta[b]&&
delete f.__ta[b][c.__tauid];if(c.__taExtra){for(var e=0;e<c.__taExtra.length;e++)x(f,c.__taExtra[e][0],c.__taExtra[e][1]);c.__taExtra.length=0}c.__taUnstore&&c.__taUnstore();null!=c.__tauid&&(f.removeEventListener?(f.removeEventListener(b,c,!1),d&&v[b]&&f.removeEventListener(v[b],c,!1)):this.detachEvent&&(e=b+c.__tauid,f[e]&&f.detachEvent("on"+b,f[e]),f[e]=null,f["e"+e]=null));c.__taTouchProxy&&x(a,c.__taTouchProxy[1],c.__taTouchProxy[0])})},F=function(a,b){if(null!=a){a="undefined"!==typeof Window&&
"unknown"!==typeof a.top&&a==a.top?[a]:"string"!==typeof a&&null==a.tagName&&null!=a.length?a:"string"===typeof a?document.querySelectorAll(a):[a];for(var c=0;c<a.length;c++)b.apply(a[c])}};this.Mottle=function(b){b=b||{};var c=b.clickThreshold||250,k=b.dblClickThreshold||450,g=new f,r=new a(c,k),h=b.smartClicks,n=function(a,b,c,d){null!=c&&F(a,function(){var a=t(this);h&&"click"===b?e(a,b,c,d):"tap"===b||"dbltap"===b||"contextmenu"===b?r(a,b,c,d):"mouseenter"===b||"mouseexit"==b?g(a,b,c,d):m(a,b,
c,d)})};this.remove=function(a){F(a,function(){var a=t(this);if(a.__ta)for(var b in a.__ta)if(a.__ta.hasOwnProperty(b))for(var c in a.__ta[b])a.__ta[b].hasOwnProperty(c)&&x(a,b,a.__ta[b][c]);a.parentNode&&a.parentNode.removeChild(a)});return this};this.on=function(a,b,c,d){n(arguments[0],arguments[1],arguments[arguments.length-1],4==arguments.length?arguments[2]:null);return this};this.off=function(a,b,c){x(a,b,c);return this};this.trigger=function(a,b,c,f){var e=u&&("undefined"===typeof MouseEvent||
null==c||c.constructor===MouseEvent),k=d&&!u&&v[b]?v[b]:b,g=!(d&&!u&&v[b]),r=B(c),h=M(c,"screen"),m=M(c,"client");F(a,function(){var a=t(this),u;c=c||{screenX:h[0],screenY:h[1],clientX:m[0],clientY:m[1]};var n={TouchEvent:function(b){var c=document.createTouch(window,a,0,r[0],r[1],h[0],h[1],m[0],m[1],0,0,0,0),d=document.createTouchList(c),f=document.createTouchList(c),c=document.createTouchList(c);b.initTouchEvent(k,!0,!0,window,null,h[0],h[1],m[0],m[1],!1,!1,!1,!1,d,f,c,1,0)},MouseEvents:function(b){b.initMouseEvent(k,
!0,!0,window,0,h[0],h[1],m[0],m[1],!1,!1,!1,!1,1,a);if(l){var c=document.createTouch(window,a,0,r[0],r[1],h[0],h[1],m[0],m[1],0,0,0,0);b.touches=b.targetTouches=b.changedTouches=document.createTouchList(c)}}};if(document.createEvent){var A=g||e||!d||!v[b]||l?"MouseEvents":"TouchEvent";u=document.createEvent(A);n[A](u);f&&(u.payload=f);a.dispatchEvent(u)}else document.createEventObject&&(u=document.createEventObject(),u.eventType=u.eventName=k,u.screenX=h[0],u.screenY=h[1],u.clientX=m[0],u.clientY=
m[1],f&&(u.payload=f),a.fireEvent("on"+k,u))});return this}};this.Mottle.consume=function(a,b){a.stopPropagation?a.stopPropagation():a.returnValue=!1;!b&&a.preventDefault&&a.preventDefault()};this.Mottle.pageLocation=B;this.Mottle.setForceTouchEvents=function(a){d=a};this.Mottle.setForceMouseEvents=function(a){u=a}}).call("undefined"===typeof window?this:window);
(function(){var l=function(a,b,c){return-1===a.indexOf(b)?(c?a.unshift(b):a.push(b),!0):!1},p=function(a,b){b=a.indexOf(b);-1!=b&&a.splice(b,1)},t=function(a){return null==a?!1:"string"===typeof a||a.constructor==String},q=function(a,b,c){c=c||a.parentNode;b=c.querySelectorAll(b);for(c=0;c<b.length;c++)if(b[c]===a)return!0;return!1},n=function(){var a=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}(),
h=-1<n&&9>n,b=9==n,g=function(a){if(h)return[a.clientX+document.documentElement.scrollLeft,a.clientY+document.documentElement.scrollTop];a=a.touches&&0<a.touches.length?a.touches:a.changedTouches&&0<a.changedTouches.length?a.changedTouches:a.targetTouches&&0<a.targetTouches.length?a.targetTouches:[a];a=a.item?a.item(0):a[0];return b?[a.pageX||a.clientX,a.pageY||a.clientY]:[a.pageX,a.pageY]},r={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",
active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy"},m="stop start drag drop over out beforeStart".split(" "),e=function(){},k=function(){return!0},a=function(a,b,c){for(var d=0;d<a.length;d++)a[d]!=c&&b(a[d])},c=function(b,c,d,f){a(b,function(a){a.setActive(c);c&&a.updatePosition();d&&a.setHover(f,c)})},f=function(a,b){if(null!=a){a=t(a)||null!=a.tagName||null==a.length?[a]:a;for(var c=0;c<a.length;c++)b.apply(a[c],[a[c]])}},
d=function(a){a.stopPropagation?(a.stopPropagation(),a.preventDefault()):a.returnValue=!1},u=function(a,b,c,d){this.params=b||{};this.el=a;this.params.addClass(this.el,this._class);this.uuid=B();var e=!0;this.setEnabled=function(a){e=a};this.isEnabled=function(){return e};this.toggleEnabled=function(){e=!e};this.setScope=function(a){this.scopes=a?a.split(/\s+/):[d]};this.addScope=function(a){var b={};f(this.scopes,function(a){b[a]=!0});f(a?a.split(/\s+/):[],function(a){b[a]=!0});this.scopes=[];for(var c in b)this.scopes.push(c)};
this.removeScope=function(a){var b={};f(this.scopes,function(a){b[a]=!0});f(a?a.split(/\s+/):[],function(a){delete b[a]});this.scopes=[];for(var c in b)this.scopes.push(c)};this.toggleScope=function(a){var b={};f(this.scopes,function(a){b[a]=!0});f(a?a.split(/\s+/):[],function(a){b[a]?delete b[a]:b[a]=!0});this.scopes=[];for(var c in b)this.scopes.push(c)};this.setScope(b.scope);return this.k=b.katavorio},v=function(){return!0},H=function(){return!1},w=function(a,b,f,e){this._class=f.draggable;var h=
u.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var m=[0,0],n=null,A=null,l=[0,0],p=!1,x=!1!==this.params.consumeStartEvent,w=this.el,M=this.params.clone,F=!1!==b.multipleDrop,C=!1,D=!0===b.ghostProxy?v:b.ghostProxy&&"function"===typeof b.ghostProxy?b.ghostProxy:H,K=b.snapThreshold||5,Z=function(a,b,c,d,f){d=d||K;f=f||K;var e=b*Math.floor(a[0]/b);b=e+b;var k=c*Math.floor(a[1]/c);c=k+c;return[Math.abs(a[0]-e)<=d?e:Math.abs(b-a[0])<=d?b:a[0],Math.abs(a[1]-k)<=f?k:Math.abs(c-
a[1])<=f?c:a[1]]};this.posses=[];this.posseRoles={};this.toGrid=function(a){return null==this.params.grid?a:Z(a,this.params.grid[0],this.params.grid[1])};this.snap=function(a,b){if(null!=w){a=a||(this.params.grid?this.params.grid[0]:50);b=b||(this.params.grid?this.params.grid[1]:50);var c=this.params.getPosition(w);this.params.setPosition(w,Z(c,a,b,a,b))}};this.setUseGhostProxy=function(a){D=a?v:H};var V,W=function(a){return!1===b.allowNegative?[Math.max(0,a[0]),Math.max(0,a[1])]:a},la=function(a){V=
"function"===typeof a?a:a?function(a){return W([Math.max(0,Math.min(ba.w-this.size[0],a[0])),Math.max(0,Math.min(ba.h-this.size[1],a[1]))])}.bind(this):function(a){return W(a)}}.bind(this);la("function"===typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment);this.setConstrain=function(a){la(a)};var aa;this.setRevert=function(a){aa=a};var ia=function(a){return"function"==typeof a?(a._katavorioId=B(),a._katavorioId):a},L={},O=this.setFilter=function(b,c){if(b){var d=
ia(b);L[d]=[function(c){var d=c.srcElement||c.target,f;t(b)?f=q(d,b,a):"function"===typeof b&&(f=b(c,a));return f},!1!==c]}};this.addFilter=O;this.removeFilter=function(a){delete L["function"==typeof a?a._katavorioId:a]};this.clearAllFilters=function(){L={}};this.canDrag=this.params.canDrag||k;var ba,I=[],U=[];this.downListener=function(a){var b,c;if((this.rightButtonCanDrag||3!==a.which&&2!==a.button)&&this.isEnabled()&&this.canDrag()){a:{for(b in L){c=L[b];var e=c[0](a);c[1]&&(e=!e);if(!e){b=!1;
break a}}b=!0}b&&(b=this.el,b=!q(a.srcElement||a.target,this.k.getInputFilterSelector(),b));if(b){if(M){w=this.el.cloneNode(!0);w.setAttribute("id",null);w.style.position="absolute";c=this.el.getBoundingClientRect();var e=document.body,k=document.documentElement;b=Math.round(c.top+(window.pageYOffset||k.scrollTop||e.scrollTop)-(k.clientTop||e.clientTop||0));c=Math.round(c.left+(window.pageXOffset||k.scrollLeft||e.scrollLeft)-(k.clientLeft||e.clientLeft||0));w.style.left=c+"px";w.style.top=b+"px";
document.body.appendChild(w)}else w=this.el;x&&d(a);m=g(a);this.params.bind(document,"mousemove",this.moveListener);this.params.bind(document,"mouseup",this.upListener);h.markSelection(this);h.markPosses(this);this.params.addClass(document.body,f.noSelect);X("beforeStart",{el:this.el,pos:n,e:a,drag:this})}else this.params.consumeFilteredEvents&&d(a)}}.bind(this);this.moveListener=function(a){if(m){if(!p&&!1!==X("start",{el:this.el,pos:n,e:a,drag:this})){if(!m)return;this.mark(!0);p=!0}if(m){U.length=
0;var b=g(a),c=b[0]-m[0],b=b[1]-m[1],d=this.params.ignoreZoom?1:h.getZoom(),c=c/d,b=b/d;this.moveBy(c,b,a);h.updateSelection(c,b,this);h.updatePosses(c,b,this)}}}.bind(this);this.upListener=function(a){m&&(m=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,f.noSelect),this.unmark(a),h.unmarkSelection(this,a),h.unmarkPosses(this,a),this.stop(a),h.notifySelectionDragStop(this,a),h.notifyPosseDragStop(this,
a),p=!1,M&&(w&&w.parentNode&&w.parentNode.removeChild(w),w=null),aa&&!0===aa(this.el,this.params.getPosition(this.el))&&(this.params.setPosition(this.el,n),X("revert",this.el)))}.bind(this);this.getFilters=function(){return L};this.abort=function(){null!=m&&this.upListener()};this.getDragElement=function(){return w||this.el};var E={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};b.events.start&&E.start.push(b.events.start);b.events.beforeStart&&E.beforeStart.push(b.events.beforeStart);
b.events.stop&&E.stop.push(b.events.stop);b.events.drag&&E.drag.push(b.events.drag);b.events.revert&&E.revert.push(b.events.revert);this.on=function(a,b){E[a]&&E[a].push(b)};this.off=function(a,b){if(E[a]){for(var c=[],d=0;d<E[a].length;d++)E[a][d]!==b&&c.push(E[a][d]);E[a]=c}};var X=function(a,b){if(E[a])for(var c=0;c<E[a].length;c++)try{E[a][c](b)}catch(ja){}};this.notifyStart=function(a){X("start",{el:this.el,pos:this.params.getPosition(w),e:a,drag:this})};this.stop=function(a,b){if(b||p){b=[];
var c=h.getSelection(),d=this.params.getPosition(w);if(1<c.length)for(var f=0;f<c.length;f++){var e=this.params.getPosition(c[f].el);b.push([c[f].el,{left:e[0],top:e[1]},c[f]])}else b.push([w,{left:d[0],top:d[1]},this]);X("stop",{el:w,pos:Y||d,finalPos:d,e:a,drag:this,selection:b})}};this.mark=function(a){n=this.params.getPosition(w);A=this.params.getPosition(w,!0);l=[A[0]-n[0],A[1]-n[1]];this.size=this.params.getSize(w);I=h.getMatchingDroppables(this);c(I,!0,!1,this);this.params.addClass(w,this.params.dragClass||
f.drag);var b=this.params.getSize(w.parentNode);ba={w:b[0],h:b[1]};a&&h.notifySelectionDragStart(this)};var Y;this.unmark=function(a,d){c(I,!1,!0,this);C&&D(this.el)?(Y=[w.offsetLeft,w.offsetTop],this.el.parentNode.removeChild(w),w=this.el):Y=null;this.params.removeClass(w,this.params.dragClass||f.drag);I.length=0;C=!1;if(!d)for(0<U.length&&Y&&b.setPosition(this.el,Y),d=0;d<U.length&&!0!==U[d].drop(this,a);d++);};this.moveBy=function(a,c,d){U.length=0;c=this.toGrid([n[0]+a,n[1]+c]);a=V(c,w);D(this.el)&&
(c[0]!=a[0]||c[1]!=a[1]?(C||(a=this.el.cloneNode(!0),b.addClass(a,r.ghostProxy),this.el.parentNode.appendChild(a),w=a,C=!0),a=c):C&&(this.el.parentNode.removeChild(w),w=this.el,C=!1));c={x:a[0]+l[0],y:a[1]+l[1],w:this.size[0],h:this.size[1]};var f=null;this.params.setPosition(w,a);for(var e=0;e<I.length;e++)this.params.intersects(c,{x:I[e].pagePosition[0],y:I[e].pagePosition[1],w:I[e].size[0],h:I[e].size[1]})&&(F||null==f||f==I[e].el)&&I[e].canDrop(this)?(f||(f=I[e].el),U.push(I[e]),I[e].setHover(this,
!0,d)):I[e].isHover()&&I[e].setHover(this,!1,d);X("drag",{el:this.el,pos:a,e:d,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.moveListener=this.upListener=this.downListener=null};this.params.bind(this.el,"mousedown",this.downListener);this.params.handle?O(this.params.handle,!1):O(this.params.filter,this.params.filterExclude)},M=function(a,
b,c,d){this._class=c.droppable;this.params=b||{};this._activeClass=this.params.activeClass||c.active;this._hoverClass=this.params.hoverClass||c.hover;u.apply(this,arguments);var f=!1;this.allowLoopback=!1!==this.params.allowLoopback;this.setActive=function(a){this.params[a?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.pagePosition=this.params.getPosition(this.el,!0);this.size=this.params.getSize(this.el)};this.canDrop=
this.params.canDrop||function(a){return!0};this.isHover=function(){return f};this.setHover=function(a,b,c){if(b||null==this.el._katavorioDragHover||this.el._katavorioDragHover==a.el._katavorio){this.params[b?"addClass":"removeClass"](this.el,this._hoverClass);this.el._katavorioDragHover=b?a.el._katavorio:null;if(f!==b)this.params.events[b?"over":"out"]({el:this.el,e:c,drag:a,drop:this});f=b}};this.drop=function(a,b){return this.params.events.drop({drag:a,e:b,drop:this})};this.destroy=function(){f=
this._hoverClass=this._activeClass=this._class=null}},B=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})},C=function(a){if(null==a)return null;a="string"===typeof a||a.constructor==String?document.getElementById(a):a;if(null==a)return null;a._katavorio=a._katavorio||B();return a};this.Katavorio=function(b){var c=[],d={};this._dragsByScope={};this._dropsByScope={};var k=1,v=function(a,b){f(a,function(a){for(var c=
0;c<a.scopes.length;c++)b[a.scopes[c]]=b[a.scopes[c]]||[],b[a.scopes[c]].push(a)})},u=function(a,c){var d=0;f(a,function(a){for(var f=0;f<a.scopes.length;f++)if(c[a.scopes[f]]){var e=b.indexOf(c[a.scopes[f]],a);-1!=e&&(c[a.scopes[f]].splice(e,1),d++)}});return 0<d};this.getMatchingDroppables=function(a){for(var b=[],c={},d=0;d<a.scopes.length;d++){var f=this._dropsByScope[a.scopes[d]];if(f)for(var e=0;e<f.length;e++)!f[e].canDrop(a)||c[f[e].uuid]||!f[e].allowLoopback&&f[e].el===a.el||(c[f[e].uuid]=
!0,b.push(f[e]))}return b};var g=function(a){a=a||{};var c={events:{}},d;for(d in b)c[d]=b[d];for(d in a)c[d]=a[d];for(d=0;d<m.length;d++)c.events[m[d]]=a[m[d]]||e;c.katavorio=this;return c}.bind(this),h=function(a,b){for(var c=0;c<m.length;c++)if(b[m[c]])a.on(m[c],b[m[c]])}.bind(this),n={},q=b.css||{},H=b.scope||"katavorio-drag-scope",B;for(B in r)n[B]=r[B];for(B in q)n[B]=q[B];var ha=b.inputFilterSelector||"input,textarea,select,button,option";this.getInputFilterSelector=function(){return ha};this.setInputFilterSelector=
function(a){ha=a;return this};this.draggable=function(a,c){var d=[];f(a,function(a){a=C(a);if(null!=a)if(null==a._katavorioDrag){var f=g(c);a._katavorioDrag=new w(a,f,n,H);v(a._katavorioDrag,this._dragsByScope);d.push(a._katavorioDrag);b.addClass(a,n.draggable)}else h(a._katavorioDrag,c)}.bind(this));return d};this.droppable=function(a,c){var d=[];f(a,function(a){a=C(a);if(null!=a){var f=new M(a,g(c),n,H);a._katavorioDrop=a._katavorioDrop||[];a._katavorioDrop.push(f);v(f,this._dropsByScope);d.push(f);
b.addClass(a,n.droppable)}}.bind(this));return d};this.select=function(a){f(a,function(){var a=C(this);a&&a._katavorioDrag&&!d[a._katavorio]&&(c.push(a._katavorioDrag),d[a._katavorio]=[a,c.length-1],b.addClass(a,n.selected))});return this};this.deselect=function(a){f(a,function(){var a=C(this);if(a&&a._katavorio&&d[a._katavorio]){for(var f=[],e=0;e<c.length;e++)c[e].el!==a&&f.push(c[e]);c=f;delete d[a._katavorio];b.removeClass(a,n.selected)}});return this};this.deselectAll=function(){for(var a in d)b.removeClass(d[a][0],
n.selected);c.length=0;d={}};this.markSelection=function(b){a(c,function(a){a.mark()},b)};this.markPosses=function(b){b.posses&&f(b.posses,function(c){b.posseRoles[c]&&K[c]&&a(K[c].members,function(a){a.mark()},b)})};this.unmarkSelection=function(b,d){a(c,function(a){a.unmark(d)},b)};this.unmarkPosses=function(b,c){b.posses&&f(b.posses,function(d){b.posseRoles[d]&&K[d]&&a(K[d].members,function(a){a.unmark(c,!0)},b)})};this.getSelection=function(){return c.slice(0)};this.updateSelection=function(b,
d,f){a(c,function(a){a.moveBy(b,d)},f)};var D=function(b,c){c.posses&&f(c.posses,function(d){c.posseRoles[d]&&K[d]&&a(K[d].members,function(a){b(a)},c)})};this.updatePosses=function(a,b,c){D(function(c){c.moveBy(a,b)},c)};this.notifyPosseDragStop=function(a,b){D(function(a){a.stop(b,!0)},a)};this.notifySelectionDragStop=function(b,d){a(c,function(a){a.stop(d,!0)},b)};this.notifySelectionDragStart=function(b,d){a(c,function(a){a.notifyStart(d)},b)};this.setZoom=function(a){k=a};this.getZoom=function(){return k};
var S=function(a,b,c,d){f(a,function(a){u(a,c);a[d](b);v(a,c)})};f(["set","add","remove","toggle"],function(a){this[a+"Scope"]=function(b,c){S(b._katavorioDrag,c,this._dragsByScope,a+"Scope");S(b._katavorioDrop,c,this._dropsByScope,a+"Scope")}.bind(this);this[a+"DragScope"]=function(b,c){S(b.constructor===w?b:b._katavorioDrag,c,this._dragsByScope,a+"Scope")}.bind(this);this[a+"DropScope"]=function(b,c){S(b.constructor===M?b:b._katavorioDrop,c,this._dropsByScope,a+"Scope")}.bind(this)}.bind(this));
this.snapToGrid=function(b,c){for(var d in this._dragsByScope)a(this._dragsByScope[d],function(a){a.snap(b,c)})};this.getDragsForScope=function(a){return this._dragsByScope[a]};this.getDropsForScope=function(a){return this._dropsByScope[a]};var T=function(a,b,c){a=C(a);a[b]&&(u(a[b],c)&&f(a[b],function(a){a.destroy()}),delete a[b])};this.elementRemoved=function(a){this.destroyDraggable(a);this.destroyDroppable(a)};this.destroyDraggable=function(a){T(a,"_katavorioDrag",this._dragsByScope)};this.destroyDroppable=
function(a){T(a,"_katavorioDrop",this._dropsByScope)};this.reset=function(){this._dragsByScope={};this._dropsByScope={};c=[];d={};K={}};var K={},Z=function(a,b,c){var d=t(b)?b:b.id,e=t(b)?!0:!1!==b.active,k=K[d]||function(){var a={name:d,members:[]};return K[d]=a}();f(a,function(a){!a._katavorioDrag||c&&null!=a._katavorioDrag.posseRoles[k.name]||(l(k.members,a._katavorioDrag),l(a._katavorioDrag.posses,k.name),a._katavorioDrag.posseRoles[k.name]=e)});return k};this.addToPosse=function(a,b){for(var c=
[],d=1;d<arguments.length;d++)c.push(Z(a,arguments[d]));return 1==c.length?c[0]:c};this.setPosse=function(a,b){for(var c=[],d=1;d<arguments.length;d++)c.push(Z(a,arguments[d],!0).name);f(a,function(a){if(a._katavorioDrag){for(var b=a._katavorioDrag.posses,d=[],f=0;f<b.length;f++)-1==c.indexOf(b[f])&&d.push(b[f]);Array.prototype.push.apply([],a._katavorioDrag.posses);for(b=0;b<d.length;b++)this.removeFromPosse(a,d[b])}}.bind(this));return 1==c.length?c[0]:c};this.removeFromPosse=function(a,b){if(2>
arguments.length)throw new TypeError("No posse id provided for remove operation");for(var c=1;c<arguments.length;c++)b=arguments[c],f(a,function(a){if(a._katavorioDrag&&a._katavorioDrag.posses){var c=a._katavorioDrag;f(b,function(a){p(K[a].members,c);p(c.posses,a);delete c.posseRoles[a]})}})};this.removeFromAllPosses=function(a){f(a,function(a){if(a._katavorioDrag&&a._katavorioDrag.posses){var b=a._katavorioDrag;f(b.posses,function(a){p(K[a].members,b)});b.posses.length=0;b.posseRoles={}}})};this.setPosseState=
function(a,b,c){var d=K[b];d&&f(a,function(a){a._katavorioDrag&&a._katavorioDrag.posses&&(a._katavorioDrag.posseRoles[d.name]=c)})}}}).call("undefined"!==typeof window?window:this);
(function(){var l=function(b){return"[object Array]"===Object.prototype.toString.call(b)},p=function(b){return"string"===typeof b},t=function(b){return"boolean"===typeof b},q=function(b){return null==b?!1:"[object Object]"===Object.prototype.toString.call(b)},n=function(b){return"[object Date]"===Object.prototype.toString.call(b)},h=function(b){return"[object Function]"===Object.prototype.toString.call(b)},b=this,g=b.jsPlumbUtil={isArray:l,isString:p,isBoolean:t,isNull:function(b){return null==b},
isObject:q,isDate:n,isFunction:h,isEmpty:function(b){for(var g in b)if(b.hasOwnProperty(g))return!1;return!0},isNumber:function(b){return"[object Number]"===Object.prototype.toString.call(b)},clone:function(b){if(p(b))return""+b;if(t(b))return!!b;if(n(b))return new Date(b.getTime());if(h(b))return b;if(l(b)){for(var g=[],e=0;e<b.length;e++)g.push(this.clone(b[e]));return g}if(q(b)){g={};for(e in b)g[e]=this.clone(b[e]);return g}return b},merge:function(b,g,e){var k={},a;e=e||[];for(a=0;a<e.length;a++)k[e[a]]=
!0;e=this.clone(b);for(a in g)if(null==e[a])e[a]=g[a];else if(p(g[a])||t(g[a]))k[a]?(b=[],b.push.apply(b,l(e[a])?e[a]:[e[a]]),b.push.apply(b,l(g[a])?g[a]:[g[a]]),e[a]=b):e[a]=g[a];else if(l(g[a]))b=[],l(e[a])&&b.push.apply(b,e[a]),b.push.apply(b,g[a]),e[a]=b;else if(q(g[a])){q(e[a])||(e[a]={});for(var c in g[a])e[a][c]=g[a][c]}return e},replace:function(b,g,e){if(null!=b){var k=b;g.replace(/([^\.])+/g,function(a,b,f,d){var c=a.match(/([^\[0-9]+){1}(\[)([0-9+])/);b=function(){var a;(a=k[c[1]])||(k[c[1]]=
[],a=k[c[1]]);return a};f+a.length>=d.length?c?b()[c[3]]=e:k[a]=e:(c?(a=b(),(f=a[c[3]])||(a[c[3]]={},f=a[c[3]])):(f=k[a])||(k[a]={},f=k[a]),k=f)});return b}},functionChain:function(b,g,e){for(var k=0;k<e.length;k++){var a=e[k][0][e[k][1]].apply(e[k][0],e[k][2]);if(a===g)return a}return b},populate:function(b,g,e){var k=function(a){if(null!=a){if(p(a)){var b=a.match(/(\${.*?})/g);if(null!=b)for(var f=0;f<b.length;f++){var d=g[b[f].substring(2,b[f].length-1)]||"";null!=d&&(a=a.replace(b[f],d))}return a}if(!h(a)||
null!=e&&0!==(a.name||"").indexOf(e)){if(l(a)){b=[];for(f=0;f<a.length;f++)b.push(k(a[f]));return b}if(q(a)){b={};for(f in a)b[f]=k(a[f]);return b}return a}return a(g)}};return k(b)},findWithFunction:function(b,g){if(b)for(var e=0;e<b.length;e++)if(g(b[e]))return e;return-1},removeWithFunction:function(b,h){h=g.findWithFunction(b,h);-1<h&&b.splice(h,1);return-1!=h},remove:function(b,g){g=b.indexOf(g);-1<g&&b.splice(g,1);return-1!=g},addWithFunction:function(b,h,e){-1==g.findWithFunction(b,e)&&b.push(h)},
addToList:function(b,g,e,k){var a=b[g];null==a&&(a=[],b[g]=a);a[k?"unshift":"push"](e);return a},suggest:function(b,g,e){return-1===b.indexOf(g)?(e?b.unshift(g):b.push(g),!0):!1},extend:function(b,g,e){var k;g=l(g)?g:[g];for(k=0;k<g.length;k++)for(var a in g[k].prototype)g[k].prototype.hasOwnProperty(a)&&(b.prototype[a]=g[k].prototype[a]);var c=function(a,b){return function(){for(k=0;k<g.length;k++)g[k].prototype[a]&&g[k].prototype[a].apply(this,arguments);return b.apply(this,arguments)}};a=function(a){for(var d in a)b.prototype[d]=
c(d,a[d])};if(2<arguments.length)for(k=2;k<arguments.length;k++)a(arguments[k]);return b},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var g=16*Math.random()|0;return("x"==b?g:g&3|8).toString(16)})},logEnabled:!0,log:function(){},wrap:function(b,h,e){b=b||function(){};h=h||function(){};return function(){var k=null;try{k=h.apply(this,arguments)}catch(a){g.log("jsPlumb function failed : "+a)}if(null==e||k!==e)try{k=b.apply(this,arguments)}catch(a){g.log("wrapped function failed : "+
a)}return k}}};g.EventGenerator=function(){var h={},m=!1,e={ready:!0};this.bind=function(e,a,c){var f=function(d){g.addToList(h,d,a,c);a.__jsPlumb=a.__jsPlumb||{};a.__jsPlumb[b.jsPlumbUtil.uuid()]=d};if("string"===typeof e)f(e);else if(null!=e.length)for(var d=0;d<e.length;d++)f(e[d]);return this};this.fire=function(b,a,c){if(!m&&h[b]){var f=h[b].length,d=0,k=!1,v=null;if(!this.shouldFireEvent||this.shouldFireEvent(b,a,c))for(;!k&&d<f&&!1!==v;){if(e[b])h[b][d].apply(this,[a,c]);else try{v=h[b][d].apply(this,
[a,c])}catch(H){g.log("jsPlumb: fire failed for event "+b+" : "+H)}d++;if(null==h||null==h[b])k=!0}}return this};this.unbind=function(b,a){if(0===arguments.length)h={};else if(1===arguments.length)if("string"===typeof b)delete h[b];else{if(b.__jsPlumb){var c,f;for(f in b.__jsPlumb)c=b.__jsPlumb[f],g.remove(h[c]||[],b)}}else 2===arguments.length&&g.remove(h[b]||[],a);return this};this.getListener=function(b){return h[b]};this.setSuspendEvents=function(b){m=b};this.isSuspendEvents=function(){return m};
this.silently=function(e){this.setSuspendEvents(!0);try{e()}catch(a){b.jsPlumbUtil.log("Cannot execute silent function "+a)}this.setSuspendEvents(!1)};this.cleanupListeners=function(){for(var b in h)h[b]=null}};g.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}}}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumbUtil;l.matchesSelector=function(l,t,q){q=q||l.parentNode;t=q.querySelectorAll(t);for(q=0;q<t.length;q++)if(t[q]===l)return!0;return!1};l.consume=function(l,t){l.stopPropagation?l.stopPropagation():l.returnValue=!1;!t&&l.preventDefault&&l.preventDefault()};l.sizeElement=function(l,t,q,n,h){l&&(l.style.height=h+"px",l.height=h,l.style.width=n+"px",l.width=n,l.style.left=t+"px",l.style.top=q+"px")}}).call("undefined"!==typeof window?window:this);
(function(){var l=this,p=[],t,q=l.jsPlumbUtil,n=function(){return""+(new Date).getTime()},h=function(a){if(a._jsPlumb.paintStyle&&a._jsPlumb.hoverPaintStyle){var b={};d.extend(b,a._jsPlumb.paintStyle);d.extend(b,a._jsPlumb.hoverPaintStyle);delete a._jsPlumb.hoverPaintStyle;b.gradient&&a._jsPlumb.paintStyle.fillStyle&&delete b.gradient;a._jsPlumb.hoverPaintStyle=b}},b="tap dbltap click dblclick mouseover mouseout mousemove mousedown mouseup contextmenu".split(" "),g=function(a){return null==a?null:
a.split(" ")},r=function(a,b){b=q.isArray(b)||null!=b.length&&!q.isString(b)?b:[b];for(var c=0;c<b.length;c++)try{a.apply(b[c],[b[c]])}catch(w){q.log(".each iteration failed : "+w)}},m=function(a,b,c){if(a.getDefaultType){var d=a.getTypeDescriptor(),f={},e=a.getDefaultType(),k=q.merge({},e),v;for(v in e)f[v]="__default";e=0;for(v=a._jsPlumb.types.length;e<v;e++){var g=a._jsPlumb.types[e];if("__default"!==g){var h=a._jsPlumb.instance.getType(g,d);if(null!=h){var k=q.merge(k,h,["cssClass"]),u=void 0,
m=f;for(u in h)m[u]=g}}}b&&(k=q.populate(k,b,"_"));a.applyType(k,c,f);c||a.repaint()}},e=l.jsPlumbUIComponent=function(a){q.EventGenerator.apply(this,arguments);var b=arguments,c=this.idPrefix+(new Date).getTime();this._jsPlumb={instance:a._jsPlumb,parameters:a.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:a.beforeDetach,beforeDrop:a.beforeDrop,overlayPlacements:[],hoverClass:a.hoverClass||a._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}};this.cacheTypeItem=
function(a,b,c){this._jsPlumb.typeCache[c]=this._jsPlumb.typeCache[c]||{};this._jsPlumb.typeCache[c][a]=b};this.getCachedTypeItem=function(a,b){return this._jsPlumb.typeCache[b]?this._jsPlumb.typeCache[b][a]:null};this.getId=function(){return c};var f=a.overlays||[],e={};if(this.defaultOverlayKeys){for(var k=0;k<this.defaultOverlayKeys.length;k++)Array.prototype.push.apply(f,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[k]]||[]);for(k=0;k<f.length;k++){var g=d.convertToFullOverlaySpec(f[k]);
e[g[1].id]=g}}var h={overlays:e,parameters:a.parameters||{},scope:a.scope||this._jsPlumb.instance.getDefaultScope()};this.getDefaultType=function(){return h};this.appendToDefaultType=function(a){for(var b in a)h[b]=a[b]};if(a.events)for(k in a.events)this.bind(k,a.events[k]);this.clone=function(){var a=Object.create(this.constructor.prototype);this.constructor.apply(a,b);return a}.bind(this);this.isDetachAllowed=function(a){var b=!0;if(this._jsPlumb.beforeDetach)try{b=this._jsPlumb.beforeDetach(a)}catch(P){q.log("jsPlumb: beforeDetach callback failed",
P)}return b};this.isDropAllowed=function(a,b,c,d,f,e,k){var v=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:a,targetId:b,scope:c,connection:d,dropEndpoint:f,source:e,target:k});if(this._jsPlumb.beforeDrop)try{v=this._jsPlumb.beforeDrop({sourceId:a,targetId:b,scope:c,connection:d,dropEndpoint:f,source:e,target:k})}catch(ea){q.log("jsPlumb: beforeDrop callback failed",ea)}return v};var u=[];this.setListenerComponent=function(a){for(var b=0;b<u.length;b++)u[b][3]=a}},k=function(a,b){b=
a._jsPlumb.instance.getType(a._jsPlumb.types[b],a.getTypeDescriptor());null!=b&&b.cssClass&&a.canvas&&a._jsPlumb.instance.removeClass(a.canvas,b.cssClass)};q.extend(l.jsPlumbUIComponent,q.EventGenerator,{getParameter:function(a){return this._jsPlumb.parameters[a]},setParameter:function(a,b){this._jsPlumb.parameters[a]=b},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(a){this._jsPlumb.parameters=a},getClass:function(){return d.getClass(this.canvas)},hasClass:function(a){return d.hasClass(this.canvas,
a)},addClass:function(a){d.addClass(this.canvas,a)},removeClass:function(a){d.removeClass(this.canvas,a)},updateClasses:function(a,b){d.updateClasses(this.canvas,a,b)},setType:function(a,b,c){this.clearTypes();this._jsPlumb.types=g(a)||[];m(this,b,c)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(a,b){m(this,a,b)},hasType:function(a){return-1!=this._jsPlumb.types.indexOf(a)},addType:function(a,b,c){a=g(a);var d=!1;if(null!=a){for(var f=0,e=a.length;f<e;f++)this.hasType(a[f])||
(this._jsPlumb.types.push(a[f]),d=!0);d&&m(this,b,c)}},removeType:function(a,b,c){a=g(a);var d=!1,f=function(a){a=this._jsPlumb.types.indexOf(a);return-1!=a?(k(this,a),this._jsPlumb.types.splice(a,1),!0):!1}.bind(this);if(null!=a){for(var e=0,v=a.length;e<v;e++)d=f(a[e])||d;d&&m(this,b,c)}},clearTypes:function(a,b){for(var c=this._jsPlumb.types.length,d=0;d<c;d++)k(this,0),this._jsPlumb.types.splice(0,1);m(this,a,b)},toggleType:function(a,b,c){a=g(a);if(null!=a){for(var d=0,f=a.length;d<f;d++){var e=
this._jsPlumb.types.indexOf(a[d]);-1!=e?(k(this,e),this._jsPlumb.types.splice(e,1)):this._jsPlumb.types.push(a[d])}m(this,b,c)}},applyType:function(a,b){this.setPaintStyle(a.paintStyle,b);this.setHoverPaintStyle(a.hoverPaintStyle,b);if(a.parameters)for(var c in a.parameters)this.setParameter(c,a.parameters[c]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(a,b){this._jsPlumb.paintStyle=a;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;h(this);b||this.repaint()},
getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(a,b){this._jsPlumb.hoverPaintStyle=a;h(this);b||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(a){if(a||null==this.typeId)this.cleanupListeners(),this._jsPlumb=this.clone=null},isHover:function(){return this._jsPlumb.hover},setHover:function(a,b,c){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=
a;if(null!=this.canvas){if(null!=this._jsPlumb.instance.hoverClass){var d=a?"addClass":"removeClass";this._jsPlumb.instance[d](this.canvas,this._jsPlumb.instance.hoverClass)}if(null!=this._jsPlumb.hoverClass)this._jsPlumb.instance[d](this.canvas,this._jsPlumb.hoverClass)}null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=a?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(c=c||n(),this.repaint({timestamp:c,recalc:!1})));if(this.getAttachedElements&&
!b&&(b=n(),c=this.getAttachedElements()))for(var d=0,f=c.length;d<f;d++)this&&this==c[d]||c[d].setHover(a,!0,b)}}});var a=0,c=function(){var b=a+1;a++;return b},f=l.jsPlumbInstance=function(a){this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,
EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};a&&d.extend(this.Defaults,a);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};q.EventGenerator.apply(this);var f=this,k=c(),g=f.bind,h={},u=1,m=function(a){if(null==a)return null;if(3==a.nodeType||8==a.nodeType)return{el:a,text:!0};
var b=f.getElement(a);return{el:b,id:q.isString(a)&&null==b?a:E(b)}};this.getInstanceIndex=function(){return k};this.setZoom=function(a,b){u=a;f.fire("zoom",u);b&&f.repaintEverything();return!0};this.getZoom=function(){return u};for(var D in this.Defaults)h[D]=this.Defaults[D];var x,F=[];this.unbindContainer=function(){if(null!=x&&0<F.length)for(var a=0;a<F.length;a++)f.off(x,F[a][0],F[a][1])};this.setContainer=function(a){this.unbindContainer();a=this.getElement(a);this.select().each(function(b){b.moveParent(a)});
this.selectEndpoints().each(function(b){b.moveParent(a)});var c=x;x=a;F.length=0;for(var d={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},e=function(a,b,c){var e=b.srcElement||b.target;if(e=(e&&e.parentNode?e.parentNode._jsPlumb:null)||(e?e._jsPlumb:null)||(e&&e.parentNode&&e.parentNode.parentNode?e.parentNode.parentNode._jsPlumb:null))e.fire(a,e,b),f.fire(c?d[c+a]||a:a,e.component||e,b)},k=function(a,b,c){F.push([a,c]);f.on(x,a,b,c)},N=function(a){k(a,".jsplumb-connector",function(b){e(a,
b)});k(a,".jsplumb-endpoint",function(b){e(a,b,"endpoint")});k(a,".jsplumb-overlay",function(b){e(a,b)})},g=0;g<b.length;g++)N(b[g]);for(var h in J)N=J[h].el,N.parentNode===c&&(c.removeChild(N),x.appendChild(N))};this.getContainer=function(){return x};this.bind=function(a,b){"ready"===a&&P?b():g.apply(f,[a,b])};f.importDefaults=function(a){for(var b in a)f.Defaults[b]=a[b];a.Container&&f.setContainer(a.Container);return f};f.restoreDefaults=function(){f.Defaults=d.extend({},h);return f};var A=null,
P=!1,z=[],y={},Q={},J={},G={},ea={},fa={},ha=!1,R=[],S=!1,T=null,K=this.Defaults.Scope,Z=1,V=function(){return""+Z++};a=function(a,b){x?x.appendChild(a):b?this.getElement(b).appendChild(a):this.appendToRoot(a)}.bind(this);var W=function(a,b,c,e){if(!d.headless&&!S){a=E(a);var k=f.getDragManager().getElementsForDraggable(a);null==c&&(c=n());var N=ma({elId:a,offset:b,recalc:!1,timestamp:c});if(k)for(var g in k)ma({elId:k[g].id,offset:{left:N.o.left+k[g].offset.left,top:N.o.top+k[g].offset.top},recalc:!1,
timestamp:c});f.anchorManager.redraw(a,b,c,null,e);if(k)for(var h in k)f.anchorManager.redraw(k[h].id,b,c,k[h].offset,e,!0)}},la=function(a,b,c,e,k){if(!d.headless&&(null==b?0:b)&&d.isDragSupported(a,f)){var g=c||f.Defaults.DragOptions,g=d.extend({},g);if(d.isAlreadyDraggable(a,f))c.force&&f.initDraggable(a,g);else{b=d.dragEvents.drag;var N=d.dragEvents.stop,h=d.dragEvents.start,u=!1;ra(e,a);g[h]=q.wrap(g[h],function(){f.setHoverSuspended(!0);f.select({source:a}).addClass(f.elementDraggingClass+" "+
f.sourceElementDraggingClass,!0);f.select({target:a}).addClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0);f.setConnectionBeingDragged(!0);if(g.canDrag)return c.canDrag()},!1);g[b]=q.wrap(g[b],function(){var b=f.getUIPosition(arguments,f.getZoom());null!=b&&(W(a,b,null,!0),u&&f.addClass(a,"jsplumb-dragged"),u=!0)});g[N]=q.wrap(g[N],function(){for(var a=arguments[0].selection,b=f.getUIPosition(arguments),c=0;c<a.length;c++){var d=a[c];null!=b&&W(d[0],b);f.removeClass(d[0],"jsplumb-dragged");
f.select({source:d[0]}).removeClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0);f.select({target:d[0]}).removeClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0);f.getDragManager().dragEnded(d[0])}u=!1;f.setHoverSuspended(!1);f.setConnectionBeingDragged(!1)});e=E(a);fa[e]=!0;e=fa[e];g.disabled=null==e?!1:!e;f.initDraggable(a,g);f.getDragManager().register(a);k&&f.fire("elementDraggable",{el:a,options:g})}}},aa=function(a,b){a=a.scope.split(/\s/);b=b.scope.split(/\s/);
for(var c=0;c<a.length;c++)for(var f=0;f<b.length;f++)if(b[f]==a[c])return!0;return!1},ia=function(a,b){var c=d.extend({},a);b&&d.extend(c,b);c.source&&(c.source.endpoint?c.sourceEndpoint=c.source:c.source=f.getElement(c.source));c.target&&(c.target.endpoint?c.targetEndpoint=c.target:c.target=f.getElement(c.target));a.uuids&&(c.sourceEndpoint=Q[a.uuids[0]],c.targetEndpoint=Q[a.uuids[1]]);if(c.sourceEndpoint&&c.sourceEndpoint.isFull())q.log(f,"could not add connection; source endpoint is full");else if(c.targetEndpoint&&
c.targetEndpoint.isFull())q.log(f,"could not add connection; target endpoint is full");else{!c.type&&c.sourceEndpoint&&(c.type=c.sourceEndpoint.connectionType);if(c.sourceEndpoint&&c.sourceEndpoint.connectorOverlays)for(c.overlays=c.overlays||[],a=0,b=c.sourceEndpoint.connectorOverlays.length;a<b;a++)c.overlays.push(c.sourceEndpoint.connectorOverlays[a]);c.sourceEndpoint&&c.sourceEndpoint.scope&&(c.scope=c.sourceEndpoint.scope);!c["pointer-events"]&&c.sourceEndpoint&&c.sourceEndpoint.connectorPointerEvents&&
(c["pointer-events"]=c.sourceEndpoint.connectorPointerEvents);var e=function(a,b){a=d.extend({},a);for(var c in b)b[c]&&(a[c]=b[c]);return a};a=function(a,b,d,k){if(c[a]&&!c[a].endpoint&&!c[a+"Endpoint"]&&!c.newConnection){var g=E(c[a]);if(d=(d=d[g])?d[k]:null){if(!d.enabled)return!1;b=null!=d.endpoint&&d.endpoint._jsPlumb?d.endpoint:f.addEndpoint(c[a],e(d.def,{anchor:c.anchors?c.anchors[b]:c.anchor,endpoint:c.endpoints?c.endpoints[b]:c.endpoint,paintStyle:c.endpointStyles?c.endpointStyles[b]:c.endpointStyle,
hoverPaintStyle:c.endpointHoverStyles?c.endpointHoverStyles[b]:c.endpointHoverStyle}));if(b.isFull())return!1;c[a+"Endpoint"]=b;b._doNotDeleteOnDetach=!1;b._deleteOnDetach=!0;d.uniqueEndpoint&&(d.endpoint?b.finalEndpoint=d.endpoint:(d.endpoint=b,b._deleteOnDetach=!1,b._doNotDeleteOnDetach=!0))}}};if(!1!==a("source",0,this.sourceEndpointDefinitions,c.type||"default")&&!1!==a("target",1,this.targetEndpointDefinitions,c.type||"default"))return c.sourceEndpoint&&c.targetEndpoint&&(aa(c.sourceEndpoint,
c.targetEndpoint)||(c=null)),c}}.bind(f),L=function(a){var b=f.Defaults.ConnectionType||f.getDefaultConnectionType();a._jsPlumb=f;a.newConnection=L;a.newEndpoint=ba;a.endpointsByUUID=Q;a.endpointsByElement=y;a.finaliseConnection=O;a.id="con_"+V();a=new b(a);a.isDetachable()&&(a.endpoints[0].initDraggable("_jsPlumbSource"),a.endpoints[1].initDraggable("_jsPlumbTarget"));return a},O=f.finaliseConnection=function(a,b,c,d){b=b||{};a.suspendedEndpoint||z.push(a);a.pending=null;a.endpoints[0].isTemporarySource=
!1;!1!==d&&f.anchorManager.newConnection(a);W(a.source);b.doNotFireConnectionEvent||!1===b.fireEvent||f.fire("connection",{connection:a,source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]},c)},ba=function(a,b){var c=f.Defaults.EndpointType||d.Endpoint;a=d.extend({},a);a._jsPlumb=f;a.newConnection=L;a.newEndpoint=ba;a.endpointsByUUID=Q;a.endpointsByElement=y;a.fireDetachEvent=ta;a.elementId=b||E(a.source);c=new c(a);c.id=
"ep_"+V();ra(a.elementId,a.source);d.headless||f.getDragManager().endpointAdded(a.source,b);return c},I=function(a,b,c){if((a=y[a])&&a.length)for(var f=0,d=a.length;f<d;f++){for(var e=0,k=a[f].connections.length;e<k;e++)if(b(a[f].connections[e]))return;c&&c(a[f])}},U=function(a,b,c){b="block"===b;var f=null;c&&(f=function(a){a.setVisible(b,!0,!0)});var d=m(a);I(d.id,function(a){b&&c?a.endpoints[a.sourceId===d.id?1:0].isVisible()&&a.setVisible(!0):a.setVisible(b)},f)},E=function(a,b,c){if(q.isString(a))return a;
if(null==a)return null;var d=f.getAttribute(a,"id");if(!d||"undefined"===d){if(2==arguments.length&&void 0!==arguments[1])d=b;else if(1==arguments.length||3==arguments.length&&!arguments[2])d="jsPlumb_"+k+"_"+V();c||f.setAttribute(a,"id",d)}return d};this.setConnectionBeingDragged=function(a){ha=a};this.isConnectionBeingDragged=function(){return ha};this.getManagedElements=function(){return J};this.getRenderMode=function(){return"svg"};this.connectorClass="jsplumb-connector";this.connectorOutlineClass=
"jsplumb-connector-outline";this.editableConnectorClass="jsplumb-connector-editable";this.connectedClass="jsplumb-connected";this.hoverClass="jsplumb-hover";this.endpointClass="jsplumb-endpoint";this.endpointConnectedClass="jsplumb-endpoint-connected";this.endpointFullClass="jsplumb-endpoint-full";this.endpointDropAllowedClass="jsplumb-endpoint-drop-allowed";this.endpointDropForbiddenClass="jsplumb-endpoint-drop-forbidden";this.overlayClass="jsplumb-overlay";this.draggingClass="jsplumb-dragging";
this.elementDraggingClass="jsplumb-element-dragging";this.sourceElementDraggingClass="jsplumb-source-element-dragging";this.targetElementDraggingClass="jsplumb-target-element-dragging";this.endpointAnchorClassPrefix="jsplumb-endpoint-anchor";this.hoverSourceClass="jsplumb-source-hover";this.hoverTargetClass="jsplumb-target-hover";this.dragSelectClass="jsplumb-drag-select";this.Anchors={};this.Connectors={svg:{}};this.Endpoints={svg:{}};this.Overlays={svg:{}};this.ConnectorRenderers={};this.SVG="svg";
this.addEndpoint=function(a,b,c){c=c||{};c=d.extend({},c);d.extend(c,b);c.endpoint=c.endpoint||f.Defaults.Endpoint;c.paintStyle=c.paintStyle||f.Defaults.EndpointStyle;b=[];a=q.isArray(a)||null!=a.length&&!q.isString(a)?a:[a];for(var e=0,k=a.length;e<k;e++){c.source=f.getElement(a[e]);na(c.source);var g=E(c.source),h=ba(c,g),N=ra(g,c.source).info.o;q.addToList(y,g,h);S||h.paint({anchorLoc:h.anchor.compute({xy:[N.left,N.top],wh:R[g],element:h,timestamp:T}),timestamp:T});b.push(h);h._doNotDeleteOnDetach=
!0}return 1==b.length?b[0]:b};this.addEndpoints=function(a,b,c){for(var d=[],e=0,k=b.length;e<k;e++){var g=f.addEndpoint(a,b[e],c);q.isArray(g)?Array.prototype.push.apply(d,g):d.push(g)}return d};this.animate=function(a,b,c){if(!this.animationSupported)return!1;c=c||{};a=f.getElement(a);var e=E(a),k=d.animEvents.step,g=d.animEvents.complete;c[k]=q.wrap(c[k],function(){f.revalidate(e)});c[g]=q.wrap(c[g],function(){f.revalidate(e)});f.doAnimate(a,b,c)};this.checkCondition=function(a,b){var c=f.getListener(a),
d=!0;if(c&&0<c.length){var e=Array.prototype.slice.call(arguments,1);try{for(var k=0,g=c.length;k<g;k++)d=d&&c[k].apply(c[k],e)}catch(Ea){q.log(f,"cannot check condition ["+a+"]"+Ea)}}return d};this.connect=function(a,b){a=ia(a,b);var c;if(a){if(null==a.source&&null==a.sourceEndpoint){q.log("Cannot establish connection - source does not exist");return}if(null==a.target&&null==a.targetEndpoint){q.log("Cannot establish connection - target does not exist");return}na(a.source);c=L(a);O(c,a)}return c};
var X=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Y=function(a,b,c,f){var e,k=X[c],g=a[k.elId],h,N=a.endpoints[c],u={index:c,originalSourceId:0===c?g:a.sourceId,newSourceId:a.sourceId,originalTargetId:1==c?g:a.targetId,newTargetId:a.targetId,connection:a};if(b.constructor==d.Endpoint)e=b,e.addConnection(a),b=e.element;else if(g=E(b),h=this[k.epDefs][g],g===a[k.elId])e=null;else if(h)for(var m in h){if(!h[m].enabled)return;
e=null!=h[m].endpoint&&h[m].endpoint._jsPlumb?h[m].endpoint:this.addEndpoint(b,h[m].def);h[m].uniqueEndpoint&&(h[m].endpoint=e);e._doNotDeleteOnDetach=!1;e._deleteOnDetach=!0;e.addConnection(a)}else e=a.makeEndpoint(0===c,b,g),e._doNotDeleteOnDetach=!1,e._deleteOnDetach=!0;null!=e&&(N.detachFromConnection(a),a.endpoints[c]=e,a[k.el]=e.element,a[k.elId]=e.elementId,u[0===c?"newSourceId":"newTargetId"]=e.elementId,Ba(u),f||a.repaint());u.element=b;return u}.bind(this);this.setSource=function(a,b,c){b=
Y(a,b,0,c);this.anchorManager.sourceChanged(b.originalSourceId,b.newSourceId,a,b.el)};this.setTarget=function(a,b,c){b=Y(a,b,1,c);this.anchorManager.updateOtherEndpoint(b.originalSourceId,b.originalTargetId,b.newTargetId,a)};this.deleteEndpoint=function(a,b,c){(a="string"===typeof a?Q[a]:a)&&f.deleteObject({endpoint:a,dontUpdateHover:b,deleteAttachedObjects:c});return f};this.deleteEveryEndpoint=function(){var a=f.setSuspendDrawing(!0),b;for(b in y){var c=y[b];if(c&&c.length)for(var d=0,e=c.length;d<
e;d++)f.deleteEndpoint(c[d],!0)}y={};J={};Q={};G={};ea={};f.anchorManager.reset();f.getDragManager().reset();a||f.setSuspendDrawing(!1);return f};var ta=function(a,b,c){var d=f.Defaults.ConnectionType||f.getDefaultConnectionType();a=a.constructor==d?{connection:a,source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]}:a;b&&f.fire("connectionDetached",a,c);f.anchorManager.connectionDetached(a)},Ba=f.fireMoveEvent=function(a,
b){f.fire("connectionMoved",a,b)};this.unregisterEndpoint=function(a){a._jsPlumb.uuid&&(Q[a._jsPlumb.uuid]=null);f.anchorManager.deleteEndpoint(a);for(var b in y){var c=y[b];if(c){for(var d=[],e=0,k=c.length;e<k;e++)c[e]!=a&&d.push(c[e]);y[b]=d}1>y[b].length&&delete y[b]}};this.detach=function(){if(0!==arguments.length){var a=f.Defaults.ConnectionType||f.getDefaultConnectionType(),b=arguments[0].constructor==a,a=2==arguments.length?b?arguments[1]||{}:arguments[0]:arguments[0],c=!1!==a.fireEvent,e=
a.forceDetach,k=b?arguments[0]:a.connection,b=b?null:a.deleteAttachedObjects;if(k)(e||q.functionChain(!0,!1,[[k.endpoints[0],"isDetachAllowed",[k]],[k.endpoints[1],"isDetachAllowed",[k]],[k,"isDetachAllowed",[k]],[f,"checkCondition",["beforeDetach",k]]]))&&k.endpoints[0].detach({connection:k,ignoreTarget:!1,forceDetach:!0,fireEvent:c,deleteAttachedObjects:b});else if(a=d.extend({},a),a.uuids)Q[a.uuids[0]].detachFrom(Q[a.uuids[1]],c);else if(a.sourceEndpoint&&a.targetEndpoint)a.sourceEndpoint.detachFrom(a.targetEndpoint);
else{var g=E(f.getElement(a.source)),h=E(f.getElement(a.target));I(g,function(a){(a.sourceId==g&&a.targetId==h||a.targetId==g&&a.sourceId==h)&&f.checkCondition("beforeDetach",a)&&a.endpoints[0].detach({connection:a,ignoreTarget:!1,forceDetach:!0,fireEvent:c})})}}};this.detachAllConnections=function(a,b){b=b||{};a=f.getElement(a);a=E(a);if((a=y[a])&&a.length)for(var c=0,d=a.length;c<d;c++)a[c].detachAll(!1!==b.fireEvent,b.forceDetach);return f};this.detachEveryConnection=function(a){a=a||{};f.batch(function(){for(var b in y){var c=
y[b];if(c&&c.length)for(var f=0,d=c.length;f<d;f++)c[f].detachAll(!1!==a.fireEvent,a.forceDetach)}z.length=0});return f};this.deleteObject=function(a){var b={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=!1!==a.deleteAttachedObjects,d=function(f){if(null!=f&&null==b.connections[f.id]&&(a.dontUpdateHover||null==f._jsPlumb||f.setHover(!1),b.connections[f.id]=f,b.connectionCount++,c))for(var d=0;d<f.endpoints.length;d++)f.endpoints[d]._deleteOnDetach&&e(f.endpoints[d])},e=function(f){if(null!=
f&&null==b.endpoints[f.id]&&(a.dontUpdateHover||null==f._jsPlumb||f.setHover(!1),b.endpoints[f.id]=f,b.endpointCount++,c))for(var e=0;e<f.connections.length;e++)d(f.connections[e])};a.connection?d(a.connection):e(a.endpoint);for(var k in b.connections){var g=b.connections[k];if(g._jsPlumb){q.removeWithFunction(z,function(a){return g.id==a.id});ta(g,!1===a.fireEvent?!1:!g.pending,a.originalEvent);var h=null==a.deleteAttachedObjects?null:!a.deleteAttachedObjects;g.endpoints[0].detachFromConnection(g,
null,h);g.endpoints[1].detachFromConnection(g,null,h);g.cleanup(!0);g.destroy(!0)}}for(var u in b.endpoints)k=b.endpoints[u],k._jsPlumb&&(f.unregisterEndpoint(k),k.cleanup(!0),k.destroy(!0));return b};this.draggable=function(a,b){var c;r(function(a){c=m(a);c.el&&la(c.el,!0,b,c.id,!0)},a);return f};this.droppable=function(a,b){var c;b=b||{};b.allowLoopback=!1;r(function(a){c=m(a);c.el&&f.initDroppable(c.el,b)},a);return f};var ga=function(a,b,c){return function(){for(var f=arguments,d=0,e=a.length;d<
e;d++)a[d][b].apply(a[d],f);return c(a)}},ja=function(a,b){return function(){for(var c=arguments,f=[],d=0,e=a.length;d<e;d++)f.push([a[d][b].apply(a[d],c),a[d]]);return f}},ca=function(a,b){var c=[];if(a)if("string"==typeof a){if("*"===a)return a;c.push(a)}else if(b)c=a;else if(a.length){b=0;for(var f=a.length;b<f;b++)c.push(m(a[b]).id)}else c.push(m(a).id);return c},da=function(a,b,c){return"*"===a?!0:0<a.length?-1!=a.indexOf(b):!c};this.getConnections=function(a,b){a?a.constructor==String&&(a={scope:a}):
a={};var c=a.scope||f.getDefaultScope(),c=ca(c,!0),d=ca(a.source);a=ca(a.target);for(var e=!b&&1<c.length?{}:[],k=0,g=z.length;k<g;k++){var h=z[k],u=h.proxies&&h.proxies[0]?h.proxies[0].originalEp.elementId:h.sourceId,m=h.proxies&&h.proxies[1]?h.proxies[1].originalEp.elementId:h.targetId;da(c,h.scope)&&da(d,u)&&da(a,m)&&(u=h.scope,!b&&1<c.length?(m=e[u],null==m&&(m=e[u]=[]),m.push(h)):e.push(h))}return e};var Ca=function(a,b){return function(c){for(var f=0,d=a.length;f<d;f++)c(a[f]);return b(a)}},
Fa=function(a){return function(b){return a[b]}},ua=function(a,b){var c={length:a.length,each:Ca(a,b),get:Fa(a)},f="setHover removeAllOverlays setLabel addClass addOverlay removeOverlay removeOverlays showOverlay hideOverlay showOverlays hideOverlays setPaintStyle setHoverPaintStyle setSuspendEvents setParameter setParameters setVisible repaint addType toggleType removeType removeClass setType bind unbind".split(" "),d="getLabel getOverlay isHover getParameter getParameters getPaintStyle getHoverPaintStyle isVisible hasType getType isSuspendEvents".split(" "),
e,k;e=0;for(k=f.length;e<k;e++)c[f[e]]=ga(a,f[e],b);e=0;for(k=d.length;e<k;e++)c[d[e]]=ja(a,d[e]);return c},ka=function(a){var b=ua(a,ka);return d.extend(b,{setDetachable:ga(a,"setDetachable",ka),setReattach:ga(a,"setReattach",ka),setConnector:ga(a,"setConnector",ka),detach:function(){for(var b=0,c=a.length;b<c;b++)f.detach(a[b])},isDetachable:ja(a,"isDetachable"),isReattach:ja(a,"isReattach")})},oa=function(a){var b=ua(a,oa);return d.extend(b,{setEnabled:ga(a,"setEnabled",oa),setAnchor:ga(a,"setAnchor",
oa),isEnabled:ja(a,"isEnabled"),detachAll:function(){for(var b=0,c=a.length;b<c;b++)a[b].detachAll()},remove:function(){for(var b=0,c=a.length;b<c;b++)f.deleteObject({endpoint:a[b]})}})};this.select=function(a){a=a||{};a.scope=a.scope||"*";return ka(a.connections||f.getConnections(a,!0))};this.selectEndpoints=function(a){a=a||{};a.scope=a.scope||"*";var b=!a.element&&!a.source&&!a.target,c=b?"*":ca(a.element),f=b?"*":ca(a.source),b=b?"*":ca(a.target);a=ca(a.scope,!0);var d=[],e;for(e in y){var k=
da(c,e,!0),g=da(f,e,!0),h="*"!=f,u=da(b,e,!0),m="*"!=b;if(k||g||u)a:for(k=0,g=y[e].length;k<g;k++)if(u=y[e][k],da(a,u.scope,!0)){var r=m&&0<b.length&&!u.isTarget;if(h&&0<f.length&&!u.isSource||r)continue a;d.push(u)}}return oa(d)};this.getAllConnections=function(){return z};this.getDefaultScope=function(){return K};this.getEndpoint=function(a){return Q[a]};this.getEndpoints=function(a){return y[m(a).id]};this.getDefaultEndpointType=function(){return d.Endpoint};this.getDefaultConnectionType=function(){return d.Connection};
this.getId=E;this.appendElement=a;var va=!1;this.isHoverSuspended=function(){return va};this.setHoverSuspended=function(a){va=a};this.hide=function(a,b){U(a,"none",b);return f};this.idstamp=V;this.connectorsInitialized=!1;this.registerConnectorType=function(a,b){p.push([a,b])};var na=function(a){!x&&a&&(a=f.getElement(a),a.offsetParent&&f.setContainer(a.offsetParent))},ra=f.manage=function(a,b,c){J[a]||(J[a]={el:b,endpoints:[],connections:[]},J[a].info=ma({elId:a,timestamp:T}),c||f.fire("manageElement",
{id:a,info:J[a].info,el:b}));return J[a]},ma=this.updateOffset=function(a){var b=a.timestamp,c=a.recalc,d=a.offset,e=a.elId;S&&!b&&(b=T);if(!c&&b&&b===ea[e])return{o:a.offset||G[e],s:R[e]};c||!d&&null==G[e]?(a=J[e]?J[e].el:null,null!=a&&(R[e]=f.getSize(a),G[e]=f.getOffset(a),ea[e]=b)):(G[e]=d||G[e],null==R[e]&&(a=J[e].el,null!=a&&(R[e]=f.getSize(a))),ea[e]=b);G[e]&&!G[e].right&&(G[e].right=G[e].left+R[e][0],G[e].bottom=G[e].top+R[e][1],G[e].width=R[e][0],G[e].height=R[e][1],G[e].centerx=G[e].left+
G[e].width/2,G[e].centery=G[e].top+G[e].height/2);return{o:G[e],s:R[e]}};this.init=function(){t=l.jsPlumb.getRenderModes();var a=function(a,b,c){l.jsPlumb.Connectors[a][b]=function(){c.apply(this,arguments);l.jsPlumb.ConnectorRenderers[a].apply(this,arguments)};q.extend(l.jsPlumb.Connectors[a][b],[c,l.jsPlumb.ConnectorRenderers[a]])};if(!l.jsPlumb.connectorsInitialized){for(var b=0;b<p.length;b++)for(var c=0;c<t.length;c++)a(t[c],p[b][1],p[b][0]);l.jsPlumb.connectorsInitialized=!0}P||(f.Defaults.Container&&
f.setContainer(f.Defaults.Container),f.anchorManager=new l.jsPlumb.AnchorManager({jsPlumbInstance:f}),P=!0,f.fire("ready",f))}.bind(this);this.log=A;this.jsPlumbUIComponent=e;this.makeAnchor=function(){var a,b=function(a,b){if(l.jsPlumb.Anchors[a])return new l.jsPlumb.Anchors[a](b);if(!f.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+a+"'"};};if(0===arguments.length)return null;var c=arguments[0];a=arguments[1];var e=null;if(c.compute&&c.getOrientation)return c;if("string"==
typeof c)e=b(arguments[0],{elementId:a,jsPlumbInstance:f});else if(q.isArray(c))if(q.isArray(c[0])||q.isString(c[0]))2==c.length&&q.isObject(c[1])?q.isString(c[0])?(a=l.jsPlumb.extend({elementId:a,jsPlumbInstance:f},c[1]),e=b(c[0],a)):(a=l.jsPlumb.extend({elementId:a,jsPlumbInstance:f,anchors:c[0]},c[1]),e=new l.jsPlumb.DynamicAnchor(a)):e=new d.DynamicAnchor({anchors:c,selector:null,elementId:a,jsPlumbInstance:f});else{var k={x:c[0],y:c[1],orientation:4<=c.length?[c[2],c[3]]:[0,0],offsets:6<=c.length?
[c[4],c[5]]:[0,0],elementId:a,jsPlumbInstance:f,cssClass:7==c.length?c[6]:null},e=new l.jsPlumb.Anchor(k);e.clone=function(){return new l.jsPlumb.Anchor(k)}}e.id||(e.id="anchor_"+V());return e};this.makeAnchors=function(a,b,c){for(var d=[],e=0,k=a.length;e<k;e++)"string"==typeof a[e]?d.push(l.jsPlumb.Anchors[a[e]]({elementId:b,jsPlumbInstance:c})):q.isArray(a[e])&&d.push(f.makeAnchor(a[e],b,c));return d};this.makeDynamicAnchor=function(a,b){return new l.jsPlumb.DynamicAnchor({anchors:a,selector:b,
elementId:null,jsPlumbInstance:f})};this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};var Ga=function(a,b,c,f,d){a=a.target||a.srcElement;var e=!1;b=f.getSelector(b,c);for(c=0;c<b.length;c++)if(b[c]==a){e=!0;break}return d?!e:e},wa=function(a,b,c,d,k){var g=new e(b);d=b._jsPlumb.EndpointDropHandler({jsPlumb:f,enabled:function(){return a.def.enabled},isFull:function(){var b=f.select({target:a.id}).length;return 0<a.def.maxConnections&&b>=a.def.maxConnections},element:a.el,elementId:a.id,
isSource:d,isTarget:k,addClass:function(b){f.addClass(a.el,b)},removeClass:function(b){f.removeClass(a.el,b)},onDrop:function(a){a.endpoints[0].anchor.locked=!1},isDropAllowed:function(){return g.isDropAllowed.apply(g,arguments)},isRedrop:function(b){return null!=b.suspendedElement&&null!=b.suspendedEndpoint&&b.suspendedEndpoint.element===a.el},getEndpoint:function(c){var d=a.def.endpoint;if(null==d||null==d._jsPlumb){var d=f.deriveEndpointAndAnchorSpec(c.getType().join(" "),!0),e=d.endpoints?l.jsPlumb.extend(b,
{endpoint:a.def.def.endpoint||d.endpoints[1]}):b;d.anchors&&(e=l.jsPlumb.extend(e,{anchor:a.def.def.anchor||d.anchors[1]}));d=f.addEndpoint(a.el,e);d._mtNew=!0}b.uniqueEndpoint&&(a.def.endpoint=d);d._doNotDeleteOnDetach=!1;d._deleteOnDetach=!0;c.isDetachable()&&d.initDraggable();if(null!=d.anchor.positionFinder){var e=f.getUIPosition(arguments,f.getZoom()),k=f.getOffset(a.el),g=f.getSize(a.el),e=null==e?[0,0]:d.anchor.positionFinder(e,k,g,d.anchor.constructorParams);d.anchor.x=e[0];d.anchor.y=e[1]}return d},
maybeCleanup:function(a){a._mtNew&&0===a.connections.length?f.deleteObject({endpoint:a}):delete a._mtNew}});var h=l.jsPlumb.dragEvents.drop;c.scope=c.scope||b.scope||f.Defaults.Scope;c[h]=q.wrap(c[h],d,!0);k&&(c[l.jsPlumb.dragEvents.over]=function(){return!0});!1===b.allowLoopback&&(c.canDrop=function(b){return b.getDragElement()._jsPlumbRelatedElement!=a.el});f.initDroppable(a.el,c,"internal");return d};this.makeTarget=function(a,b,c){var f=l.jsPlumb.extend({_jsPlumb:this},c);l.jsPlumb.extend(f,
b);var d=f.maxConnections||-1;b=function(a){a=m(a);var b=a.id,c=l.jsPlumb.extend({},f.dropOptions||{});this.targetEndpointDefinitions[b]=this.targetEndpointDefinitions[b]||{};na(b);var e={def:l.jsPlumb.extend({},f),uniqueEndpoint:f.uniqueEndpoint,maxConnections:d,enabled:!0};a.def=e;this.targetEndpointDefinitions[b]["default"]=e;wa(a,f,c,!0===f.isSource,!0);a.el._katavorioDrop[a.el._katavorioDrop.length-1].targetDef=e}.bind(this);a=a.length&&a.constructor!=String?a:[a];c=0;for(var e=a.length;c<e;c++)b(a[c]);
return this};this.unmakeTarget=function(a,b){a=m(a);f.destroyDroppable(a.el,"internal");b||delete this.targetEndpointDefinitions[a.id];return this};this.makeSource=function(a,b,c){var d=l.jsPlumb.extend({_jsPlumb:this},c);l.jsPlumb.extend(d,b);var e=d.connectionType||"default";b=f.deriveEndpointAndAnchorSpec(e);d.endpoint=d.endpoint||b.endpoints[0];d.anchor=d.anchor||b.anchors[0];var k=d.maxConnections||-1,g=d.onMaxConnections;b=function(a){var b=a.id,c=this.getElement(a.el);this.sourceEndpointDefinitions[b]=
this.sourceEndpointDefinitions[b]||{};na(b);var h={def:l.jsPlumb.extend({},d),uniqueEndpoint:d.uniqueEndpoint,maxConnections:k,enabled:!0};this.sourceEndpointDefinitions[b][e]=h;a.def=h;var m=l.jsPlumb.dragEvents.stop,r=l.jsPlumb.dragEvents.drag,v=l.jsPlumb.extend({},d.dragOptions||{}),n=v.drag,A=v.stop,p=null,w=!1;v.scope=v.scope||d.scope;v[r]=q.wrap(v[r],function(){n&&n.apply(this,arguments);w=!1});v[m]=q.wrap(v[m],function(){A&&A.apply(this,arguments);this.currentlyDragging=!1;if(null!=p._jsPlumb){var a=
p.anchor,c=p.connections[0],e=this.makeAnchor(d.anchor||this.Defaults.Anchor,b,this),k=p.element;if(null!=e.positionFinder){var g=f.getOffset(k),k=this.getSize(k),a=e.positionFinder({left:g.left+a.x*k[0],top:g.top+a.y*k[1]},g,k,e.constructorParams);e.x=a[0];e.y=a[1]}p.setAnchor(e,!0);p.repaint();this.repaint(p.elementId);null!=c&&this.repaint(c.targetId)}}.bind(this));m=function(h){if(3!==h.which&&2!==h.button){var m=this.sourceEndpointDefinitions[b][e];if(m.enabled&&(b=this.getId(this.getElement(a.el)),
!d.filter||!1!==(q.isString(d.filter)?Ga(h,a.el,d.filter,this,d.filterExclude):d.filter(h,a.el)))){var r=this.select({source:b}).length;if(0<=m.maxConnections&&r>=m.maxConnections)return g&&g({element:a.el,maxConnections:k},h),!1;var r=l.jsPlumb.getPositionOnElement(h,c,u),n={};l.jsPlumb.extend(n,d);n.isTemporarySource=!0;n.anchor=[r[0],r[1],0,0];n.dragOptions=v;m.def.scope&&(n.scope=m.def.scope);p=this.addEndpoint(b,n);w=!0;p._doNotDeleteOnDetach=!1;p._deleteOnDetach=!0;m.uniqueEndpoint&&(m.endpoint?
p.finalEndpoint=m.endpoint:(m.endpoint=p,p._deleteOnDetach=!1,p._doNotDeleteOnDetach=!0));var A=function(){f.off(p.canvas,"mouseup",A);f.off(a.el,"mouseup",A);w&&(w=!1,f.deleteEndpoint(p))};f.on(p.canvas,"mouseup",A);f.on(a.el,"mouseup",A);r={};if(m.def.extract)for(var H in m.def.extract)(n=(h.srcElement||h.target).getAttribute(H))&&(r[m.def.extract[H]]=n);f.trigger(p.canvas,"mousedown",h,r);q.consume(h)}}}.bind(this);this.on(a.el,"mousedown",m);h.trigger=m;d.filter&&(q.isString(d.filter)||q.isFunction(d.filter))&&
f.setDragFilter(a.el,d.filter);h=l.jsPlumb.extend({},d.dropOptions||{});wa(a,d,h,!0,!0===d.isTarget)}.bind(this);a=a.length&&a.constructor!=String?a:[a];c=0;for(var h=a.length;c<h;c++)b(m(a[c]));return this};this.unmakeSource=function(a,b,c){a=m(a);f.destroyDroppable(a.el,"internal");var d=this.sourceEndpointDefinitions[a.id];if(d)for(var e in d)if(null==b||b===e){var k=d[e].trigger;k&&f.off(a.el,"mousedown",k);c||delete this.sourceEndpointDefinitions[a.id][e]}return this};this.unmakeEverySource=
function(){for(var a in this.sourceEndpointDefinitions)f.unmakeSource(a,null,!0);this.sourceEndpointDefinitions={};return this};var sa=function(a,b,c){b=q.isArray(b)?b:[b];a=E(a);c=c||"default";for(var f=0;f<b.length;f++){var d=this[b[f]][a];if(d&&d[c])return d[c].def.scope||this.Defaults.Scope}}.bind(this),xa=function(a,b,c,f){c=q.isArray(c)?c:[c];a=E(a);f=f||"default";for(var d=0;d<c.length;d++){var e=this[c[d]][a];e&&e[f]&&(e[f].def.scope=b)}}.bind(this);this.getScope=function(a,b){return sa(a,
["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(a){return sa(a,"sourceEndpointDefinitions")};this.getTargetScope=function(a){return sa(a,"targetEndpointDefinitions")};this.setScope=function(a,b,c){this.setSourceScope(a,b,c);this.setTargetScope(a,b,c)};this.setSourceScope=function(a,b,c){xa(a,b,"sourceEndpointDefinitions",c);this.setDragScope(a,b)};this.setTargetScope=function(a,b,c){xa(a,b,"targetEndpointDefinitions",c);this.setDropScope(a,b)};this.unmakeEveryTarget=
function(){for(var a in this.targetEndpointDefinitions)f.unmakeTarget(a,!0);this.targetEndpointDefinitions={};return this};var pa=function(a,b,c,f,d){a="source"==a?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;d=d||"default";if(q.isString(b)&&a[b]&&a[b][d])a[b][d].enabled=f?!a[b][d].enabled:c;else if(b.length)for(var e=0,k=b.length;e<k;e++){var g=m(b[e]);a[g.id]&&a[g.id][d]&&(a[g.id][d].enabled=f?!a[g.id][d].enabled:c)}else b=m(b).id,a[b]&&a[b][d]&&(a[b][d].enabled=f?!a[b][d].enabled:
c);return this}.bind(this),qa=function(a,b){if(q.isString(a)||!a.length)return b.apply(this,[a]);if(a.length)return b.apply(this,[a[0]])}.bind(this);this.toggleSourceEnabled=function(a,b){pa("source",a,null,!0,b);return this.isSourceEnabled(a,b)};this.setSourceEnabled=function(a,b,c){return pa("source",a,b,null,c)};this.isSource=function(a,b){b=b||"default";return qa(a,function(a){a=this.sourceEndpointDefinitions[m(a).id];return null!=a&&null!=a[b]}.bind(this))};this.isSourceEnabled=function(a,b){b=
b||"default";return qa(a,function(a){return(a=this.sourceEndpointDefinitions[m(a).id])&&a[b]&&!0===a[b].enabled}.bind(this))};this.toggleTargetEnabled=function(a,b){pa("target",a,null,!0,b);return this.isTargetEnabled(a,b)};this.isTarget=function(a,b){b=b||"default";return qa(a,function(a){a=this.targetEndpointDefinitions[m(a).id];return null!=a&&null!=a[b]}.bind(this))};this.isTargetEnabled=function(a,b){b=b||"default";return qa(a,function(a){return(a=this.targetEndpointDefinitions[m(a).id])&&a[b]&&
!0===a[b].enabled}.bind(this))};this.setTargetEnabled=function(a,b,c){return pa("target",a,b,null,c)};this.ready=function(a){f.bind("ready",a)};var ya=function(a,b){if("object"==typeof a&&a.length)for(var c=0,d=a.length;c<d;c++)b(a[c]);else b(a);return f};this.repaint=function(a,b,c){return ya(a,function(a){W(a,b,c)})};this.revalidate=function(a,b,c){return ya(a,function(a){var d=c?a:f.getId(a);f.updateOffset({elId:d,recalc:!0,timestamp:b});f.repaint(a)})};this.repaintEverything=function(){var a=
n(),b;for(b in y)f.updateOffset({elId:b,recalc:!0,timestamp:a});for(b in y)W(b,null,a);return this};this.removeAllEndpoints=function(a,b,c){c=c||[];var d=function(a){a=m(a);var e=y[a.id],k,g;if(e)for(c.push(a),k=0,g=e.length;k<g;k++)f.deleteEndpoint(e[k],!1);delete y[a.id];if(b&&a.el&&3!=a.el.nodeType&&8!=a.el.nodeType)for(k=0,g=a.el.childNodes.length;k<g;k++)d(a.el.childNodes[k])};d(a);return this};var za=function(a,b){f.removeAllEndpoints(a.id,!0,b);for(var c=function(a){f.getDragManager().elementRemoved(a.id);
f.anchorManager.clearFor(a.id);f.anchorManager.removeFloatingConnection(a.id);f.isSource(a.el)&&f.unmakeSource(a.el);f.isTarget(a.el)&&f.unmakeTarget(a.el);f.destroyDraggable(a.el);f.destroyDroppable(a.el);delete f.floatingConnections[a.id];delete J[a.id];delete G[a.id];a.el&&(f.removeElement(a.el),a.el._jsPlumb=null)},d=1;d<b.length;d++)c(b[d]);c(a)};this.remove=function(a,b){var c=m(a),d=[];c.text?c.el.parentNode.removeChild(c.el):c.id&&f.batch(function(){za(c,d)},!1===b);return f};this.empty=function(a,
b){var c=[],d=function(a,b){a=m(a);if(a.text)a.el.parentNode.removeChild(a.el);else if(a.el){for(;0<a.el.childNodes.length;)d(a.el.childNodes[0]);b||za(a,c)}};f.batch(function(){d(a,!0)},!1===b);return f};this.reset=function(){f.silently(function(){f.removeAllGroups();f.removeGroupManager();f.deleteEveryEndpoint();f.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};z.length=0;this.doReset&&this.doReset()}.bind(this))};var Aa=function(a){a.canvas&&a.canvas.parentNode&&a.canvas.parentNode.removeChild(a.canvas);
a.cleanup();a.destroy()};this.clear=function(){f.select().each(Aa);f.selectEndpoints().each(Aa);y={};Q={}};this.setDefaultScope=function(a){K=a;return f};this.setDraggable=function(a,b){return d.each(a,function(a){f.isDragSupported(a)&&(fa[f.getAttribute(a,"id")]=b,f.setElementDraggable(a,b))})};this.deriveEndpointAndAnchorSpec=function(a,b){a=((b?"":"default ")+a).split(/[\s]/);for(var c=b=null,d=null,e=null,k=0;k<a.length;k++){var g=f.getType(a[k],"connection");g&&(g.endpoints&&(b=g.endpoints),
g.endpoint&&(c=g.endpoint),g.anchors&&(e=g.anchors),g.anchor&&(d=g.anchor))}return{endpoints:b?b:[c,c],anchors:e?e:[d,d]}};this.setId=function(a,b,c){var d;q.isString(a)?d=a:(a=this.getElement(a),d=this.getId(a));var f=this.getConnections({source:d,scope:"*"},!0),e=this.getConnections({target:d,scope:"*"},!0);b=""+b;c?a=this.getElement(b):(a=this.getElement(d),this.setAttribute(a,"id",b));y[b]=y[d]||[];c=0;for(var k=y[b].length;c<k;c++)y[b][c].setElementId(b),y[b][c].setReferenceElement(a);delete y[d];
this.sourceEndpointDefinitions[b]=this.sourceEndpointDefinitions[d];delete this.sourceEndpointDefinitions[d];this.targetEndpointDefinitions[b]=this.targetEndpointDefinitions[d];delete this.targetEndpointDefinitions[d];this.anchorManager.changeId(d,b);this.getDragManager().changeId(d,b);J[b]=J[d];delete J[d];d=function(c,d,f){for(var e=0,k=c.length;e<k;e++)c[e].endpoints[d].setElementId(b),c[e].endpoints[d].setReferenceElement(a),c[e][f+"Id"]=b,c[e][f]=a};d(f,0,"source");d(e,1,"target");this.repaint(b)};
this.setDebugLog=function(a){A=a};this.setSuspendDrawing=function(a,b){var c=S;T=(S=a)?(new Date).getTime():null;b&&this.repaintEverything();return c};this.isSuspendDrawing=function(){return S};this.getSuspendedAt=function(){return T};this.doWhileSuspended=this.batch=function(a,b){var c=this.isSuspendDrawing();c||this.setSuspendDrawing(!0);try{a()}catch(Da){q.log("Function run while suspended failed",Da)}c||this.setSuspendDrawing(!1,!b)};this.getCachedData=function(a){var b=G[a];return b?{o:b,s:R[a]}:
ma({elId:a})};this.timestamp=n;this.show=function(a,b){U(a,"block",b);return f};this.toggleVisible=function(a,b){var c=null;b&&(c=function(a){var b=a.isVisible();a.setVisible(!b)});I(a,function(a){var b=a.isVisible();a.setVisible(!b)},c)};this.toggleDraggable=function(a){var b;d.each(a,function(a){var c=f.getAttribute(a,"id");b=null==fa[c]?!1:fa[c];b=!b;fa[c]=b;f.setDraggable(a,b);return b}.bind(this));return b};this.addListener=this.bind};q.extend(l.jsPlumbInstance,q.EventGenerator,{setAttribute:function(a,
b,c){this.setAttribute(a,b,c)},getAttribute:function(a,b){return this.getAttribute(l.jsPlumb.getElement(a),b)},convertToFullOverlaySpec:function(a){q.isString(a)&&(a=[a,{}]);a[1].id=a[1].id||q.uuid();return a},registerConnectionType:function(a,b){this._connectionTypes[a]=l.jsPlumb.extend({},b);if(b.overlays){for(var c={},d=0;d<b.overlays.length;d++){var f=this.convertToFullOverlaySpec(b.overlays[d]);c[f[1].id]=f}this._connectionTypes[a].overlays=c}},registerConnectionTypes:function(a){for(var b in a)this.registerConnectionType(b,
a[b])},registerEndpointType:function(a,b){this._endpointTypes[a]=l.jsPlumb.extend({},b);if(b.overlays){for(var c={},d=0;d<b.overlays.length;d++){var f=this.convertToFullOverlaySpec(b.overlays[d]);c[f[1].id]=f}this._endpointTypes[a].overlays=c}},registerEndpointTypes:function(a){for(var b in a)this.registerEndpointType(b,a[b])},getType:function(a,b){return"connection"===b?this._connectionTypes[a]:this._endpointTypes[a]},setIdChanged:function(a,b){this.setId(a,b,!0)},setParent:function(a,b){a=this.getElement(a);
var c=this.getId(a);b=this.getElement(b);var d=this.getId(b);a.parentNode.removeChild(a);b.appendChild(a);this.getDragManager().setParent(a,c,b,d)},extend:function(a,b,c){var d;if(c)for(d=0;d<c.length;d++)a[c[d]]=b[c[d]];else for(d in b)a[d]=b[d];return a},floatingConnections:{},getFloatingAnchorIndex:function(a){return a.endpoints[0].isFloating()?0:a.endpoints[1].isFloating()?1:-1}});var d=new f;l.jsPlumb=d;d.getInstance=function(a){a=new f(a);a.init();return a};d.each=function(a,b){if(null!=a)if("string"===
typeof a)b(d.getElement(a));else if(null!=a.length)for(var c=0;c<a.length;c++)b(d.getElement(a[c]));else b(a)};"function"===typeof define&&(define("jsplumb",[],function(){return d}),define("jsplumbinstance",[],function(){return d.getInstance()}));"undefined"!==typeof exports&&(exports.jsPlumb=d);"undefined"!==typeof module&&(module.exports=d)}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumbUtil;window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");var p=function(b,g){if(null==b)return[0,0];b=b.touches&&0<b.touches.length?b.touches:b.changedTouches&&0<b.changedTouches.length?b.changedTouches:b.targetTouches&&0<b.targetTouches.length?b.targetTouches:[b];b=b.item?b.item(0):b[0];return[b[g+"X"],b[g+"Y"]]},t=function(b){var g={},h=[],m={},e={},k={};this.register=function(a){var c=b.getId(a),f=b.getOffset(a);
g[c]||(g[c]=a,h.push(a),m[c]={});var d=function(a){if(a)for(var g=0;g<a.childNodes.length;g++)if(3!=a.childNodes[g].nodeType&&8!=a.childNodes[g].nodeType){var h=jsPlumb.getElement(a.childNodes[g]),u=b.getId(a.childNodes[g],null,!0);u&&e[u]&&0<e[u]&&(h=b.getOffset(h),m[c][u]={id:u,offset:{left:h.left-f.left,top:h.top-f.top}},k[u]=c);d(a.childNodes[g])}};d(a)};this.updateOffsets=function(a,c){if(null!=a){c=c||{};var f=jsPlumb.getElement(a);a=b.getId(f);var d=m[a],f=b.getOffset(f);if(d)for(var e in d)if(d.hasOwnProperty(e)){var g=
jsPlumb.getElement(e),h=c[e]||b.getOffset(g);if(null!=g.offsetParent||null==m[a][e])m[a][e]={id:e,offset:{left:h.left-f.left,top:h.top-f.top}},k[e]=a}}};this.endpointAdded=function(a,c){c=c||b.getId(a);var f=document.body,d=a.parentNode;for(e[c]=e[c]?e[c]+1:1;null!=d&&d!=f;){var h=b.getId(d,null,!0);if(h&&g[h]){f=b.getOffset(d);null==m[h][c]&&(a=b.getOffset(a),m[h][c]={id:c,offset:{left:a.left-f.left,top:a.top-f.top}},k[c]=h);break}d=d.parentNode}};this.endpointDeleted=function(a){if(e[a.elementId]&&
(e[a.elementId]--,0>=e[a.elementId]))for(var b in m)m.hasOwnProperty(b)&&m[b]&&(delete m[b][a.elementId],delete k[a.elementId])};this.changeId=function(a,b){m[b]=m[a];m[a]={};k[b]=k[a];k[a]=null};this.getElementsForDraggable=function(a){return m[a]};this.elementRemoved=function(a){var b=k[a];b&&(delete m[b][a],delete k[a])};this.reset=function(){g={};h=[];m={};e={}};this.dragEnded=function(a){null!=a.offsetParent&&(a=b.getId(a),(a=k[a])&&this.updateOffsets(a))};this.setParent=function(a,c,f,d,e){var g=
k[c];m[d]||(m[d]={});f=b.getOffset(f);a=e||b.getOffset(a);g&&delete m[g][c];m[d][c]={id:c,offset:{left:a.left-f.left,top:a.top-f.top}};k[c]=d};this.clearParent=function(a,b){if(a=k[b])delete m[a][b],delete k[b]};this.revalidateParent=function(a,c,f){if(a=k[c]){var d={};d[c]=f;this.updateOffsets(a,d);b.revalidate(a)}};this.getDragAncestor=function(a){a=jsPlumb.getElement(a);a=b.getId(a);return(a=k[a])?jsPlumb.getElement(a):null}},q=function(b,g){g=null==g?null:g.replace(/^\s\s*/,"").replace(/\s\s*$/,
"");"undefined"!=typeof b.className.baseVal?b.className.baseVal=g:b.className=g},n=function(b){return"undefined"==typeof b.className.baseVal?b.className:b.className.baseVal},h=function(b,g,h){g=null==g?[]:l.isArray(g)?g:g.split(/\s+/);h=null==h?[]:l.isArray(h)?h:h.split(/\s+/);var m=n(b).split(/\s+/),e=function(b,a){for(var c=0;c<a.length;c++)if(b)-1==m.indexOf(a[c])&&m.push(a[c]);else{var f=m.indexOf(a[c]);-1!=f&&m.splice(f,1)}};e(!0,g);e(!1,h);q(b,m.join(" "))};this.jsPlumb.extend(this.jsPlumbInstance.prototype,
{headless:!1,pageLocation:function(b){return null==b?[0,0]:p(b,"page")},screenLocation:function(b){return p(b,"screen")},clientLocation:function(b){return p(b,"client")},getDragManager:function(){null==this.dragManager&&(this.dragManager=new t(this));return this.dragManager},recalculateOffsets:function(b){this.getDragManager().updateOffsets(b)},createElement:function(b,g,h,m){return this.createElementNS(null,b,g,h,m)},createElementNS:function(b,g,h,m,e){b=null==b?document.createElement(g):document.createElementNS(b,
g);var k;h=h||{};for(k in h)b.style[k]=h[k];m&&(b.className=m);e=e||{};for(k in e)b.setAttribute(k,""+e[k]);return b},getAttribute:function(b,g){return null!=b.getAttribute?b.getAttribute(g):null},setAttribute:function(b,g,h){null!=b.setAttribute&&b.setAttribute(g,h)},setAttributes:function(b,g){for(var h in g)g.hasOwnProperty(h)&&b.setAttribute(h,g[h])},appendToRoot:function(b){document.body.appendChild(b)},getRenderModes:function(){return["svg"]},getClass:n,addClass:function(b,g){jsPlumb.each(b,
function(b){h(b,g)})},hasClass:function(b,g){b=jsPlumb.getElement(b);return b.classList?b.classList.contains(g):-1!=n(b).indexOf(g)},removeClass:function(b,g){jsPlumb.each(b,function(b){h(b,null,g)})},updateClasses:function(b,g,n){jsPlumb.each(b,function(b){h(b,g,n)})},setClass:function(b,g){jsPlumb.each(b,function(b){q(b,g)})},setPosition:function(b,g){b.style.left=g.left+"px";b.style.top=g.top+"px"},getPosition:function(b){var g=function(g){return(g=b.style[g])?g.substring(0,g.length-2):0};return{left:g("left"),
top:g("top")}},getStyle:function(b,g){return"undefined"!==typeof window.getComputedStyle?getComputedStyle(b,null).getPropertyValue(g):b.currentStyle[g]},getSelector:function(b,g){return 1==arguments.length?null!=b.nodeType?b:document.querySelectorAll(b):b.querySelectorAll(g)},getOffset:function(b,g,h){b=jsPlumb.getElement(b);h=h||this.getContainer();for(var m={left:b.offsetLeft,top:b.offsetTop},e=g||null!=h&&b!=h&&b.offsetParent!=h?b.offsetParent:null,k=function(a){null!=a&&a!==document.body&&(0<
a.scrollTop||0<a.scrollLeft)&&(m.left-=a.scrollLeft,m.top-=a.scrollTop)}.bind(this);null!=e;)m.left+=e.offsetLeft,m.top+=e.offsetTop,k(e),e=g?e.offsetParent:e.offsetParent==h?null:e.offsetParent;null!=h&&!g&&(0<h.scrollTop||0<h.scrollLeft)&&(g=null!=b.offsetParent?this.getStyle(b.offsetParent,"position"):"static",b=this.getStyle(b,"position"),"absolute"!==b&&"fixed"!==b&&"absolute"!==g&&"fixed"!=g&&(m.left-=h.scrollLeft,m.top-=h.scrollTop));return m},getPositionOnElement:function(b,g,h){var m="undefined"!==
typeof g.getBoundingClientRect?g.getBoundingClientRect():{left:0,top:0,width:0,height:0},e=document.body,k=document.documentElement,a=m.top+(window.pageYOffset||k.scrollTop||e.scrollTop)-(k.clientTop||e.clientTop||0)+0*h,e=m.left+(window.pageXOffset||k.scrollLeft||e.scrollLeft)-(k.clientLeft||e.clientLeft||0)+0*h;b=jsPlumb.pageLocation(b);return[(b[0]-e)/(m.width||g.offsetWidth*h),(b[1]-a)/(m.height||g.offsetHeight*h)]},getAbsolutePosition:function(b){var g=function(g){if(g=b.style[g])return parseFloat(g.substring(0,
g.length-2))};return[g("left"),g("top")]},setAbsolutePosition:function(b,g,h,m){h?this.animate(b,{left:"+="+(g[0]-h[0]),top:"+="+(g[1]-h[1])},m):(b.style.left=g[0]+"px",b.style.top=g[1]+"px")},getSize:function(b){return[b.offsetWidth,b.offsetHeight]},getWidth:function(b){return b.offsetWidth},getHeight:function(b){return b.offsetHeight}})}).call("undefined"!==typeof window?window:this);
(function(){var l=this,p=l.jsPlumb,t=l.jsPlumbUtil;p.OverlayCapableJsPlumbUIComponent=function(q){l.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};q.label&&(this.getDefaultType().overlays.__label=["Label",{label:q.label,location:q.labelLocation||this.defaultLabelLocation||.5,labelStyle:q.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:"__label"}]);this.setListenerComponent=function(n){if(this._jsPlumb)for(var h in this._jsPlumb.overlays)this._jsPlumb.overlays[h].setListenerComponent(n)}};
p.OverlayCapableJsPlumbUIComponent.applyType=function(l,n){if(n.overlays){var h={},b;for(b in n.overlays){var g=l._jsPlumb.overlays[n.overlays[b][1].id];g?(g.updateFrom(n.overlays[b][1]),h[n.overlays[b][1].id]=!0):(g=l.getCachedTypeItem("overlay",n.overlays[b][1].id),null!=g?(g.reattach(l._jsPlumb.instance),g.setVisible(!0),g.updateFrom(n.overlays[b][1]),l._jsPlumb.overlays[g.id]=g):g=l.addOverlay(n.overlays[b],!0),h[g.id]=!0)}for(b in l._jsPlumb.overlays)null==h[l._jsPlumb.overlays[b].id]&&l.removeOverlay(l._jsPlumb.overlays[b].id,
!0)}};t.extend(p.OverlayCapableJsPlumbUIComponent,l.jsPlumbUIComponent,{setHover:function(l,n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var h in this._jsPlumb.overlays)this._jsPlumb.overlays[h][l?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(l,n){if(t.isArray(l)){var h=l[0],b=p.extend({component:this,_jsPlumb:this._jsPlumb.instance},l[1]);3==l.length&&p.extend(b,l[2]);l=new (p.Overlays[this._jsPlumb.instance.getRenderMode()][h])(b)}else l=
l.constructor==String?new (p.Overlays[this._jsPlumb.instance.getRenderMode()][l])({component:this,_jsPlumb:this._jsPlumb.instance}):l;l.id=l.id||t.uuid();this.cacheTypeItem("overlay",l,l.id);this._jsPlumb.overlays[l.id]=l;n||this.repaint();return l},getOverlay:function(l){return this._jsPlumb.overlays[l]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(l){(l=this.getOverlay(l))&&l.hide()},hideOverlays:function(){for(var l in this._jsPlumb.overlays)this._jsPlumb.overlays[l].hide()},
showOverlay:function(l){(l=this.getOverlay(l))&&l.show()},showOverlays:function(){for(var l in this._jsPlumb.overlays)this._jsPlumb.overlays[l].show()},removeAllOverlays:function(l){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].cleanup&&this._jsPlumb.overlays[n].cleanup();this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;l||this.repaint()},removeOverlay:function(l,n){var h=this._jsPlumb.overlays[l];h&&(h.setVisible(!1),!n&&h.cleanup&&h.cleanup(),delete this._jsPlumb.overlays[l],
this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[l])},removeOverlays:function(){for(var l=0,n=arguments.length;l<n;l++)this.removeOverlay(arguments[l])},moveParent:function(l){this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),l.appendChild(this.bgCanvas));if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas);l.appendChild(this.canvas);for(var n in this._jsPlumb.overlays)if(this._jsPlumb.overlays[n].isAppendedAtTopLevel){var h=
this._jsPlumb.overlays[n].getElement();h.parentNode.removeChild(h);l.appendChild(h)}}},getLabel:function(){var l=this.getOverlay("__label");return null!=l?l.getLabel():null},getLabelOverlay:function(){return this.getOverlay("__label")},setLabel:function(l){var n=this.getOverlay("__label");n?l.constructor==String||l.constructor==Function?n.setLabel(l):(l.label&&n.setLabel(l.label),l.location&&n.setLocation(l.location)):(l=l.constructor==String||l.constructor==Function?{label:l}:l,l=p.extend({cssClass:l.cssClass,
labelStyle:this.labelStyle,id:"__label",component:this,_jsPlumb:this._jsPlumb.instance},l),n=new (p.Overlays[this._jsPlumb.instance.getRenderMode()].Label)(l),this._jsPlumb.overlays.__label=n);this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(l){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].cleanup(l),this._jsPlumb.overlays[n].destroy(l);l&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(l){this[l?"showOverlays":"hideOverlays"]()},
setAbsoluteOverlayPosition:function(l,n){this._jsPlumb.overlayPositions[l.id]=n},getAbsoluteOverlayPosition:function(l){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[l.id]:null},_clazzManip:function(l,n,h){if(!h)for(var b in this._jsPlumb.overlays)this._jsPlumb.overlays[b][l+"Class"](n)},addClass:function(l,n){this._clazzManip("add",l,n)},removeClass:function(l,n){this._clazzManip("remove",l,n)}})}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumb,p=this.jsPlumbUtil,t=function(l,h,b){var g=!1;return{drag:function(){if(g)return g=!1,!0;if(h.element){var n=b.getUIPosition(arguments,b.getZoom());null!=n&&jsPlumb.setPosition(h.element,n);b.repaint(h.element,n);l.paint({anchorPoint:l.anchor.getCurrentLocation({element:l.element})})}},stopDrag:function(){g=!0}}},q="connectorStyle connectorHoverStyle connectorOverlays connector connectionType connectorClass connectorHoverClass".split(" ");l.Endpoint=function(n){var h=
n._jsPlumb,b=n.newConnection,g=n.newEndpoint;this.idPrefix="_jsplumb_e_";this.defaultLabelLocation=[.5,.5];this.defaultOverlayKeys=["Overlays","EndpointOverlays"];l.OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.appendToDefaultType({connectionType:n.connectionType,maxConnections:null==n.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:n.maxConnections,paintStyle:n.endpointStyle||n.paintStyle||n.style||this._jsPlumb.instance.Defaults.EndpointStyle||l.Defaults.EndpointStyle,
hoverPaintStyle:n.endpointHoverStyle||n.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||l.Defaults.EndpointHoverStyle,connectorStyle:n.connectorStyle,connectorHoverStyle:n.connectorHoverStyle,connectorClass:n.connectorClass,connectorHoverClass:n.connectorHoverClass,connectorOverlays:n.connectorOverlays,connector:n.connector,connectorTooltip:n.connectorTooltip});this._jsPlumb.enabled=!1!==n.enabled;this._jsPlumb.visible=!0;this.element=l.getElement(n.source);this._jsPlumb.uuid=
n.uuid;this._jsPlumb.floatingEndpoint=null;this._jsPlumb.uuid&&(n.endpointsByUUID[this._jsPlumb.uuid]=this);this.elementId=n.elementId;this.dragProxy=n.dragProxy;this._jsPlumb.connectionCost=n.connectionCost;this._jsPlumb.connectionsDirected=n.connectionsDirected;this._jsPlumb.currentAnchorClass="";this._jsPlumb.events={};var r=function(){var a=h.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var b=h.endpointAnchorClassPrefix+
(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(a);this.addClass(b);jsPlumb.updateClasses(this.element,b,a)}.bind(this);this.prepareAnchor=function(a){a=this._jsPlumb.instance.makeAnchor(a,this.elementId,h);a.bind("anchorChanged",function(a){this.fire("anchorChanged",{endpoint:this,anchor:a});r()}.bind(this));return a};this.setPreparedAnchor=function(a,b){this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);this.anchor=a;r();b||this._jsPlumb.instance.repaint(this.elementId);
return this};this.setAnchor=function(a,b){a=this.prepareAnchor(a);this.setPreparedAnchor(a,b);return this};var m=function(a){if(0<this.connections.length)for(var b=0;b<this.connections.length;b++)this.connections[b].setHover(a,!1);else this.setHover(a)}.bind(this);this.bind("mouseover",function(){m(!0)});this.bind("mouseout",function(){m(!1)});n._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId);this.prepareEndpoint=function(a,b){var c=function(a,b){var c=h.getRenderMode();
if(l.Endpoints[c][a])return new l.Endpoints[c][a](b);if(!h.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+a+"'"};},d={_jsPlumb:this._jsPlumb.instance,cssClass:n.cssClass,container:n.container,tooltip:n.tooltip,connectorTooltip:n.connectorTooltip,endpoint:this},e;p.isString(a)?e=c(a,d):p.isArray(a)?(d=p.merge(a[1],d),e=c(a[0],d)):e=a.clone();e.clone=function(){if(p.isString(a))return c(a,d);if(p.isArray(a))return d=p.merge(a[1],d),c(a[0],d)}.bind(this);e.typeId=b;return e};
this.setEndpoint=function(a,b){a=this.prepareEndpoint(a);this.setPreparedEndpoint(a,!0)};this.setPreparedEndpoint=function(a,b){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());this.endpoint=a;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas};l.extend(this,n,q);this.isSource=n.isSource||!1;this.isTemporarySource=n.isTemporarySource||!1;this.isTarget=n.isTarget||!1;this.connections=n.connections||[];this.connectorPointerEvents=n["connector-pointer-events"];this.scope=
n.scope||h.getDefaultScope();this.timestamp=null;this.reattachConnections=n.reattach||h.Defaults.ReattachConnections;this.connectionsDetachable=h.Defaults.ConnectionsDetachable;if(!1===n.connectionsDetachable||!1===n.detachable)this.connectionsDetachable=!1;this.dragAllowedWhenFull=!1!==n.dragAllowedWhenFull;n.onMaxConnections&&this.bind("maxConnections",n.onMaxConnections);this.addConnection=function(a){this.connections.push(a);this[(0<this.connections.length?"add":"remove")+"Class"](h.endpointConnectedClass);
this[(this.isFull()?"add":"remove")+"Class"](h.endpointFullClass)};this.detachFromConnection=function(a,b,f){b=null==b?this.connections.indexOf(a):b;0<=b&&(this.connections.splice(b,1),this[(0<this.connections.length?"add":"remove")+"Class"](h.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](h.endpointFullClass));(this._forceDeleteOnDetach||!f&&this._deleteOnDetach)&&0===this.connections.length&&h.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!0!==f})};this.detach=
function(a){var b=a.connectionIndex,f=a.connection,d=a.ignoreTarget,e=a.fireEvent,k=a.originalEvent,g=a.endpointBeingDeleted,m=a.forceDetach,b=null==b?this.connections.indexOf(f):b,l=!1,e=!1!==e;0<=b&&(m||f._forceDetach||f.isDetachable()&&f.isDetachAllowed(f)&&this.isDetachAllowed(f)&&h.checkCondition("beforeDetach",f,g))&&(h.deleteObject({connection:f,fireEvent:!d&&e,originalEvent:k,deleteAttachedObjects:a.deleteAttachedObjects}),l=!0);return l};this.detachAll=function(a,b){for(var c=[];0<this.connections.length;)this.detach({connection:this.connections[0],
ignoreTarget:!1,forceDetach:!0===b,fireEvent:!1!==a,originalEvent:null,endpointBeingDeleted:this,connectionIndex:0})||(c.push(this.connections[0]),this.connections.splice(0,1));this.connections=c;return this};this.detachFrom=function(a,b,f){for(var c=[],e=0;e<this.connections.length;e++)this.connections[e].endpoints[1]!=a&&this.connections[e].endpoints[0]!=a||c.push(this.connections[e]);for(a=0;a<c.length;a++)this.detach({connection:c[a],ignoreTarget:!1,forceDetach:!0,fireEvent:b,originalEvent:f});
return this};this.getElement=function(){return this.element};this.setElement=function(a){var b=this._jsPlumb.instance.getId(a),f=this.elementId;p.removeWithFunction(n.endpointsByElement[this.elementId],function(a){return a.id==this.id}.bind(this));this.element=jsPlumb.getElement(a);this.elementId=h.getId(this.element);h.anchorManager.rehomeEndpoint(this,f,this.element);h.dragManager.endpointAdded(this.element);p.addToList(n.endpointsByElement,b,this);return this};this.makeInPlaceCopy=function(){var a=
this.anchor.getCurrentLocation({element:this}),b=this.anchor.getOrientation(this),f=this.anchor.getCssClass();return g({dropOptions:n.dropOptions,anchor:{bind:function(){},compute:function(){return[a[0],a[1]]},getCurrentLocation:function(){return[a[0],a[1]]},getOrientation:function(){return b},getCssClass:function(){return f}},source:this.element,paintStyle:this.getPaintStyle(),endpoint:n.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})};this.connectorSelector=function(){var a=
this.connections[0];return a?a:this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:a};this.setStyle=this.setPaintStyle;this.paint=function(a){a=a||{};var b=a.timestamp,f=!1!==a.recalc;if(!b||this.timestamp!==b){var d=h.updateOffset({elId:this.elementId,timestamp:b}),e=a.offset?a.offset.o:d.o;if(null!=e){var k=a.anchorPoint,g=a.connectorPaintStyle;if(null==k){d={xy:[e.left,e.top],wh:a.dimensions||d.s,element:this,timestamp:b};if(f&&this.anchor.isDynamic&&0<this.connections.length){a=
a.elementWithPrecedence;f=0;if(null!=a)for(e=0;e<this.connections.length;e++)if(this.connections[e].sourceId==a||this.connections[e].targetId==a){f=e;break}a=this.connections[f];f=a.endpoints[0]==this?1:0;k=h.getCachedData(0===f?a.sourceId:a.targetId);e=k.o;k=k.s;d.txy=[e.left,e.top];d.twh=k;d.tElement=a.endpoints[f]}k=this.anchor.compute(d)}this.endpoint.compute(k,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,g||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,
this.anchor);this.timestamp=b;for(var m in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(m)&&(b=this._jsPlumb.overlays[m],b.isVisible()&&(this._jsPlumb.overlayPlacements[m]=b.draw(this.endpoint,this._jsPlumb.paintStyleInUse),b.paint(this._jsPlumb.overlayPlacements[m])))}}};this.getTypeDescriptor=function(){return"endpoint"};this.isVisible=function(){return this._jsPlumb.visible};this.repaint=this.paint;var e=!1;this.initDraggable=function(){if(!e&&l.isDragSupported(this.element)){var a=
{id:null,element:null},c=null,f=!1,d=null,k=t(this,a,h),m=n.dragOptions||{},r=l.dragEvents.start,w=l.dragEvents.stop,q=l.dragEvents.drag,B=l.dragEvents.beforeStart,C,D=function(e){c=this.connectorSelector();var m=!0;this.isEnabled()||(m=!1);null!=c||this.isSource||this.isTemporarySource||(m=!1);!this.isSource||!this.isFull()||null!=c&&this.dragAllowedWhenFull||(m=!1);null==c||c.isDetachable(this)||(m=!1);e=h.checkCondition(null==c?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,
sourceId:this.elementId,connection:c});!1===e?m=!1:"object"===typeof e?jsPlumb.extend(e,C||{}):e=C||{};if(!1===m)return h.stopDrag&&h.stopDrag(this.canvas),k.stopDrag(),!1;for(m=0;m<this.connections.length;m++)this.connections[m].setHover(!1);this.addClass("endpointDrag");h.setConnectionBeingDragged(!0);c&&!this.isFull()&&this.isSource&&(c=null);h.updateOffset({elId:this.elementId});var u=this._jsPlumb.instance.getOffset(this.canvas),m=this.canvas,r=this._jsPlumb.instance.getSize(this.canvas),v=h,
x=jsPlumb.createElement("div",{position:"absolute"});v.appendElement(x);var q=v.getId(x);jsPlumb.setPosition(x,u);x.style.width=r[0]+"px";x.style.height=r[1]+"px";v.manage(q,x,!0);a.id=q;a.element=x;h.setAttributes(this.canvas,{dragId:a.id,elId:this.elementId});x=this.dragProxy||this.endpoint;null==this.dragProxy&&null!=this.connectionType&&(u=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType),u.endpoints[1]&&(x=u.endpoints[1]));v=this._jsPlumb.instance.makeAnchor("Center");v.isFloating=
!0;var u=this._jsPlumb,r=this.getPaintStyle(),q=a.element,w=g,H=this.scope,v=new l.FloatingAnchor({reference:v,referenceCanvas:this.canvas,jsPlumbInstance:h}),r=w({paintStyle:r,endpoint:x,anchor:v,source:q,scope:H});u.floatingEndpoint=r;u=this._jsPlumb.floatingEndpoint.anchor;null==c?(this.setHover(!1,!1),c=b({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:a.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:n.connectorStyle,
hoverPaintStyle:n.connectorHoverStyle,connector:n.connector,overlays:n.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:n.scope,data:e}),c.pending=!0,c.addClass(h.draggingClass),this._jsPlumb.floatingEndpoint.addClass(h.draggingClass),this._jsPlumb.floatingEndpoint.anchor=u,h.fire("connectionDrag",c),h.anchorManager.newConnection(c)):(f=!0,c.setHover(!1),e=c.endpoints[0].id==this.id?0:1,this.detachFromConnection(c,null,!0),u=h.getDragScope(m),
h.setAttribute(this.canvas,"originalScope",u),h.fire("connectionDrag",c),0===e?(d=[c.source,c.sourceId,m,u],h.anchorManager.sourceChanged(c.endpoints[e].elementId,a.id,c,a.element)):(d=[c.target,c.targetId,m,u],c.target=a.element,c.targetId=a.id,h.anchorManager.updateOtherEndpoint(c.sourceId,c.endpoints[e].elementId,c.targetId,c)),c.suspendedEndpoint=c.endpoints[e],c.suspendedElement=c.endpoints[e].getElement(),c.suspendedElementId=c.endpoints[e].elementId,c.suspendedElementType=0===e?"source":"target",
c.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=c.suspendedEndpoint,c.endpoints[e]=this._jsPlumb.floatingEndpoint,c.addClass(h.draggingClass),this._jsPlumb.floatingEndpoint.addClass(h.draggingClass));h.floatingConnections[a.id]=c;p.addToList(n.endpointsByElement,a.id,this._jsPlumb.floatingEndpoint);h.currentlyDragging=!0}.bind(this),x=function(){h.setConnectionBeingDragged(!1);if(c&&null!=c.endpoints){var b=h.getDropEvent(arguments),e=h.getFloatingAnchorIndex(c);
c.endpoints[0===e?1:0].anchor.locked=!1;c.removeClass(h.draggingClass);if(this._jsPlumb&&(c.deleteConnectionNow||c.endpoints[e]==this._jsPlumb.floatingEndpoint)&&f&&c.suspendedEndpoint){0===e?(c.floatingElement=c.source,c.floatingId=c.sourceId,c.floatingEndpoint=c.endpoints[0],c.floatingIndex=0,c.source=d[0],c.sourceId=d[1]):(c.floatingElement=c.target,c.floatingId=c.targetId,c.floatingEndpoint=c.endpoints[1],c.floatingIndex=1,c.target=d[0],c.targetId=d[1]);var k=this._jsPlumb.floatingEndpoint;h.setDragScope(d[2],
d[3]);c.endpoints[e]=c.suspendedEndpoint;c.isReattach()||c._forceReattach||c._forceDetach||!c.endpoints[0===e?1:0].detach({connection:c,ignoreTarget:!1,forceDetach:!1,fireEvent:!0,originalEvent:b,endpointBeingDeleted:!0})?(c.setHover(!1),c._forceDetach=null,c._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(c),c.suspendedEndpoint.addConnection(c),1==e?h.anchorManager.updateOtherEndpoint(c.sourceId,c.floatingId,c.targetId,c):h.anchorManager.sourceChanged(c.floatingId,c.sourceId,
c,c.source),h.repaint(d[1])):h.deleteObject({endpoint:k})}this.deleteAfterDragStop?h.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1});h.fire("connectionDragStop",c,b);c.pending&&h.fire("connectionAborted",c,b);h.currentlyDragging=!1;c.suspendedElement=null;c=c.suspendedEndpoint=null}a&&a.element&&h.remove(a.element,!1,!1);this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this),m=l.extend({},m);m.scope=this.scope||
m.scope;m[B]=p.wrap(m[B],function(a){C=a.e.payload||{}},!1);m[r]=p.wrap(m[r],D,!1);m[q]=p.wrap(m[q],k.drag);m[w]=p.wrap(m[w],x);m.multipleDrop=!1;m.canDrag=function(){return this.isSource||this.isTemporarySource||0<this.connections.length}.bind(this);h.initDraggable(this.canvas,m,"internal");this.canvas._jsPlumbRelatedElement=this.element;e=!0}};this.setEndpoint(n.endpoint||this._jsPlumb.instance.Defaults.Endpoint||l.Defaults.Endpoint,!0);this.setAnchor(n.anchor?n.anchor:n.anchors?n.anchors:h.Defaults.Anchor||
"Top",!0);var k=["default",n.type||""].join(" ");this.addType(k,n.data,!0);this.canvas=this.endpoint.canvas;this.canvas._jsPlumb=this;this.initDraggable();k=function(a,b,f,d){if(l.isDropSupported(this.element)){var c=n.dropOptions||h.Defaults.DropOptions||l.Defaults.DropOptions,c=l.extend({},c);c.scope=c.scope||this.scope;var e=l.dragEvents.drop,k=l.dragEvents.over,g=l.dragEvents.out,m=this;d=h.EndpointDropHandler({getEndpoint:function(){return m},jsPlumb:h,enabled:function(){return null!=f?f.isEnabled():
!0},isFull:function(){return f.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(a){m.addClass(a)},removeClass:function(a){m.removeClass(a)},isDropAllowed:function(){return m.isDropAllowed.apply(m,arguments)},reference:d,isRedrop:function(a,b){return a.suspendedEndpoint&&b.reference&&a.suspendedEndpoint.id===b.reference.id}});c[e]=p.wrap(c[e],d,!0);c[k]=p.wrap(c[k],function(){var a=l.getDragObject(arguments),a=h.getAttribute(l.getElement(a),
"dragId"),a=h.floatingConnections[a];if(null!=a){var b=h.getFloatingAnchorIndex(a);if(this.isTarget&&0!==b||a.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==a.suspendedEndpoint.id){var c=h.checkCondition("checkDropAllowed",{sourceEndpoint:a.endpoints[b],targetEndpoint:this,connection:a});this[(c?"add":"remove")+"Class"](h.endpointDropAllowedClass);this[(c?"remove":"add")+"Class"](h.endpointDropForbiddenClass);a.endpoints[b].anchor.over(this.anchor,this)}}}.bind(this));c[g]=
p.wrap(c[g],function(){var a=l.getDragObject(arguments),a=(a=null==a?null:h.getAttribute(l.getElement(a),"dragId"))?h.floatingConnections[a]:null;if(null!=a){var b=h.getFloatingAnchorIndex(a);if(this.isTarget&&0!==b||a.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==a.suspendedEndpoint.id)this.removeClass(h.endpointDropAllowedClass),this.removeClass(h.endpointDropForbiddenClass),a.endpoints[b].anchor.out()}}.bind(this));h.initDroppable(a,c,"internal",b)}}.bind(this);this.anchor.isFloating||
k(this.canvas,!(n._transient||this.anchor.isFloating),this,n.reference);return this};p.extend(l.Endpoint,l.OverlayCapableJsPlumbUIComponent,{setVisible:function(l,h,b){this._jsPlumb.visible=l;this.canvas&&(this.canvas.style.display=l?"block":"none");this[l?"showOverlays":"hideOverlays"]();if(!h)for(h=0;h<this.connections.length;h++)if(this.connections[h].setVisible(l),!b){var g=this===this.connections[h].endpoints[0]?1:0;1==this.connections[h].endpoints[g].connections.length&&this.connections[h].endpoints[g].setVisible(l,
!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(n,h){this.setPaintStyle(n.endpointStyle||n.paintStyle,h);this.setHoverPaintStyle(n.endpointHoverStyle||n.hoverPaintStyle,h);null!=n.maxConnections&&(this._jsPlumb.maxConnections=n.maxConnections);n.scope&&(this.scope=n.scope);l.extend(this,n,q);null!=n.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,n.cssClass);l.OverlayCapableJsPlumbUIComponent.applyType(this,n)},isEnabled:function(){return this._jsPlumb.enabled},
setEnabled:function(l){this._jsPlumb.enabled=l},cleanup:function(){jsPlumb.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:""));this.anchor=null;this.endpoint.cleanup(!0);this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(l){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&
this.endpoint.setHover(l)},isFull:function(){return 0===this._jsPlumb.maxConnections?!0:!(this.isFloating()||0>this._jsPlumb.maxConnections||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(l){var h=!1;if(l)for(var b=0;b<this.connections.length;b++)if(this.connections[b].endpoints[1]==l||this.connections[b].endpoints[0]==l){h=!0;break}return h},getConnectionCost:function(){return this._jsPlumb.connectionCost},
setConnectionCost:function(l){this._jsPlumb.connectionCost=l},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(l){this._jsPlumb.connectionsDirected=l},setElementId:function(l){this.elementId=l;this.anchor.elementId=l},setReferenceElement:function(n){this.element=l.getElement(n)},setDragAllowedWhenFull:function(l){this.dragAllowedWhenFull=l},equals:function(l){return this.anchor.equals(l.anchor)},getUuid:function(){return this._jsPlumb.uuid},
computeAnchor:function(l){return this.anchor.compute(l)}});this.jsPlumbInstance.prototype.EndpointDropHandler=function(l){return function(h){var b=l.jsPlumb;l.removeClass(b.endpointDropAllowedClass);l.removeClass(b.endpointDropForbiddenClass);var g=b.getDropEvent(arguments),r=b.getDragObject(arguments),m=b.getAttribute(r,"dragId");b.getAttribute(r,"elId");var e=b.getAttribute(r,"originalScope"),k=b.floatingConnections[m];if(null!=k){var a=null!=k.suspendedEndpoint;if(!a||null!=k.suspendedEndpoint._jsPlumb){var c=
l.getEndpoint(k);if(null!=c)if(l.isRedrop(k,l))k._forceReattach=!0,k.setHover(!1),l.maybeCleanup&&l.maybeCleanup(c);else{var f=b.getFloatingAnchorIndex(k);if(0===f&&!l.isSource||1===f&&!l.isTarget)l.maybeCleanup&&l.maybeCleanup(c);else{if(l.onDrop)l.onDrop(k);e&&b.setDragScope(r,e);(r=l.isFull(h))&&c.fire("maxConnections",{endpoint:this,connection:k,maxConnections:c._jsPlumb.maxConnections},g);if(!r&&l.enabled()){r=!0;0===f?(k.floatingElement=k.source,k.floatingId=k.sourceId,k.floatingEndpoint=k.endpoints[0],
k.floatingIndex=0,k.source=l.element,k.sourceId=l.elementId):(k.floatingElement=k.target,k.floatingId=k.targetId,k.floatingEndpoint=k.endpoints[1],k.floatingIndex=1,k.target=l.element,k.targetId=l.elementId);a&&k.suspendedEndpoint.id!=c.id&&(k.isDetachAllowed(k)&&k.endpoints[f].isDetachAllowed(k)&&k.suspendedEndpoint.isDetachAllowed(k)&&b.checkCondition("beforeDetach",k)||(r=!1));m=function(d){k.endpoints[f].detachFromConnection(k);k.suspendedEndpoint&&k.suspendedEndpoint.detachFromConnection(k);
k.endpoints[f]=c;c.addConnection(k);var e=c.getParameters(),h;for(h in e)k.setParameter(h,e[h]);a?(e=k.suspendedEndpoint.elementId,b.fireMoveEvent({index:f,originalSourceId:0===f?e:k.sourceId,newSourceId:0===f?c.elementId:k.sourceId,originalTargetId:1==f?e:k.targetId,newTargetId:1==f?c.elementId:k.targetId,originalSourceEndpoint:0===f?k.suspendedEndpoint:k.endpoints[0],newSourceEndpoint:0===f?c:k.endpoints[0],originalTargetEndpoint:1==f?k.suspendedEndpoint:k.endpoints[1],newTargetEndpoint:1==f?c:
k.endpoints[1],connection:k},g)):e.draggable&&b.initDraggable(this.element,dragOptions,"internal",b);1==f?b.anchorManager.updateOtherEndpoint(k.sourceId,k.floatingId,k.targetId,k):b.anchorManager.sourceChanged(k.floatingId,k.sourceId,k,k.source);k.endpoints[0].finalEndpoint&&(k.endpoints[0].detachFromConnection(k),k.endpoints[0]=k.endpoints[0].finalEndpoint,k.endpoints[0].addConnection(k));p.isObject(d)&&k.mergeData(d);b.finaliseConnection(k,null,g,!1);k.setHover(!1)}.bind(this);if(r=r&&l.isDropAllowed(k.sourceId,
k.targetId,k.scope,k,c))return m(r),!0;k.suspendedEndpoint&&(k.endpoints[f]=k.suspendedEndpoint,k.setHover(!1),k._forceDetach=!0,0===f?(k.source=k.suspendedEndpoint.element,k.sourceId=k.suspendedEndpoint.elementId):(k.target=k.suspendedEndpoint.element,k.targetId=k.suspendedEndpoint.elementId),k.suspendedEndpoint.addConnection(k),1==f?b.anchorManager.updateOtherEndpoint(k.sourceId,k.floatingId,k.targetId,k):b.anchorManager.sourceChanged(k.floatingId,k.sourceId,k,k.source),b.repaint(k.sourceId),k._forceDetach=
!1)}l.maybeCleanup&&l.maybeCleanup(c);b.currentlyDragging=!1}}}}}}}).call("undefined"!==typeof window?window:this);
(function(){var l=this,p=l.jsPlumb,t=l.jsPlumbUtil,q=function(b,g,h,m,e){if(!b.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[g][h])throw{msg:"jsPlumb: unknown connector type '"+h+"'"};return new p.Connectors[g][h](m,e)},n=function(b,g,h){return b?h.makeAnchor(b,g,h):null},h=function(b,g,h,m){null!=g&&(g._jsPlumbConnections=g._jsPlumbConnections||{},m?delete g._jsPlumbConnections[b.id]:g._jsPlumbConnections[b.id]=!0,t.isEmpty(g._jsPlumbConnections)?h.removeClass(g,h.connectedClass):h.addClass(g,
h.connectedClass))};p.Connection=function(b){var g=b.newEndpoint;this.id=b.id;this.connector=null;this.idPrefix="_jsplumb_c_";this.defaultLabelLocation=.5;this.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.previousConnection=b.previousConnection;this.source=p.getElement(b.source);this.target=p.getElement(b.target);b.sourceEndpoint&&(this.source=b.sourceEndpoint.getElement());b.targetEndpoint&&(this.target=b.targetEndpoint.getElement());p.OverlayCapableJsPlumbUIComponent.apply(this,arguments);
this.sourceId=this._jsPlumb.instance.getId(this.source);this.targetId=this._jsPlumb.instance.getId(this.target);this.scope=b.scope;this.endpoints=[];this.endpointStyles=[];var h=this._jsPlumb.instance;h.manage(this.sourceId,this.source);h.manage(this.targetId,this.target);this._jsPlumb.visible=!0;this._jsPlumb.editable=!0===b.editable;this._jsPlumb.params={cssClass:b.cssClass,container:b.container,"pointer-events":b["pointer-events"],editorParams:b.editorParams,overlays:b.overlays};this._jsPlumb.lastPaintedAt=
null;this.bind("mouseover",function(){this.setHover(!0)}.bind(this));this.bind("mouseout",function(){this.setHover(!1)}.bind(this));this.editableRequested=!1!==b.editable;this.setEditable=function(a){return this.connector?this.connector.setEditable(a):!1};this.isEditable=function(){return this.connector?this.connector.isEditable():!1};this.isEditing=function(){return this.connector?this.connector.isEditing():!1};this.makeEndpoint=function(a,c,d,f){d=d||this._jsPlumb.instance.getId(c);return this.prepareEndpoint(h,
g,this,f,a?0:1,b,c,d)};b.type&&(b.endpoints=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(b.type).endpoints);var m=this.makeEndpoint(!0,this.source,this.sourceId,b.sourceEndpoint),e=this.makeEndpoint(!1,this.target,this.targetId,b.targetEndpoint);m&&t.addToList(b.endpointsByElement,this.sourceId,m);e&&t.addToList(b.endpointsByElement,this.targetId,e);this.scope||(this.scope=this.endpoints[0].scope);null!=b.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=b.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=
b.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0));m=h.Defaults.ConnectionsDetachable;!1===b.detachable&&(m=!1);!1===this.endpoints[0].connectionsDetachable&&(m=!1);!1===this.endpoints[1].connectionsDetachable&&(m=!1);this.appendToDefaultType({detachable:m,reattach:b.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||h.Defaults.ReattachConnections,
paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||b.paintStyle||h.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||b.hoverPaintStyle||h.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle});var k=h.getSuspendedAt();if(!h.isSuspendDrawing()){var e=h.getCachedData(this.sourceId),m=e.o,e=e.s,a=h.getCachedData(this.targetId),c=a.o,a=a.s,k=k||h.timestamp(),f=this.endpoints[0].anchor.compute({xy:[m.left,
m.top],wh:e,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[c.left,c.top],twh:a,tElement:this.endpoints[1],timestamp:k});this.endpoints[0].paint({anchorLoc:f,timestamp:k});f=this.endpoints[1].anchor.compute({xy:[c.left,c.top],wh:a,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[m.left,m.top],twh:e,tElement:this.endpoints[0],timestamp:k});this.endpoints[1].paint({anchorLoc:f,timestamp:k})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=
function(){return this.endpoints};this.isDetachable=function(){return!0===this._jsPlumb.detachable};this.setDetachable=function(a){this._jsPlumb.detachable=!0===a};this.isReattach=function(){return!0===this._jsPlumb.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections};this.setReattach=function(a){this._jsPlumb.reattach=!0===a};this._jsPlumb.cost=b.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=b.directed;null==b.directed&&(this._jsPlumb.directed=
this.endpoints[0].areConnectionsDirected());m=jsPlumb.extend({},this.endpoints[1].getParameters());p.extend(m,this.endpoints[0].getParameters());p.extend(m,this.getParameters());this.setParameters(m);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||b.connector||h.Defaults.Connector||p.Defaults.Connector,!0);b.geometry&&this.connector.setGeometry(b.geometry);var d=null!=b.data&&t.isObject(b.data)?b.data:{};this.getData=function(){return d};this.setData=function(a){d=a||{}};
this.mergeData=function(a){d=jsPlumb.extend(d,a)};m=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,b.type].join(" ");/[^\s]/.test(m)&&this.addType(m,b.data,!0);this.updateConnectedClass()};t.extend(p.Connection,p.OverlayCapableJsPlumbUIComponent,{applyType:function(b,g,h){null!=b.detachable&&this.setDetachable(b.detachable);null!=b.reattach&&this.setReattach(b.reattach);b.scope&&(this.scope=b.scope);null!=b.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,
b.cssClass);g=null;b.anchor?(g=this.getCachedTypeItem("anchors",h.anchor),null==g&&(g=[this._jsPlumb.instance.makeAnchor(b.anchor),this._jsPlumb.instance.makeAnchor(b.anchor)],this.cacheTypeItem("anchors",g,h.anchor))):b.anchors&&(g=this.getCachedTypeItem("anchors",h.anchors),null==g&&(g=[this._jsPlumb.instance.makeAnchor(b.anchors[0]),this._jsPlumb.instance.makeAnchor(b.anchors[1])],this.cacheTypeItem("anchors",g,h.anchors)));null!=g&&(this.endpoints[0].anchor=g[0],this.endpoints[1].anchor=g[1],
this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId));p.OverlayCapableJsPlumbUIComponent.applyType(this,b)},addClass:function(b,g){g&&(this.endpoints[0].addClass(b),this.endpoints[1].addClass(b),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(b));this.connector&&this.connector.addClass(b)},removeClass:function(b,g){g&&(this.endpoints[0].removeClass(b),this.endpoints[1].removeClass(b),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(b));
this.connector&&this.connector.removeClass(b)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(b){this._jsPlumb.visible=b;this.connector&&this.connector.setVisible(b);this.repaint()},cleanup:function(){this.updateConnectedClass(!0);this.target=this.source=this.endpoints=null;null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0));this.connector=null},updateConnectedClass:function(b){this._jsPlumb&&(h(this,this.source,this._jsPlumb.instance,b),h(this,this.target,
this._jsPlumb.instance,b))},setHover:function(b){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(b),l.jsPlumb[b?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),l.jsPlumb[b?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-Infinity},setCost:function(b){this._jsPlumb.cost=
b},isDirected:function(){return!0===this._jsPlumb.directed},getConnector:function(){return this.connector},getGeometry:function(){return this.connector?this.connector.getGeometry():null},setGeometry:function(b){this.connector&&this.connector.setGeometry(b)},prepareConnector:function(b,g){var h={_jsPlumb:this._jsPlumb.instance,cssClass:(this._jsPlumb.params.cssClass||"")+(this.isEditable()?this._jsPlumb.instance.editableConnectorClass:""),container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"],
editable:this.editableRequested},m=this._jsPlumb.instance.getRenderMode(),e;t.isString(b)?e=q(this._jsPlumb.instance,m,b,h,this):t.isArray(b)&&(e=1==b.length?q(this._jsPlumb.instance,m,b[0],h,this):q(this._jsPlumb.instance,m,b[0],t.merge(b[1],h),this));null!=g&&(e.typeId=g);return e},setPreparedConnector:function(b,g,h,m){var e,k="";null!=this.connector&&(e=this.connector,k=e.getClass(),this.connector.cleanup(),this.connector.destroy());this.connector=b;m&&this.cacheTypeItem("connector",b,m);this.canvas=
this.connector.canvas;this.bgCanvas=this.connector.bgCanvas;this.addClass(k);this.canvas&&(this.canvas._jsPlumb=this);this.bgCanvas&&(this.bgCanvas._jsPlumb=this);if(null!=e)for(b=this.getOverlays(),m=0;m<b.length;m++)b[m].transfer&&b[m].transfer(this.connector);h||this.setListenerComponent(this.connector);g||this.repaint()},setConnector:function(b,g,h,m){b=this.prepareConnector(b,m);this.setPreparedConnector(b,g,h,m)},paint:function(b){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){b=
b||{};b=b.timestamp;var g=this.targetId,h=this.sourceId;if(null==b||b!=this._jsPlumb.lastPaintedAt){var h=this._jsPlumb.instance.updateOffset({elId:h}).o,g=this._jsPlumb.instance.updateOffset({elId:g}).o,m=this.endpoints[0],e=this.endpoints[1],m=m.anchor.getCurrentLocation({xy:[h.left,h.top],wh:[h.width,h.height],element:m,timestamp:b}),e=e.anchor.getCurrentLocation({xy:[g.left,g.top],wh:[g.width,g.height],element:e,timestamp:b});this.connector.resetBounds();this.connector.compute({sourcePos:m,targetPos:e,
sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:h,targetInfo:g});var g=h=Infinity,m=e=-Infinity,k;for(k in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(k)){var a=this._jsPlumb.overlays[k];a.isVisible()&&(this._jsPlumb.overlayPlacements[k]=a.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(a)),h=Math.min(h,this._jsPlumb.overlayPlacements[k].minX),e=Math.max(e,this._jsPlumb.overlayPlacements[k].maxX),
g=Math.min(g,this._jsPlumb.overlayPlacements[k].minY),m=Math.max(m,this._jsPlumb.overlayPlacements[k].maxY))}k=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2;a=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0);k={xmin:Math.min(this.connector.bounds.minX-(k+a),h),ymin:Math.min(this.connector.bounds.minY-(k+a),g),xmax:Math.max(this.connector.bounds.maxX+(k+a),e),ymax:Math.max(this.connector.bounds.maxY+(k+a),m)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,k);for(var c in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(c)&&
(h=this._jsPlumb.overlays[c],h.isVisible()&&h.paint(this._jsPlumb.overlayPlacements[c],k))}this._jsPlumb.lastPaintedAt=b}},repaint:function(b){b=b||{};this.paint({elId:this.sourceId,recalc:!1!==b.recalc,timestamp:b.timestamp})},prepareEndpoint:function(b,g,h,m,e,k,a,c){var f;if(m)h.endpoints[e]=m,m.addConnection(h);else{k.endpoints||(k.endpoints=[null,null]);m=k.endpoints[e]||k.endpoint||b.Defaults.Endpoints[e]||jsPlumb.Defaults.Endpoints[e]||b.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;k.endpointStyles||
(k.endpointStyles=[null,null]);k.endpointHoverStyles||(k.endpointHoverStyles=[null,null]);f=k.endpointStyles[e]||k.endpointStyle||b.Defaults.EndpointStyles[e]||jsPlumb.Defaults.EndpointStyles[e]||b.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==f.fillStyle&&null!=k.paintStyle&&(f.fillStyle=k.paintStyle.strokeStyle);null==f.outlineColor&&null!=k.paintStyle&&(f.outlineColor=k.paintStyle.outlineColor);null==f.outlineWidth&&null!=k.paintStyle&&(f.outlineWidth=k.paintStyle.outlineWidth);
var d=k.endpointHoverStyles[e]||k.endpointHoverStyle||b.Defaults.EndpointHoverStyles[e]||jsPlumb.Defaults.EndpointHoverStyles[e]||b.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=k.hoverPaintStyle&&(null==d&&(d={}),null==d.fillStyle&&(d.fillStyle=k.hoverPaintStyle.strokeStyle));c=k.anchors?k.anchors[e]:k.anchor?k.anchor:n(b.Defaults.Anchors[e],c,b)||n(p.Defaults.Anchors[e],c,b)||n(b.Defaults.Anchor,c,b)||n(p.Defaults.Anchor,c,b);f=g({paintStyle:f,hoverPaintStyle:d,endpoint:m,
connections:[h],uuid:k.uuids?k.uuids[e]:null,anchor:c,source:a,scope:k.scope,reattach:k.reattach||b.Defaults.ReattachConnections,detachable:k.detachable||b.Defaults.ConnectionsDetachable});h.endpoints[e]=f;!1===k.drawEndpoints&&f.setVisible(!1,!0,!0)}return f}})}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumbUtil,p=this.jsPlumb;p.AnchorManager=function(h){var b={},g={},n={},m={},e=["left","top","right","bottom"],k={},a=this,c={},f=h.jsPlumbInstance,d={},u=function(a,b,c,d,f,k){if(a===b)return{orientation:"identity",a:["top","top"]};a=Math.atan2(d.centery-c.centery,d.centerx-c.centerx);b=Math.atan2(c.centery-d.centery,c.centerx-d.centerx);var g=[],h={};(function(a,b){for(var c=0;c<a.length;c++)h[a[c]]={left:[b[c].left,b[c].centery],right:[b[c].right,b[c].centery],top:[b[c].centerx,
b[c].top],bottom:[b[c].centerx,b[c].bottom]}})(["source","target"],[c,d]);for(c=0;c<e.length;c++)for(d=0;d<e.length;d++)g.push({source:e[c],target:e[d],dist:Biltong.lineLength(h.source[e[c]],h.target[e[d]])});g.sort(function(a,b){return a.dist<b.dist?-1:a.dist>b.dist?1:0});c=g[0].source;d=g[0].target;for(var m=0;m<g.length&&(c=!f.isContinuous||f.isEdgeSupported(g[m].source)?g[m].source:null,d=!k.isContinuous||k.isEdgeSupported(g[m].target)?g[m].target:null,null==c||null==d);m++);return{a:[c,d],theta:a,
theta2:b}},v=function(a,b,c,d,f,e,k){a=[];for(var g=b[f?0:1]/(d.length+1),h=0;h<d.length;h++){var m=(h+1)*g,l=e*b[f?1:0];k&&(m=b[f?0:1]-m);var u=f?m:l,m=f?l:m;a.push([c[0]+u,c[1]+m,u/b[0],m/b[1],d[h][1],d[h][2]])}return a},q=function(a){return function(b,c){return!1===(a?b[0][0]<c[0][0]:b[0][0]>c[0][0])?-1:1}},w={top:function(a,b){return a[0]>b[0]?1:-1},right:q(!0),bottom:q(!0),left:function(a,b){return(0>a[0][0]?-Math.PI-a[0][0]:Math.PI-a[0][0])>(0>b[0][0]?-Math.PI-b[0][0]:Math.PI-b[0][0])?1:a[0][1]>
b[0][1]?1:-1}},M=function(a,b){var c=f.getCachedData(a),d=c.s,c=c.o,e=function(b,c,d,f,e,k,h){if(0<f.length)for(f=f.sort(w[b]),b=v(b,c,d,f,e,k,"right"===b||"top"===b),c=function(a,b){g[a.id]=[b[0],b[1],b[2],b[3]];m[a.id]=h},d=0;d<b.length;d++)e=b[d][4],k=e.endpoints[1].elementId===a,e.endpoints[0].elementId===a&&c(e.endpoints[0],b[d]),k&&c(e.endpoints[1],b[d])};e("bottom",d,[c.left,c.top],b.bottom,!0,1,[0,1]);e("top",d,[c.left,c.top],b.top,!0,0,[0,-1]);e("left",d,[c.left,c.top],b.left,!1,0,[-1,0]);
e("right",d,[c.left,c.top],b.right,!1,1,[1,0])};this.reset=function(){b={};k={};c={}};this.addFloatingConnection=function(a,b){d[a]=b};this.removeFloatingConnection=function(a){delete d[a]};this.newConnection=function(a){var b=a.sourceId,c=a.targetId,d=a.endpoints,f=!0,e=function(e,g,h,m,u){b==c&&h.isContinuous&&(a._jsPlumb.instance.removeElement(d[1].canvas),f=!1);l.addToList(k,m,[u,g,h.constructor==p.DynamicAnchor])};e(0,d[0],d[0].anchor,c,a);f&&e(1,d[1],d[1].anchor,b,a)};var t=function(a){(function(a,
b){if(a){var c=function(a){return a[4]==b};l.removeWithFunction(a.top,c);l.removeWithFunction(a.left,c);l.removeWithFunction(a.bottom,c);l.removeWithFunction(a.right,c)}})(c[a.elementId],a.id)};this.connectionDetached=function(b,c){var d=b.connection||b,f=b.targetId,e=d.endpoints,g=function(a,b,c,d,f){l.removeWithFunction(k[d],function(a){return a[0].id==f.id})};g(1,e[1],e[1].anchor,b.sourceId,d);g(0,e[0],e[0].anchor,f,d);d.floatingId&&(g(d.floatingIndex,d.floatingEndpoint,d.floatingEndpoint.anchor,
d.floatingId,d),t(d.floatingEndpoint));t(d.endpoints[0]);t(d.endpoints[1]);c||(a.redraw(d.sourceId),d.targetId!==d.sourceId&&a.redraw(d.targetId))};this.add=function(a,c){l.addToList(b,c,a)};this.changeId=function(a,c){k[c]=k[a];b[c]=b[a];delete k[a];delete b[a]};this.getConnectionsFor=function(a){return k[a]||[]};this.getEndpointsFor=function(a){return b[a]||[]};this.deleteEndpoint=function(a){l.removeWithFunction(b[a.elementId],function(b){return b.id==a.id});t(a)};this.clearFor=function(a){delete b[a];
b[a]=[]};var C=function(a,b,c,d,f,e,k,g,m,u,n,v){u=-1;var p=d.endpoints[k],r=p.id,q=[1,0][k];b=[[b,c],d,f,e,r];c=a[m];a=p._continuousAnchorEdge?a[p._continuousAnchorEdge]:null;var w;if(a&&(d=l.findWithFunction(a,function(a){return a[4]==r}),-1!=d))for(a.splice(d,1),d=0;d<a.length;d++)w=a[d][1],l.addWithFunction(n,w,function(a){return a.id==w.id}),l.addWithFunction(v,a[d][1].endpoints[k],function(a){return a.id==w.endpoints[k].id}),l.addWithFunction(v,a[d][1].endpoints[q],function(a){return a.id==
w.endpoints[q].id});for(d=0;d<c.length;d++)w=c[d][1],1==h.idx&&c[d][3]===e&&-1==u&&(u=d),l.addWithFunction(n,w,function(a){return a.id==w.id}),l.addWithFunction(v,c[d][1].endpoints[k],function(a){return a.id==w.endpoints[k].id}),l.addWithFunction(v,c[d][1].endpoints[q],function(a){return a.id==w.endpoints[q].id});c.splice(g?-1!=u?u:0:c.length,0,b);p._continuousAnchorEdge=m};this.updateOtherEndpoint=function(a,b,c,d){var f=l.findWithFunction(k[a],function(a){return a[0].id===d.id}),e=l.findWithFunction(k[b],
function(a){return a[0].id===d.id});-1!=f&&(k[a][f][0]=d,k[a][f][1]=d.endpoints[1],k[a][f][2]=d.endpoints[1].anchor.constructor==p.DynamicAnchor);-1<e&&(k[b].splice(e,1),l.addToList(k,c,[d,d.endpoints[0],d.endpoints[0].anchor.constructor==p.DynamicAnchor]));d.updateConnectedClass()};this.sourceChanged=function(a,b,c,d){a!==b&&(c.sourceId=b,c.source=d,l.removeWithFunction(k[a],function(a){return a[0].id===c.id}),a=l.findWithFunction(k[c.targetId],function(a){return a[0].id===c.id}),-1<a&&(k[c.targetId][a][0]=
c,k[c.targetId][a][1]=c.endpoints[0],k[c.targetId][a][2]=c.endpoints[0].anchor.constructor==p.DynamicAnchor),l.addToList(k,b,[c,c.endpoints[1],c.endpoints[1].anchor.constructor==p.DynamicAnchor]),c.endpoints[1].anchor.isContinuous&&(c.source===c.target?c._jsPlumb.instance.removeElement(c.endpoints[1].canvas):null==c.endpoints[1].canvas.parentNode&&c._jsPlumb.instance.appendElement(c.endpoints[1].canvas)),c.updateConnectedClass())};this.rehomeEndpoint=function(c,d,e){var k=b[d]||[];e=f.getId(e);if(e!==
d){var g=k.indexOf(c);-1<g&&(k=k.splice(g,1)[0],a.add(k,e))}for(k=0;k<c.connections.length;k++)c.connections[k].sourceId==d?a.sourceChanged(d,c.elementId,c.connections[k],c.element):c.connections[k].targetId==d&&(c.connections[k].targetId=c.elementId,c.connections[k].target=c.element,a.updateOtherEndpoint(c.connections[k].sourceId,d,c.elementId,c.connections[k]))};this.redraw=function(a,e,g,h,m,n){if(!f.isSuspendDrawing()){var v=b[a]||[],r=k[a]||[],q=[],w=[],H=[];g=g||f.timestamp();h=h||{left:0,top:0};
e&&(e={left:e.left+h.left,top:e.top+h.top});e=f.updateOffset({elId:a,offset:e,recalc:!1,timestamp:g});h={};for(var z=0;z<r.length;z++){var A=r[z][0],t=A.sourceId,y=A.targetId,B=A.endpoints[0].anchor.isContinuous,x=A.endpoints[1].anchor.isContinuous;if(B||x){var P=t+"_"+y,D=h[P],F=A.sourceId==a?1:0;B&&!c[t]&&(c[t]={top:[],right:[],bottom:[],left:[]});x&&!c[y]&&(c[y]={top:[],right:[],bottom:[],left:[]});a!=y&&f.updateOffset({elId:y,timestamp:g});a!=t&&f.updateOffset({elId:t,timestamp:g});var aa=f.getCachedData(y),
ia=f.getCachedData(t);y==t&&(B||x)?(C(c[t],-Math.PI/2,0,A,!1,y,0,!1,"top",t,q,w),C(c[y],-Math.PI/2,0,A,!1,t,1,!1,"top",y,q,w)):(D||(D=u(t,y,ia.o,aa.o,A.endpoints[0].anchor,A.endpoints[1].anchor),h[P]=D),B&&C(c[t],D.theta,0,A,!1,y,0,!1,D.a[0],t,q,w),x&&C(c[y],D.theta2,-1,A,!0,t,1,!0,D.a[1],y,q,w));B&&l.addWithFunction(H,t,function(a){return a===t});x&&l.addWithFunction(H,y,function(a){return a===y});l.addWithFunction(q,A,function(a){return a.id==A.id});(B&&0===F||x&&1===F)&&l.addWithFunction(w,A.endpoints[F],
function(a){return a.id==A.endpoints[F].id})}}for(z=0;z<v.length;z++)0===v[z].connections.length&&v[z].anchor.isContinuous&&(c[a]||(c[a]={top:[],right:[],bottom:[],left:[]}),C(c[a],-Math.PI/2,0,{endpoints:[v[z],v[z]],paint:function(){}},!1,a,0,!1,v[z].anchor.getDefaultFace(),a,q,w),l.addWithFunction(H,a,function(b){return b===a}));for(z=0;z<H.length;z++)M(H[z],c[H[z]]);for(z=0;z<v.length;z++)v[z].paint({timestamp:g,offset:e,dimensions:e.s,recalc:!0!==n});for(z=0;z<w.length;z++)n=f.getCachedData(w[z].elementId),
w[z].paint({timestamp:g,offset:n,dimensions:n.s});for(z=0;z<r.length;z++){var L=r[z][1];if(L.anchor.constructor==p.DynamicAnchor){L.paint({elementWithPrecedence:a,timestamp:g});l.addWithFunction(q,r[z][0],function(a){return a.id==r[z][0].id});for(var O=0;O<L.connections.length;O++)L.connections[O]!==r[z][0]&&l.addWithFunction(q,L.connections[O],function(a){return a.id==L.connections[O].id})}else L.anchor.constructor==p.Anchor&&l.addWithFunction(q,r[z][0],function(a){return a.id==r[z][0].id})}(w=d[a])&&
w.paint({timestamp:g,recalc:!1,elId:a});for(z=0;z<q.length;z++)q[z].paint({elId:a,timestamp:g,recalc:!1,clearEdits:m})}};var D=function(a){l.EventGenerator.apply(this);this.type="Continuous";this.isContinuous=this.isDynamic=!0;for(var b=a.faces||["top","right","bottom","left"],c=!1!==a.clockwise,d={},f={top:"bottom",right:"left",left:"right",bottom:"top"},e={top:"right",right:"bottom",left:"top",bottom:"left"},k={top:"left",right:"top",left:"bottom",bottom:"right"},h=c?e:k,u=c?k:e,v=a.cssClass||"",
c=0;c<b.length;c++)d[b[c]]=!0;this.getDefaultFace=function(){return 0===b.length?"top":b[0]};this.verifyEdge=function(a){if(!d[a]){if(d[f[a]])return f[a];if(d[h[a]])return h[a];if(d[u[a]])return u[a]}return a};this.isEdgeSupported=function(a){return!0===d[a]};this.compute=function(a){return n[a.element.id]||g[a.element.id]||[0,0]};this.getCurrentLocation=function(a){return n[a.element.id]||g[a.element.id]||[0,0]};this.getOrientation=function(a){return m[a.id]||[0,0]};this.clearUserDefinedLocation=
function(){delete n[a.elementId]};this.setUserDefinedLocation=function(b){n[a.elementId]=b};this.getCssClass=function(){return v}};f.continuousAnchorFactory={get:function(a){return new D(a)},clear:function(a){delete n[a];delete g[a]}}};p.Anchor=function(h){this.x=h.x||0;this.y=h.y||0;this.elementId=h.elementId;this.cssClass=h.cssClass||"";this.userDefinedLocation=null;this.orientation=h.orientation||[0,0];this.lastReturnValue=null;this.offsets=h.offsets||[0,0];this.timestamp=null;l.EventGenerator.apply(this);
this.compute=function(b){var g=b.xy,h=b.wh,m=b.timestamp;b.clearUserDefinedLocation&&(this.userDefinedLocation=null);if(m&&m===self.timestamp)return this.lastReturnValue;this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[g[0]+this.x*h[0]+this.offsets[0],g[1]+this.y*h[1]+this.offsets[1]];this.timestamp=m;return this.lastReturnValue};this.getCurrentLocation=function(b){b=b||{};return null==this.lastReturnValue||null!=b.timestamp&&this.timestamp!=b.timestamp?this.compute(b):
this.lastReturnValue}};l.extend(p.Anchor,l.EventGenerator,{equals:function(h){if(!h)return!1;var b=h.getOrientation(),g=this.getOrientation();return this.x==h.x&&this.y==h.y&&this.offsets[0]==h.offsets[0]&&this.offsets[1]==h.offsets[1]&&g[0]==b[0]&&g[1]==b[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(h){this.userDefinedLocation=h},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},
getCssClass:function(){return this.cssClass}});p.FloatingAnchor=function(h){p.Anchor.apply(this,arguments);var b=h.reference,g=p.getSize(h.referenceCanvas),l=null,m=null;this.orientation=null;this.y=this.x=0;this.isFloating=!0;this.compute=function(b){b=b.xy;return m=b=[b[0]+g[0]/2,b[1]+g[1]/2]};this.getOrientation=function(e){if(l)return l;e=b.getOrientation(e);return[-0*Math.abs(e[0]),-0*Math.abs(e[1])]};this.over=function(b,k){l=b.getOrientation(k)};this.out=function(){l=null};this.getCurrentLocation=
function(b){return null==m?this.compute(b):m}};l.extend(p.FloatingAnchor,p.Anchor);var t=function(h,b,g){return h.constructor==p.Anchor?h:b.makeAnchor(h,g,b)};p.DynamicAnchor=function(h){p.Anchor.apply(this,arguments);this.isDynamic=!0;this.anchors=[];this.elementId=h.elementId;this.jsPlumbInstance=h.jsPlumbInstance;for(var b=0;b<h.anchors.length;b++)this.anchors[b]=t(h.anchors[b],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};this.locked=!1;var g=0<this.anchors.length?
this.anchors[0]:null,l=g,m=this,e=h.selector||function(b,a,c,f,d){var e=c[0]+f[0]/2;c=c[1]+f[1]/2;f=-1;for(var k=Infinity,g=0;g<d.length;g++){var h,m=d[g];h=b[0]+m.x*a[0];m=b[1]+m.y*a[1];h=Math.sqrt(Math.pow(e-h,2)+Math.pow(c-m,2))+Math.sqrt(Math.pow(b[0]+a[0]/2-h,2)+Math.pow(b[1]+a[1]/2-m,2));h<k&&(f=g+0,k=h)}return d[f]};this.compute=function(b){var a=b.xy,c=b.wh,f=b.txy,d=b.twh;this.timestamp=b.timestamp;var k=m.getUserDefinedLocation();if(null!=k)return k;if(this.locked||null==f||null==d)return g.compute(b);
b.timestamp=null;g=e(a,c,f,d,this.anchors);this.x=g.x;this.y=g.y;g!=l&&this.fire("anchorChanged",g);l=g;return g.compute(b)};this.getCurrentLocation=function(b){return this.getUserDefinedLocation()||(null!=g?g.getCurrentLocation(b):null)};this.getOrientation=function(b){return null!=g?g.getOrientation(b):[0,0]};this.over=function(b,a){null!=g&&g.over(b,a)};this.out=function(){null!=g&&g.out()};this.getCssClass=function(){return g&&g.getCssClass()||""}};l.extend(p.DynamicAnchor,p.Anchor);var q=function(h,
b,g,l,m,e){p.Anchors[m]=function(k){var a=k.jsPlumbInstance.makeAnchor([h,b,g,l,0,0],k.elementId,k.jsPlumbInstance);a.type=m;e&&e(a,k);return a}};q(.5,0,0,-1,"TopCenter");q(.5,1,0,1,"BottomCenter");q(0,.5,-1,0,"LeftMiddle");q(1,.5,1,0,"RightMiddle");q(.5,0,0,-1,"Top");q(.5,1,0,1,"Bottom");q(0,.5,-1,0,"Left");q(1,.5,1,0,"Right");q(.5,.5,0,0,"Center");q(1,0,0,-1,"TopRight");q(1,1,0,1,"BottomRight");q(0,0,0,-1,"TopLeft");q(0,1,0,1,"BottomLeft");p.Defaults.DynamicAnchors=function(h){return h.jsPlumbInstance.makeAnchors(["TopCenter",
"RightMiddle","BottomCenter","LeftMiddle"],h.elementId,h.jsPlumbInstance)};p.Anchors.AutoDefault=function(h){h=h.jsPlumbInstance.makeDynamicAnchor(p.Defaults.DynamicAnchors(h));h.type="AutoDefault";return h};var n=function(h,b){p.Anchors[h]=function(g){g=g.jsPlumbInstance.makeAnchor(["Continuous",{faces:b}],g.elementId,g.jsPlumbInstance);g.type=h;return g}};p.Anchors.Continuous=function(h){return h.jsPlumbInstance.continuousAnchorFactory.get(h)};n("ContinuousLeft",["left"]);n("ContinuousTop",["top"]);
n("ContinuousBottom",["bottom"]);n("ContinuousRight",["right"]);q(0,0,0,0,"Assign",function(h,b){var g=b.position||"Fixed";h.positionFinder=g.constructor==String?b.jsPlumbInstance.AnchorPositionFinders[g]:g;h.constructorParams=b});this.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(h,b,g){return[(h.left-b.left)/g[0],(h.top-b.top)/g[1]]},Grid:function(h,b,g,l){var m=g[0]/l.grid[0];l=g[1]/l.grid[1];return[(Math.floor((h.left-b.left)/m)*m+m/2)/g[0],(Math.floor((h.top-b.top)/l)*l+l/2)/
g[1]]}};p.Anchors.Perimeter=function(h){h=h||{};var b=h.anchorCount||60,g=h.shape;if(!g)throw Error("no shape supplied to Perimeter Anchor type");var l=function(){for(var a=2*Math.PI/b,c=0,f=[],d=0;d<b;d++)f.push([.5+.5*Math.sin(c),.5+.5*Math.cos(c),0,0]),c+=a;return f},m=function(a){for(var c=b/a.length,f=[],d=function(a,d,e,k,g){c=b*g;e=(e-a)/c;k=(k-d)/c;for(g=0;g<c;g++)f.push([a+e*g,d+k*g,0,0])},e=0;e<a.length;e++)d.apply(null,a[e]);return f},e=function(a){for(var b=[],f=0;f<a.length;f++)b.push([a[f][0],
a[f][1],a[f][2],a[f][3],1/a.length]);return m(b)},k=function(){return e([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},k={Circle:l,Ellipse:l,Diamond:function(){return e([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:k,Square:k,Triangle:function(){return e([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(a){var b=a.points;a=[];for(var f=0,d=0;d<b.length-1;d++){var e=Math.sqrt(Math.pow(b[d][2]-b[d][0])+Math.pow(b[d][3]-b[d][1])),f=f+e;a.push([b[d][0],b[d][1],b[d+1][0],b[d+1][1],e])}for(b=
0;b<a.length;b++)a[b][4]/=f;return m(a)}},l=function(a,b){var c=[];b=b/180*Math.PI;for(var d=0;d<a.length;d++){var e=a[d][0]-.5,k=a[d][1]-.5;c.push([.5+(e*Math.cos(b)-k*Math.sin(b)),.5+(e*Math.sin(b)+k*Math.cos(b)),a[d][2],a[d][3]])}return c};if(!k[g])throw Error("Shape ["+g+"] is unknown by Perimeter Anchor type");g=k[g](h);h.rotation&&(g=l(g,h.rotation));h=h.jsPlumbInstance.makeDynamicAnchor(g);h.type="Perimeter";return h}}).call("undefined"!==typeof window?window:this);
(function(){var l=this,p=l.jsPlumb,t=l.jsPlumbUtil,q=l.Biltong;p.Segments={AbstractSegment:function(b){this.params=b;this.findClosestPointOnPath=function(b,a){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(b.x1,b.x2),minY:Math.min(b.y1,b.y2),maxX:Math.max(b.x1,b.x2),maxY:Math.max(b.y1,b.y2)}}},Straight:function(b){p.Segments.AbstractSegment.apply(this,arguments);var e,a,c,f,d,g,h;this.type="Straight";this.getLength=function(){return e};this.getGradient=function(){return a};
this.getCoordinates=function(){return{x1:f,y1:g,x2:d,y2:h}};this.setCoordinates=function(b){f=b.x1;g=b.y1;d=b.x2;h=b.y2;e=Math.sqrt(Math.pow(d-f,2)+Math.pow(h-g,2));a=q.gradient({x:f,y:g},{x:d,y:h});c=-1/a};this.setCoordinates({x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2});this.getBounds=function(){return{minX:Math.min(f,d),minY:Math.min(g,h),maxX:Math.max(f,d),maxY:Math.max(g,h)}};this.pointOnPath=function(a,b){return 0!==a||b?1!=a||b?q.pointOnLine({x:f,y:g},{x:d,y:h},b?0<a?a:e+a:a*e):{x:d,y:h}:{x:f,y:g}};this.gradientAtPoint=
function(b){return a};this.pointAlongPathFrom=function(a,b,c){a=this.pointOnPath(a,c);c=0>=b?{x:f,y:g}:{x:d,y:h};0>=b&&1<Math.abs(b)&&(b*=-1);return q.pointOnLine(a,c,b)};var m=function(a,b,c){return c>=Math.min(a,b)&&c<=Math.max(a,b)},l=function(a,b,c){return Math.abs(c-a)<Math.abs(c-b)?a:b};this.findClosestPointOnPath=function(b,k){var n={d:Infinity,x:null,y:null,l:null,x1:f,x2:d,y1:g,y2:h};if(0===a)n.y=g,n.x=m(f,d,b)?b:l(f,d,b);else if(Infinity==a||-Infinity==a)n.x=f,n.y=m(g,h,k)?k:l(g,h,k);else{var u=
g-a*f,v=(k-c*b-u)/(a-c),u=a*v+u;n.x=m(f,d,v)?v:l(f,d,v);n.y=m(g,h,u)?u:l(g,h,u)}v=q.lineLength([n.x,n.y],[f,g]);n.d=q.lineLength([b,k],[n.x,n.y]);n.l=v/e;return n}},Arc:function(b){p.Segments.AbstractSegment.apply(this,arguments);var e=2*Math.PI;this.radius=b.r;this.anticlockwise=b.ac;this.type="Arc";b.startAngle&&b.endAngle?(this.startAngle=b.startAngle,this.endAngle=b.endAngle,this.x1=b.cx+this.radius*Math.cos(b.startAngle),this.y1=b.cy+this.radius*Math.sin(b.startAngle),this.x2=b.cx+this.radius*
Math.cos(b.endAngle),this.y2=b.cy+this.radius*Math.sin(b.endAngle)):(this.startAngle=q.theta([b.cx,b.cy],[b.x1,b.y1]),this.endAngle=q.theta([b.cx,b.cy],[b.x2,b.y2]),this.x1=b.x1,this.y1=b.y1,this.x2=b.x2,this.y2=b.y2);0>this.endAngle&&(this.endAngle+=e);0>this.startAngle&&(this.startAngle+=e);this.sweep=Math.abs((this.endAngle<this.startAngle?this.endAngle+e:this.endAngle)-this.startAngle);this.anticlockwise&&(this.sweep=e-this.sweep);var a=2*Math.PI*this.radius,c=this.sweep/e*a;this.getLength=function(){return c};
this.getBounds=function(){return{minX:b.cx-b.r,maxX:b.cx+b.r,minY:b.cy-b.r,maxY:b.cy+b.r}};var f=function(a){var b=Math.floor(a),c=Math.ceil(a);return 1E-10>a-b?b:1E-10>c-a?c:a};this.pointOnPath=function(a,k){if(0===a)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1==a)return{x:this.x2,y:this.y2,theta:this.endAngle};k&&(a/=c);this.anticlockwise?(k=this.startAngle<this.endAngle?this.startAngle+e:this.startAngle,a=k-Math.abs(k-this.endAngle)*a):a=this.startAngle+Math.abs((this.endAngle<this.startAngle?
this.endAngle+e:this.endAngle)-this.startAngle)*a;k=b.cy+b.r*Math.sin(a);return{x:f(b.cx+b.r*Math.cos(a)),y:f(k),theta:a}};this.gradientAtPoint=function(a,c){a=this.pointOnPath(a,c);a=q.normal([b.cx,b.cy],[a.x,a.y]);this.anticlockwise||Infinity!=a&&-Infinity!=a||(a*=-1);return a};this.pointAlongPathFrom=function(c,f,e){c=this.pointOnPath(c,e).theta+f/a*(this.anticlockwise?-1:1)*2*Math.PI;return{x:b.cx+this.radius*Math.cos(c),y:b.cy+this.radius*Math.sin(c)}}},Bezier:function(b){this.curve=[{x:b.x1,
y:b.y1},{x:b.cp1x,y:b.cp1y},{x:b.cp2x,y:b.cp2y},{x:b.x2,y:b.y2}];p.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(b.x1,b.x2,b.cp1x,b.cp2x),minY:Math.min(b.y1,b.y2,b.cp1y,b.cp2y),maxX:Math.max(b.x1,b.x2,b.cp1x,b.cp2x),maxY:Math.max(b.y1,b.y2,b.cp1y,b.cp2y)};this.type="Bezier";var e=function(a,b,f){f&&(b=l.jsBezier.locationAlongCurveFrom(a,0<b?0:1,b));return b};this.pointOnPath=function(a,b){a=e(this.curve,a,b);return l.jsBezier.pointOnCurve(this.curve,a)};this.gradientAtPoint=
function(a,b){a=e(this.curve,a,b);return l.jsBezier.gradientAtPoint(this.curve,a)};this.pointAlongPathFrom=function(a,b,f){a=e(this.curve,a,f);return l.jsBezier.pointAlongCurveFrom(this.curve,a,b)};this.getLength=function(){return l.jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds}}};var n=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};p.Connectors.AbstractConnector=function(b){n.apply(this,
arguments);var e=[],a=0,c=[],f=[],d=b.stub||0,g=t.isArray(d)?d[0]:d,h=t.isArray(d)?d[1]:d,d=b.gap||0,m=t.isArray(d)?d[0]:d,l=t.isArray(d)?d[1]:d,r=null,B=!1,C=null,D=null,x=!1!==b.editable&&null!=jsPlumb.ConnectorEditors&&null!=jsPlumb.ConnectorEditors[this.type],d=this.setGeometry=function(a,b){B=!b;D=a},F=this.getGeometry=function(){return D};this.hasBeenEdited=function(){return B};this.isEditing=function(){return null!=this.editor&&this.editor.isActive()};this.setEditable=function(a){return x=
a&&null!=jsPlumb.ConnectorEditors&&null!=jsPlumb.ConnectorEditors[this.type]&&(null==this.overrideSetEditable||this.overrideSetEditable())?a:!1};this.isEditable=function(){return x};this.findSegmentForPoint=function(a,b){for(var c={d:Infinity,s:null,x:null,y:null,l:null},d=0;d<e.length;d++){var f=e[d].findClosestPointOnPath(a,b);f.d<c.d&&(c.d=f.d,c.l=f.l,c.x=f.x,c.y=f.y,c.s=e[d],c.x1=f.x1,c.x2=f.x2,c.y1=f.y1,c.y2=f.y2,c.index=d)}return c};var A=function(b,d){d&&(b=0<b?b/a:(a+b)/a);d=c.length-1;for(var k=
1,g=0;g<c.length;g++)if(c[g][1]>=b){d=g;k=1==b?1:0===b?0:(b-c[g][0])/f[g];break}return{segment:e[d],proportion:k,index:d}};this.setSegments=function(b){r=[];for(var c=a=0;c<b.length;c++)r.push(b[c]),a+=b[c].getLength()};this.getLength=function(){return a};var P=function(a){this.lineWidth=a.lineWidth;var b=q.quadrant(a.sourcePos,a.targetPos),c=a.targetPos[0]<a.sourcePos[0],d=a.targetPos[1]<a.sourcePos[1],f=a.lineWidth||1,e=a.sourceEndpoint.anchor.getOrientation(a.sourceEndpoint),k=a.targetEndpoint.anchor.getOrientation(a.targetEndpoint),
n=c?a.targetPos[0]:a.sourcePos[0],u=d?a.targetPos[1]:a.sourcePos[1],p=Math.abs(a.targetPos[0]-a.sourcePos[0]),v=Math.abs(a.targetPos[1]-a.sourcePos[1]);if(0===e[0]&&0===e[1]||0===k[0]&&0===k[1]){var r=p>v?0:1,w=[1,0][r],e=[],k=[];e[r]=a.sourcePos[r]>a.targetPos[r]?-1:1;k[r]=a.sourcePos[r]>a.targetPos[r]?1:-1;e[w]=0;k[w]=0}a=c?p+m*e[0]:m*e[0];r=d?v+m*e[1]:m*e[1];c=c?l*k[0]:p+l*k[0];d=d?l*k[1]:v+l*k[1];w=e[0]*k[0]+e[1]*k[1];b={sx:a,sy:r,tx:c,ty:d,lw:f,xSpan:Math.abs(c-a),ySpan:Math.abs(d-r),mx:(a+c)/
2,my:(r+d)/2,so:e,to:k,x:n,y:u,w:p,h:v,segment:b,startStubX:a+e[0]*g,startStubY:r+e[1]*g,endStubX:c+k[0]*h,endStubY:d+k[1]*h,isXGreaterThanStubTimes2:Math.abs(a-c)>g+h,isYGreaterThanStubTimes2:Math.abs(r-d)>g+h,opposite:-1==w,perpendicular:0===w,orthogonal:1==w,sourceAxis:0===e[0]?"y":"x",points:[n,u,p,v,a,r,c,d]};b.anchorOrientation=b.opposite?"opposite":b.orthogonal?"orthogonal":"perpendicular";return b};this.getSegments=function(){return e};this.updateBounds=function(a){a=a.getBounds();this.bounds.minX=
Math.min(this.bounds.minX,a.minX);this.bounds.maxX=Math.max(this.bounds.maxX,a.maxX);this.bounds.minY=Math.min(this.bounds.minY,a.minY);this.bounds.maxY=Math.max(this.bounds.maxY,a.maxY)};this.pointOnPath=function(a,b){a=A(a,b);return a.segment&&a.segment.pointOnPath(a.proportion,!1)||[0,0]};this.gradientAtPoint=function(a,b){a=A(a,b);return a.segment&&a.segment.gradientAtPoint(a.proportion,!1)||0};this.pointAlongPathFrom=function(a,b,c){a=A(a,c);return a.segment&&a.segment.pointAlongPathFrom(a.proportion,
b,!1)||[0,0]};this.compute=function(b){C=P.call(this,b);a=e.length=c.length=f.length=0;this._compute(C,b);this.x=C.points[0];this.y=C.points[1];this.w=C.points[2];this.h=C.points[3];this.segment=C.segment;for(var d=b=0;d<e.length;d++){var k=e[d].getLength();f[d]=k/a;c[d]=[b,b+=k/a]}};return{addSegment:function(b,c,d){if(d.x1!=d.x2||d.y1!=d.y2)c=new p.Segments[c](d),e.push(c),a+=c.getLength(),b.updateBounds(c)},prepareCompute:P,sourceStub:g,targetStub:h,maxStub:Math.max(g,h),sourceGap:m,targetGap:l,
maxGap:Math.max(m,l),setGeometry:d,getGeometry:F}};t.extend(p.Connectors.AbstractConnector,n);var h=p.Connectors.Straight=function(){this.type="Straight";var b=p.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(e,a){b.addSegment(this,"Straight",{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY});b.addSegment(this,"Straight",{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY});b.addSegment(this,"Straight",{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty})}};t.extend(p.Connectors.Straight,
p.Connectors.AbstractConnector);p.registerConnectorType(h,"Straight");p.Endpoints.AbstractEndpoint=function(b){n.apply(this,arguments);return{compute:this.compute=function(b,a,c,f){var d=this._compute.apply(this,arguments);this.x=d[0];this.y=d[1];this.w=d[2];this.h=d[3];this.bounds.minX=this.x;this.bounds.minY=this.y;this.bounds.maxX=this.x+this.w;this.bounds.maxY=this.y+this.h;return d},cssClass:b.cssClass}};t.extend(p.Endpoints.AbstractEndpoint,n);p.Endpoints.Dot=function(b){this.type="Dot";p.Endpoints.AbstractEndpoint.apply(this,
arguments);b=b||{};this.radius=b.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(b,a,c,f){this.radius=c.radius||this.radius;a=b[0]-this.radius;b=b[1]-this.radius;f=2*this.radius;var d=2*this.radius;c.strokeStyle&&(c=c.lineWidth||1,a-=c,b-=c,f+=2*c,d+=2*c);return[a,b,f,d,this.radius]}};t.extend(p.Endpoints.Dot,p.Endpoints.AbstractEndpoint);p.Endpoints.Rectangle=function(b){this.type="Rectangle";p.Endpoints.AbstractEndpoint.apply(this,arguments);
b=b||{};this.width=b.width||20;this.height=b.height||20;this._compute=function(b,a,c,f){a=c.width||this.width;c=c.height||this.height;return[b[0]-a/2,b[1]-c/2,a,c]}};t.extend(p.Endpoints.Rectangle,p.Endpoints.AbstractEndpoint);var b=function(b){p.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};t.extend(b,p.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(b){this._jsPlumb.displayElements.push(b)}});p.Endpoints.Image=
function(e){this.type="Image";b.apply(this,arguments);p.Endpoints.AbstractEndpoint.apply(this,arguments);var g=e.onload,a=e.src||e.url,c=e.cssClass?" "+e.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=!1;this._jsPlumb.initialized=!1;this._jsPlumb.deleted=!1;this._jsPlumb.widthToUse=e.width;this._jsPlumb.heightToUse=e.height;this._jsPlumb.endpoint=e.endpoint;this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||
this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,g&&g(this))}.bind(this);this._jsPlumb.endpoint.setImage=function(a,b){a=a.constructor==String?a:a.src;g=b;this._jsPlumb.img.src=a;null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this);this._jsPlumb.endpoint.setImage(a,g);this._compute=function(a,b,c,e){this.anchorPoint=a;return this._jsPlumb.ready?[a[0]-this._jsPlumb.widthToUse/2,a[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,
this._jsPlumb.heightToUse]:[0,0,0,0]};this.canvas=jsPlumb.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+c);this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse);this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse);this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(a,b,c){this._jsPlumb.deleted||(this._jsPlumb.initialized||(this.canvas.setAttribute("src",
this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0),t.sizeElement(this.canvas,this.anchorPoint[0]-this._jsPlumb.widthToUse/2,this.anchorPoint[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse))};this.paint=function(a,b){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(a,b):l.setTimeout(function(){this.paint(a,b)}.bind(this),200))}};t.extend(p.Endpoints.Image,[b,p.Endpoints.AbstractEndpoint],{cleanup:function(b){b&&
(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}});p.Endpoints.Blank=function(e){p.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";b.apply(this,arguments);this._compute=function(b,a,c,f){return[b[0],b[1],10,0]};this.canvas=jsPlumb.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+(e.cssClass?" "+e.cssClass:""));this._jsPlumb.instance.appendElement(this.canvas);
this.paint=function(b,a){t.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};t.extend(p.Endpoints.Blank,[p.Endpoints.AbstractEndpoint,b],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}});p.Endpoints.Triangle=function(b){this.type="Triangle";p.Endpoints.AbstractEndpoint.apply(this,arguments);b=b||{};b.width=b.width||55;b.height=b.height||55;this.width=b.width;this.height=b.height;this._compute=function(b,a,c,f){a=c.width||self.width;c=
c.height||self.height;return[b[0]-a/2,b[1]-c/2,a,c]}};var g=p.Overlays.AbstractOverlay=function(b){this.isAppendedAtTopLevel=this.visible=!0;this.component=b.component;this.loc=null==b.location?.5:b.location;this.endpointLoc=null==b.endpointLocation?[.5,.5]:b.endpointLocation;this.visible=!1!==b.visible};g.prototype={cleanup:function(b){b&&(this.endpointLoc=this.canvas=this.component=null)},reattach:function(b){},setVisible:function(b){this.visible=b;this.component.repaint()},isVisible:function(){return this.visible},
hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(b){this.loc+=b;this.component.repaint()},setLocation:function(b){this.loc=b;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};p.Overlays.Arrow=function(b){this.type="Arrow";g.apply(this,arguments);this.isAppendedAtTopLevel=!1;b=b||{};this.length=b.length||20;this.width=b.width||20;this.id=b.id;var e=0>(b.direction||1)?-1:1,a=b.paintStyle||{lineWidth:1},c=b.foldback||
.623;this.computeMaxSize=function(){return 1.5*self.width};this.elementCreated=function(a,c){this.path=a;if(b.events)for(var d in b.events)jsPlumb.on(a,d,b.events[d])};this.draw=function(b,d){var f,g,h;return b.pointAlongPathFrom?(t.isString(this.loc)||1<this.loc||0>this.loc?(h=parseInt(this.loc,10),g=0>this.loc?1:0,f=b.pointAlongPathFrom(g,h,!1),g=b.pointAlongPathFrom(g,h-e*this.length/2,!1),h=q.pointOnLine(f,g,this.length)):1==this.loc?(f=b.pointOnPath(this.loc),g=b.pointAlongPathFrom(this.loc,
-this.length),h=q.pointOnLine(f,g,this.length),-1==e&&(g=h,h=f,f=g)):0===this.loc?(h=b.pointOnPath(this.loc),g=b.pointAlongPathFrom(this.loc,this.length),f=q.pointOnLine(h,g,this.length),-1==e&&(g=h,h=f,f=g)):(f=b.pointAlongPathFrom(this.loc,e*this.length/2),g=b.pointOnPath(this.loc),h=q.pointOnLine(f,g,this.length)),g=q.perpendicularLineTo(f,h,this.width),h=q.pointOnLine(f,h,c*this.length),{component:b,d:{hxy:f,tail:g,cxy:h},lineWidth:a.lineWidth||d.lineWidth,strokeStyle:a.strokeStyle||d.strokeStyle,
fillStyle:a.fillStyle||d.strokeStyle,minX:Math.min(f.x,g[0].x,g[1].x),maxX:Math.max(f.x,g[0].x,g[1].x),minY:Math.min(f.y,g[0].y,g[1].y),maxY:Math.max(f.y,g[0].y,g[1].y)}):{component:b,minX:0,maxX:0,minY:0,maxY:0}}};t.extend(p.Overlays.Arrow,g,{updateFrom:function(b){this.length=b.length||this.length;this.width=b.width||this.width;this.direction=null!=b.direction?b.direction:this.direction;this.foldback=b.foldback||this.foldback}});p.Overlays.PlainArrow=function(b){b=b||{};b=p.extend(b,{foldback:1});
p.Overlays.Arrow.call(this,b);this.type="PlainArrow"};t.extend(p.Overlays.PlainArrow,p.Overlays.Arrow);p.Overlays.Diamond=function(b){b=b||{};b=jsPlumb.extend(b,{length:(b.length||40)/2,foldback:2});p.Overlays.Arrow.call(this,b);this.type="Diamond"};t.extend(p.Overlays.Diamond,p.Overlays.Arrow);var r=function(b,g){if(null==b._jsPlumb.cachedDimensions||g)b._jsPlumb.cachedDimensions=b.getDimensions();return b._jsPlumb.cachedDimensions},m=function(b){p.jsPlumbUIComponent.apply(this,arguments);g.apply(this,
arguments);var e=this.fire;this.fire=function(){e.apply(this,arguments);this.component&&this.component.fire.apply(this.component,arguments)};this.detached=!1;this.id=b.id;this._jsPlumb.div=null;this._jsPlumb.initialised=!1;this._jsPlumb.component=b.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=b.create;this._jsPlumb.initiallyInvisible=!1===b.visible;this.getElement=function(){if(null==this._jsPlumb.div){var a=this._jsPlumb.div=jsPlumb.getElement(this._jsPlumb.create(this._jsPlumb.component));
a.style.position="absolute";a.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:b.cssClass?b.cssClass:"");this._jsPlumb.instance.appendElement(a);this._jsPlumb.instance.getId(a);this.canvas=a;a.style.webkitTransform="translate(-50%, -50%)";a.style.mozTransform="translate(-50%, -50%)";a.style.msTransform="translate(-50%, -50%)";a.style.oTransform="translate(-50%, -50%)";a.style.transform="translate(-50%, -50%)";a._jsPlumb=this;!1===b.visible&&(a.style.display="none")}return this._jsPlumb.div};
this.draw=function(a,b,f){b=r(this);if(null!=b&&2==b.length){if(f)f={x:f[0],y:f[1]};else if(a.pointOnPath){f=this.loc;var c=!1;if(t.isString(this.loc)||0>this.loc||1<this.loc)f=parseInt(this.loc,10),c=!0;f=a.pointOnPath(f,c)}else f=this.loc.constructor==Array?this.loc:this.endpointLoc,f={x:f[0]*a.w,y:f[1]*a.h};var c=f.x-b[0]/2,e=f.y-b[1]/2;return{component:a,d:{minx:c,miny:e,td:b,cxy:f},minX:c,maxX:c+b[0],minY:e,maxY:e+b[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};t.extend(m,[p.jsPlumbUIComponent,g],
{getDimensions:function(){return[1,1]},setVisible:function(b){this._jsPlumb.div&&(this._jsPlumb.div.style.display=b?"block":"none",b&&this._jsPlumb.initiallyInvisible&&(r(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(b){b?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&
this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(b){null!=this._jsPlumb.div&&b.getContainer().appendChild(this._jsPlumb.div);this.detached=!1},computeMaxSize:function(){var b=r(this);return Math.max(b[0],b[1])},paint:function(b,g){this._jsPlumb.initialised||(this.getElement(),b.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div));this._jsPlumb.div.style.left=
b.component.x+b.d.minx+"px";this._jsPlumb.div.style.top=b.component.y+b.d.miny+"px"}});p.Overlays.Custom=function(b){this.type="Custom";m.apply(this,arguments)};t.extend(p.Overlays.Custom,m);p.Overlays.GuideLines=function(){var b=this;b.length=50;b.lineWidth=5;this.type="GuideLines";g.apply(this,arguments);p.jsPlumbUIComponent.apply(this,arguments);this.draw=function(e,a){a=e.pointAlongPathFrom(b.loc,b.length/2);var c=e.pointOnPath(b.loc),c=q.pointOnLine(a,c,b.length),f=q.perpendicularLineTo(a,c,
40),d=q.perpendicularLineTo(c,a,20);return{connector:e,head:a,tail:c,headLine:d,tailLine:f,minX:Math.min(a.x,c.x,d[0].x,d[1].x),minY:Math.min(a.y,c.y,d[0].y,d[1].y),maxX:Math.max(a.x,c.x,d[0].x,d[1].x),maxY:Math.max(a.y,c.y,d[0].y,d[1].y)}}};p.Overlays.Label=function(b){this.labelStyle=b.labelStyle;this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var e=p.extend({create:function(){return jsPlumb.createElement("div")}},b);p.Overlays.Custom.call(this,e);this.type="Label";this.label=
b.label||"";this.labelText=null;this.labelStyle&&(b=this.getElement(),this.labelStyle.font=this.labelStyle.font||"12px sans-serif",b.style.font=this.labelStyle.font,b.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(b.style.background=this.labelStyle.fillStyle),0<this.labelStyle.borderWidth&&(b.style.border=this.labelStyle.borderWidth+"px solid "+(this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black")),this.labelStyle.padding&&(b.style.padding=this.labelStyle.padding))};
t.extend(p.Overlays.Label,p.Overlays.Custom,{cleanup:function(b){b&&(this.labelStyle=this.cssClass=this.labelText=this.label=this.div=null)},getLabel:function(){return this.label},setLabel:function(b){this.label=b;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){this.update();return m.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var b=this.label(this);this.getElement().innerHTML=
b.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(b){b.label&&this.setLabel(b.label)}})}).call("undefined"!==typeof window?window:this);
(function(){var l=this;l.jsPlumb.extend(l.jsPlumbInstance.prototype,{getEventManager:function(){var p=this._mottle;p||(p=this._mottle=new l.Mottle);return p},on:function(l,t,q){this.getEventManager().on.apply(this,arguments);return this},off:function(l,t,q){this.getEventManager().off.apply(this,arguments);return this}})}).call("undefined"!==typeof window?window:this);
(function(){var l=this,p=l.jsPlumbUtil,t=l.jsPlumbInstance,q=function(h){function b(a){delete a.proxies;var b=e[a.id],c;null!=b&&(c=function(b){return b.id===a.id},p.removeWithFunction(b.connections.source,c),p.removeWithFunction(b.connections.target,c),delete e[a.id]);b=k[a.id];null!=b&&(c=function(b){return b.id===a.id},p.removeWithFunction(b.connections.source,c),p.removeWithFunction(b.connections.target,c),delete k[a.id])}function g(a,b){a=a.getMembers();for(var c=0;c<a.length;c++)h[b?"show":
"hide"](a[c],!0)}function l(a){var b=a.getMembers(),c=h.getConnections({source:b},!0),b=h.getConnections({target:b},!0),f={};a.connections.source.length=0;a.connections.target.length=0;var g=function(b){for(var c=0;c<b.length;c++)f[b[c].id]||(f[b[c].id]=!0,b[c].source._jsPlumbGroup===a?(b[c].target._jsPlumbGroup!==a&&a.connections.source.push(b[c]),e[b[c].id]=a):b[c].target._jsPlumbGroup===a&&(a.connections.target.push(b[c]),k[b[c].id]=a))};g(c);g(b)}var m={},e={},k={};h.bind("connection",function(a){null!=
a.source._jsPlumbGroup&&null!=a.target._jsPlumbGroup&&a.source._jsPlumbGroup===a.target._jsPlumbGroup?(e[a.connection.id]=a.source._jsPlumbGroup,k[a.connection.id]=a.source._jsPlumbGroup):(null!=a.source._jsPlumbGroup&&(p.suggest(a.source._jsPlumbGroup.connections.source,a.connection),e[a.connection.id]=a.source._jsPlumbGroup),null!=a.target._jsPlumbGroup&&(p.suggest(a.target._jsPlumbGroup.connections.target,a.connection),k[a.connection.id]=a.target._jsPlumbGroup))});h.bind("connectionDetached",function(a){b(a.connection)});
h.bind("connectionMoved",function(a){var b=(0===a.index?e:k)[a.connection.id];b&&(b=b.connections[0===a.index?"source":"target"],a=b.indexOf(a.connection),-1!=a&&b.splice(a,1))});this.addGroup=function(a){h.addClass(a.el,"jsplumb-group-expanded");m[a.id]=a;a.manager=this;l(a);h.fire("group:add",{group:a})};this.addToGroup=function(a,b,c){(a=this.getGroup(a))&&a.add(b,c)};this.removeFromGroup=function(a,b,c){(a=this.getGroup(a))&&a.remove(b,null,c)};this.getGroup=function(a){var b=a;if(p.isString(a)&&
(b=m[a],null==b))throw new TypeError("No such group ["+a+"]");return b};this.getGroups=function(){var a=[],b;for(b in m)a.push(m[b]);return a};this.removeGroup=function(a,b){a=this.getGroup(a);this.expandGroup(a,!0);a[b?"removeAll":"orphanAll"]();h.remove(a.getEl());delete m[a.id];delete h._groups[a.id];h.fire("group:remove",{group:a})};this.removeAllGroups=function(a){for(var b in m)this.removeGroup(m[b],a)};var a=this.collapseConnection=function(a,b,c){var d=c.getEl(),f=h.getId(d),e=a.endpoints[b].elementId,
g=a.endpoints[0===b?1:0].element;g._jsPlumbGroup&&!g._jsPlumbGroup.shouldProxy()&&g._jsPlumbGroup.collapsed||(a.proxies=a.proxies||[],a.proxies[b]?c=a.proxies[b].ep:(c=h.addEndpoint(d,{endpoint:c.getEndpoint(a,b),anchor:c.getAnchor(a,b),parameters:{isProxyEndpoint:!0}}),c._forceDeleteOnDetach=!0),a.proxies[b]={ep:c,originalEp:a.endpoints[b]},0===b?h.anchorManager.sourceChanged(e,f,a,d):(h.anchorManager.updateOtherEndpoint(a.endpoints[0].elementId,e,f,a),a.target=d,a.targetId=f),a.proxies[b].originalEp.detachFromConnection(a,
null,!0),c.connections=[a],a.endpoints[b]=c,a.setVisible(!0))};this.collapseGroup=function(b){b=this.getGroup(b);if(null!=b&&!b.collapsed){var c=b.getEl();g(b,!1);if(b.shouldProxy()){var f=function(c,d){for(var f=0;f<c.length;f++)a(c[f],d,b)};f(b.connections.source,0);f(b.connections.target,1)}b.collapsed=!0;h.removeClass(c,"jsplumb-group-expanded");h.addClass(c,"jsplumb-group-collapsed");h.revalidate(c);h.fire("group:collapse",{group:b})}};var c=this.expandConnection=function(a,b,c){if(null!=a.proxies&&
null!=a.proxies[b]){c=h.getId(c.getEl());var d=a.proxies[b].originalEp.element,f=a.proxies[b].originalEp.elementId;a.endpoints[b]=a.proxies[b].originalEp;0===b?h.anchorManager.sourceChanged(c,f,a,d):(h.anchorManager.updateOtherEndpoint(a.endpoints[0].elementId,c,f,a),a.target=d,a.targetId=f);a.proxies[b].ep.detachFromConnection(a,null,!0);a.proxies[b].originalEp.addConnection(a);delete a.proxies[b]}};this.expandGroup=function(a,b){a=this.getGroup(a);if(null!=a&&a.collapsed){var d=a.getEl();g(a,!0);
if(a.shouldProxy()){var f=function(b,d){for(var f=0;f<b.length;f++)c(b[f],d,a)};f(a.connections.source,0);f(a.connections.target,1)}a.collapsed=!1;h.addClass(d,"jsplumb-group-expanded");h.removeClass(d,"jsplumb-group-collapsed");h.revalidate(d);this.repaintGroup(a);b||h.fire("group:expand",{group:a})}};this.repaintGroup=function(a){a=this.getGroup(a);a=a.getMembers();for(var b=0;b<a.length;b++)h.revalidate(a[b])};this.updateConnectionsForGroup=l;this.refreshAllGroups=function(){for(var a in m)l(m[a]),
h.dragManager.updateOffsets(h.getId(m[a].getEl()))}},n=function(h,b){function g(a,b){var c=h.getSize(a.offsetParent);a=h.getSize(a);var d=b[0];b=b[1];var f=b+a[1];return 0<d+a[0]&&d<c[0]&&0<f&&b<c[1]}function n(a){var b=h.getId(a),c=h.getOffset(a);a.parentNode.removeChild(a);h.getContainer().appendChild(a);h.setPosition(a,c);delete a._jsPlumbGroup;k(a);h.dragManager.clearParent(a,b)}function m(a){g(a.el,a.pos)||(a.el._jsPlumbGroup.remove(a.el),B?h.remove(a.el):n(a.el))}function e(a){var b=h.getId(a);
h.revalidate(a);h.dragManager.revalidateParent(a,b)}function k(a){a._katavorioDrag&&((B||M)&&a._katavorioDrag.off("stop",m),B||M||!w||(a._katavorioDrag.off("revert",e),a._katavorioDrag.setRevert(null)))}function a(a){if(a._katavorioDrag){if(B||M)a._katavorioDrag.on("stop",m);t&&a._katavorioDrag.setConstrain(!0);v&&a._katavorioDrag.setUseGhostProxy(!0);B||M||!w||(a._katavorioDrag.on("revert",e),a._katavorioDrag.setRevert(function(a,b){return!g(a,b)}))}}var c=this,f=b.el;this.getEl=function(){return f};
this.id=b.id||p.uuid();f._isJsPlumbGroup=!0;var d=h.getSelector(f,"[jsplumb-group-content]"),q=d&&0<d.length?d[0]:f,v=!0===b.ghost,t=v||!0===b.constrain,w=!1!==b.revert,M=!0===b.orphan,B=!0===b.prune,C=!0===b.dropOverride,D=!1!==b.proxied,x=[];this.connections={source:[],target:[],internal:[]};this.getAnchor=function(a,c){return b.anchor||"Continuous"};this.getEndpoint=function(a,c){return b.endpoint||["Dot",{radius:10}]};this.collapsed=!1;!1!==b.draggable&&(d={stop:function(a){h.fire("groupDragStop",
jsPlumb.extend(a,{group:c}))},scope:"_jsPlumbGroupDrag"},b.dragOptions&&l.jsPlumb.extend(d,b.dragOptions),h.draggable(b.el,d));!1!==b.droppable&&h.droppable(b.el,{drop:function(a){var b=h.getGroupManager(),d=a.drag.el;if(!d._isJsPlumbGroup){var e=d._jsPlumbGroup;if(e!==c){a=h.getOffset(d,!0);var g=c.collapsed?h.getOffset(f,!0):h.getOffset(q,!0);if(null!=e){if(e.overrideDrop(d,c))return;e.remove(d,!0);b.updateConnectionsForGroup(e)}c.add(d,!0);e=function(a,d){var e=0==d?1:0;a.each(function(a){a.setVisible(!1);
a.endpoints[e].element._jsPlumbGroup===c?(a.endpoints[e].setVisible(!1),b.expandConnection(a,e,c)):(a.endpoints[d].setVisible(!1),b.collapseConnection(a,d,c))})};c.collapsed&&(e(h.select({source:d}),0),e(h.select({target:d}),1));e=h.getId(d);h.dragManager.setParent(d,e,f,h.getId(f),a);h.setPosition(d,{left:a.left-g.left,top:a.top-g.top});h.dragManager.revalidateParent(d,e,a);b.updateConnectionsForGroup(c);setTimeout(function(){h.fire("group:addMember",{group:c,el:d})},0)}}}});var F=function(a,b){a=
null==a.nodeType?a:[a];for(var c=0;c<a.length;c++)b(a[c])};this.overrideDrop=function(a,b){return C&&(w||B||M)};this.add=function(b,d){F(b,function(b){b._jsPlumbGroup=c;x.push(b);h.isAlreadyDraggable(b)&&a(b);b.parentNode!=q&&q.appendChild(b);d||h.fire("group:addMember",{group:c,el:b})});h.getGroupManager().updateConnectionsForGroup(c)};this.remove=function(a,b,d,e){F(a,function(a){delete a._jsPlumbGroup;p.removeWithFunction(x,function(b){return b===a});if(b)try{c.getEl().removeChild(a)}catch(J){jsPlumbUtil.log("Could not remove element from Group "+
J)}k(a);d||h.fire("group:removeMember",{group:c,el:a})});e||h.getGroupManager().updateConnectionsForGroup(c)};this.removeAll=function(a,b){for(var d=0,e=x.length;d<e;d++)c.remove(x[0],a,b,!0);x.length=0;h.getGroupManager().updateConnectionsForGroup(c)};this.orphanAll=function(){for(var a=0;a<x.length;a++)n(x[a]);x.length=0};this.getMembers=function(){return x};f._jsPlumbGroup=this;h.bind("elementDraggable",function(b){b.el._jsPlumbGroup==this&&a(b.el)}.bind(this));this.shouldProxy=function(){return D};
h.getGroupManager().addGroup(this)};t.prototype.addGroup=function(h){this._groups=this._groups||{};if(null!=this._groups[h.id])throw new TypeError("cannot create Group ["+h.id+"]; a Group with that ID exists");if(null!=h.el._jsPlumbGroup)throw new TypeError("cannot create Group ["+h.id+"]; the given element is already a Group");h=new n(this,h);return this._groups[h.id]=h};t.prototype.addToGroup=function(h,b,g){this.getGroupManager().addToGroup(h,b,g)};t.prototype.removeFromGroup=function(h,b,g){this.getGroupManager().removeFromGroup(h,
b,g)};t.prototype.removeGroup=function(h,b){this.getGroupManager().removeGroup(h,b)};t.prototype.removeAllGroups=function(h){this.getGroupManager().removeAllGroups(h)};t.prototype.getGroup=function(h){return this.getGroupManager().getGroup(h)};t.prototype.getGroups=function(){return this.getGroupManager().getGroups()};t.prototype.expandGroup=function(h){this.getGroupManager().expandGroup(h)};t.prototype.collapseGroup=function(h){this.getGroupManager().collapseGroup(h)};t.prototype.repaintGroup=function(h){this.getGroupManager().repaintGroup(h)};
t.prototype.toggleGroup=function(h){h=this.getGroupManager().getGroup(h);if(null!=h)this.getGroupManager()[h.collapsed?"expandGroup":"collapseGroup"](h)};t.prototype.getGroupManager=function(){var h=this._groupManager;null==h&&(h=this._groupManager=new q(this));return h};t.prototype.removeGroupManager=function(){delete this._groupManager};t.prototype.getGroupFor=function(h){if(h=this.getElement(h))return h._jsPlumbGroup}}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumb,p=function(p){this.type="Flowchart";p=p||{};p.stub=null==p.stub?30:p.stub;var q,n=l.Connectors.AbstractConnector.apply(this,arguments),h=null==p.midpoint?.5:p.midpoint,b=!0===p.alwaysRespectStubs,g=null,r=null,m=null!=p.cornerRadius?p.cornerRadius:0,e=function(a){return 0>a?-1:0===a?0:1},k=function(a,b,c,f){if(g!=b||r!=c){var d=null==g?f.sx:g;f=null==r?f.sy:r;var h=d==b?"v":"h",k=e(b-d),l=e(c-f);g=b;r=c;a.push([d,f,b,c,h,k,l])}},a=function(a){return Math.sqrt(Math.pow(a[0]-
a[2],2)+Math.pow(a[1]-a[3],2))},c=function(a){var b=[];b.push.apply(b,a);return b},f=function(b,e,f){for(var d=null,g,h=0;h<e.length-1;h++){d=d||c(e[h]);g=c(e[h+1]);if(0<m&&d[4]!=g[4]){var k=Math.min(m,a(d),a(g));d[2]-=d[5]*k;d[3]-=d[6]*k;g[0]+=g[5]*k;g[1]+=g[6]*k;var l=d[6]==g[5]&&1==g[5]||d[6]==g[5]&&0===g[5]&&d[5]!=g[6]||d[6]==g[5]&&-1==g[5],p=(g[1]>d[3]?1:-1)==(g[0]>d[2]?1:-1),r=p&&l||!p&&!l?g[0]:d[2],p=p&&l||!p&&!l?d[3]:g[1];n.addSegment(b,"Straight",{x1:d[0],y1:d[1],x2:d[2],y2:d[3]});n.addSegment(b,
"Arc",{r:k,x1:d[2],y1:d[3],x2:g[0],y2:g[1],cx:r,cy:p,ac:l})}else k=d[2]==d[0]?0:d[2]>d[0]?f.lw/2:-(f.lw/2),l=d[3]==d[1]?0:d[3]>d[1]?f.lw/2:-(f.lw/2),n.addSegment(b,"Straight",{x1:d[0]-k,y1:d[1]-l,x2:d[2]+k,y2:d[3]+l});d=g}null!=g&&n.addSegment(b,"Straight",{x1:g[0],y1:g[1],x2:g[2],y2:g[3]})};this._compute=function(a,c){q=[];r=g=null;var d=function(){return[a.startStubX,a.startStubY,a.endStubX,a.endStubY]},d={perpendicular:d,orthogonal:d,opposite:function(c){var d="x"==c?0:1,e={x:function(){return 1==
a.so[d]&&(a.startStubX>a.endStubX&&a.tx>a.startStubX||a.sx>a.endStubX&&a.tx>a.sx)||-1==a.so[d]&&(a.startStubX<a.endStubX&&a.tx<a.startStubX||a.sx<a.endStubX&&a.tx<a.sx)},y:function(){return 1==a.so[d]&&(a.startStubY>a.endStubY&&a.ty>a.startStubY||a.sy>a.endStubY&&a.ty>a.sy)||-1==a.so[d]&&(a.startStubY<a.endStubY&&a.ty<a.startStubY||a.sy<a.endStubY&&a.ty<a.sy)}};return!b&&e[c]()?{x:[(a.sx+a.tx)/2,a.startStubY,(a.sx+a.tx)/2,a.endStubY],y:[a.startStubX,(a.sy+a.ty)/2,a.endStubX,(a.sy+a.ty)/2]}[c]:[a.startStubX,
a.startStubY,a.endStubX,a.endStubY]}}[a.anchorOrientation](a.sourceAxis),e="x"==a.sourceAxis?0:1,l="x"==a.sourceAxis?1:0,m=d[e],p=d[l],u=d[e+2],l=d[l+2];k(q,d[0],d[1],a);var t=a.startStubX+(a.endStubX-a.startStubX)*h,x=a.startStubY+(a.endStubY-a.startStubY)*h,F={x:[0,1],y:[1,0]};if(m={perpendicular:function(b){var c={x:[[a.startStubX,a.endStubX],null,[a.endStubX,a.startStubX]],y:[[a.startStubY,a.endStubY],null,[a.endStubY,a.startStubY]]},d={x:[[t,a.startStubY],[t,a.endStubY]],y:[[a.startStubX,x],
[a.endStubX,x]]},e={x:[[a.endStubX,a.startStubY]],y:[[a.startStubX,a.endStubY]]},f={x:[[a.startStubX,a.endStubY],[a.endStubX,a.endStubY]],y:[[a.endStubX,a.startStubY],[a.endStubX,a.endStubY]]},g={x:[[a.startStubX,x],[a.endStubX,x],[a.endStubX,a.endStubY]],y:[[t,a.startStubY],[t,a.endStubY],[a.endStubX,a.endStubY]]},h={x:[a.startStubY,a.endStubY],y:[a.startStubX,a.endStubX]},k=F[b][1],l=a.so[F[b][0]]+1,h=-1==a.to[k]&&h[b][1]<h[b][0]||1==a.to[k]&&h[b][1]>h[b][0],m=c[b][l][0],c=c[b][l][1],k={x:[[[1,
2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[b][l][a.to[k]+1];if(a.segment==k[3]||a.segment==k[2]&&h)return d[b];if(a.segment==k[2]&&c<m)return e[b];if(a.segment==k[2]&&c>=m||a.segment==k[1]&&!h)return g[b];if(a.segment==k[0]||a.segment==k[1]&&h)return f[b]},orthogonal:function(b,c,d,e,f){c={x:-1==a.so[0]?Math.min(c,e):Math.max(c,e),y:-1==a.so[1]?Math.min(c,e):Math.max(c,e)}[b];return{x:[[c,d],[c,f],[e,f]],y:[[d,c],[f,c],[f,
e]]}[b]},opposite:function(b,d,f,g){var h={x:"y",y:"x"}[b],k={x:"height",y:"width"}[b],l=a["is"+b.toUpperCase()+"GreaterThanStubTimes2"];if(c.sourceEndpoint.elementId==c.targetEndpoint.elementId)return f=f+(1-c.sourceEndpoint.anchor[h])*c.sourceInfo[k]+n.maxStub,{x:[[d,f],[g,f]],y:[[f,d],[f,g]]}[b];if(!l||1==a.so[e]&&d>g||-1==a.so[e]&&d<g)return{x:[[d,x],[g,x]],y:[[t,d],[t,g]]}[b];if(1==a.so[e]&&d<g||-1==a.so[e]&&d>g)return{x:[[t,a.sy],[t,a.ty]],y:[[a.sx,x],[a.tx,x]]}[b]}}[a.anchorOrientation](a.sourceAxis,
m,p,u,l))for(p=0;p<m.length;p++)k(q,m[p][0],m[p][1],a);k(q,d[2],d[3],a);k(q,a.tx,a.ty,a);f(this,q,a)}};this.jsPlumbUtil.extend(p,l.Connectors.AbstractConnector);l.registerConnectorType(p,"Flowchart")}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumb,p=this.jsPlumbUtil;l.Connectors.AbstractBezierConnector=function(p){p=p||{};var n=!1!==p.showLoopback,h=p.margin||5,b=p.orientation&&"clockwise"===p.orientation,g=p.loopbackRadius||25,r=!1,m;this.overrideSetEditable=function(){return!r};this._compute=function(e,k){var a=k.sourcePos,c=k.targetPos,f=Math.abs(a[0]-c[0]),d=Math.abs(a[1]-c[1]);if(n&&k.sourceEndpoint.elementId===k.targetEndpoint.elementId){r=!0;a=k.sourcePos[0];k=k.sourcePos[1]-h;var c=k-g,l=a-g,p=c-g,f=2*
g,d=2*g;e.points[0]=l;e.points[1]=p;e.points[2]=f;e.points[3]=d;m.addSegment(this,"Arc",{loopback:!0,x1:a-l+4,y1:k-p,startAngle:0,endAngle:2*Math.PI,r:g,ac:!b,x2:a-l-4,y2:k-p,cx:a-l,cy:c-p})}else r=!1,this._computeBezier(e,k,a,c,f,d)};return m=l.Connectors.AbstractConnector.apply(this,arguments)};p.extend(l.Connectors.AbstractBezierConnector,l.Connectors.AbstractConnector);var t=function(p){p=p||{};this.type="Bezier";var n=l.Connectors.AbstractBezierConnector.apply(this,arguments),h=p.curviness||
150;this.getCurviness=function(){return h};this._findControlPoint=function(b,g,l,m,e,k,a){m=[];k[0]==a[0]&&k[1]!=a[1]?(0===k[0]?m.push(g[0]<l[0]?b[0]+10:g[0]>l[0]?b[0]-10:0):m.push(b[0]-h*k[0]),0===k[1]?m.push(g[1]<l[1]?b[1]+10:b[1]-10):m.push(b[1]+h*a[1])):(0===a[0]?m.push(l[0]<g[0]?b[0]+10:b[0]-10):m.push(b[0]+h*a[0]),0===a[1]?m.push(l[1]<g[1]?b[1]+10:b[1]-10):m.push(b[1]+h*k[1]));return m};this._computeBezier=function(b,g,h,l,e,k){var a=this.getGeometry(),c=h[0]<l[0]?e:0,f=h[1]<l[1]?k:0;e=h[0]<
l[0]?0:e;var d=h[1]<l[1]?0:k;(this.hasBeenEdited()||this.isEditing())&&null!=a&&null!=a.controlPoints&&null!=a.controlPoints[0]&&null!=a.controlPoints[1]?(k=a.controlPoints[0],b=a.controlPoints[1]):(k=this._findControlPoint([c,f],h,l,g.sourceEndpoint,g.targetEndpoint,b.so,b.to),b=this._findControlPoint([e,d],l,h,g.targetEndpoint,g.sourceEndpoint,b.to,b.so));n.setGeometry({controlPoints:[k,b]},!0);n.addSegment(this,"Bezier",{x1:c,y1:f,x2:e,y2:d,cp1x:k[0],cp1y:k[1],cp2x:b[0],cp2y:b[1]})}};p.extend(t,
l.Connectors.AbstractBezierConnector);l.registerConnectorType(t,"Bezier")}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumb,p=function(p){p=p||{};this.type="StateMachine";var q=l.Connectors.AbstractBezierConnector.apply(this,arguments),n=p.curviness||10,h=p.margin||5,b=p.proximityLimit||80,g;this._computeBezier=function(l,m,e,k,a,c){l=m.sourcePos[0]<m.targetPos[0]?0:a;e=m.sourcePos[1]<m.targetPos[1]?0:c;a=m.sourcePos[0]<m.targetPos[0]?a:0;c=m.sourcePos[1]<m.targetPos[1]?c:0;0===m.sourcePos[2]&&(l-=h);1===m.sourcePos[2]&&(l+=h);0===m.sourcePos[3]&&(e-=h);1===m.sourcePos[3]&&(e+=h);0===m.targetPos[2]&&
(a-=h);1===m.targetPos[2]&&(a+=h);0===m.targetPos[3]&&(c-=h);1===m.targetPos[3]&&(c+=h);var f=(l+a)/2,d=(e+c)/2,p;p=l<=a&&c<=e?1:l<=a&&e<=c?2:a<=l&&c>=e?3:4;var r=Math.sqrt(Math.pow(a-l,2)+Math.pow(c-e,2));k=q.getGeometry();(this.hasBeenEdited()||this.isEditing())&&null!=k?(m=k.controlPoints[0][0],d=k.controlPoints[0][1],f=k.controlPoints[1][0],k=k.controlPoints[1][1]):(k=m.sourcePos,m=m.targetPos,g=r<=b?[f,d]:1===p?0>=k[3]&&1<=m[3]?[f+(.5>k[2]?-1*n:n),d]:1<=k[2]&&0>=m[2]?[f,d+(.5>k[3]?-1*n:n)]:[f+
-1*n,d+-1*n]:2===p?1<=k[3]&&0>=m[3]?[f+(.5>k[2]?-1*n:n),d]:1<=k[2]&&0>=m[2]?[f,d+(.5>k[3]?-1*n:n)]:[f+n,d+-1*n]:3===p?1<=k[3]&&0>=m[3]?[f+(.5>k[2]?-1*n:n),d]:0>=k[2]&&1<=m[2]?[f,d+(.5>k[3]?-1*n:n)]:[f+-1*n,d+-1*n]:4===p?0>=k[3]&&1<=m[3]?[f+(.5>k[2]?-1*n:n),d]:0>=k[2]&&1<=m[2]?[f,d+(.5>k[3]?-1*n:n)]:[f+n,d+-1*n]:void 0,m=g[0],f=g[0],d=g[1],k=g[1],q.setGeometry({controlPoints:[g,g]},!0));q.addSegment(this,"Bezier",{x1:a,y1:c,x2:l,y2:e,cp1x:m,cp1y:d,cp2x:f,cp2y:k})}};this.jsPlumbUtil.extend(p,l.Connectors.AbstractBezierConnector);
l.registerConnectorType(p,"StateMachine")}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumb,p=this.jsPlumbUtil,t={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},q=function(a,b){for(var c in b)a.setAttribute(c,""+b[c])},n=function(a,b){b=b||{};b.version="1.1";b.xmlns="http://www.w3.org/1999/xhtml";return jsPlumb.createElementNS("http://www.w3.org/2000/svg",a,null,null,b)},h=function(a){return"position:absolute;left:"+a[0]+"px;top:"+a[1]+"px"},b=function(a){a=a.querySelectorAll(" defs,linearGradient,radialGradient");
for(var b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b])},g=function(a,c,e,d,g){d="jsplumb_gradient_"+g._jsPlumb.instance.idstamp();b(a);var f;f=e.gradient.offset?n("radialGradient",{id:d}):n("linearGradient",{id:d,gradientUnits:"userSpaceOnUse"});var h=n("defs");a.appendChild(h);h.appendChild(f);for(a=0;a<e.gradient.stops.length;a++)h=n("stop",{offset:Math.floor(100*e.gradient.stops[a][0])+"%","stop-color":e.gradient.stops[1==g.segment||2==g.segment?a:e.gradient.stops.length-1-a][1]}),f.appendChild(h);
c.setAttribute(e.strokeStyle?"stroke":"fill","url(#"+d+")")},r=function(a,c,e,d,h){c.setAttribute("fill",e.fillStyle?e.fillStyle:"none");c.setAttribute("stroke",e.strokeStyle?e.strokeStyle:"none");e.gradient?g(a,c,e,d,h):(b(a),c.setAttribute("style",""));e.lineWidth&&c.setAttribute("stroke-width",e.lineWidth);if(e.dashstyle&&e.lineWidth&&!e["stroke-dasharray"]){var f=-1==e.dashstyle.indexOf(",")?" ":",",k="";e.dashstyle.split(f).forEach(function(a){k+=Math.floor(a*e.lineWidth)+f});c.setAttribute("stroke-dasharray",
k)}else e["stroke-dasharray"]&&c.setAttribute("stroke-dasharray",e["stroke-dasharray"]);for(var l in t)e[l]&&c.setAttribute(t[l],e[l])};p.svg={node:n,attr:q,pos:h};var m=function(a){var b=a.pointerEventsSpec||"all",e={};l.jsPlumbUIComponent.apply(this,a.originalArgs);this.bgCanvas=this.svg=this.path=this.canvas=null;var d=a.cssClass+" "+(a.originalArgs[0].cssClass||"");this.svg=n("svg",{style:"",width:0,height:0,"pointer-events":b,position:"absolute"});a.useDivWrapper?(this.canvas=jsPlumb.createElement("div",
{position:"absolute"}),p.sizeElement(this.canvas,0,0,1,1),this.canvas.className=d):(q(this.svg,{"class":d}),this.canvas=this.svg);a._jsPlumb.appendElement(this.canvas,a.originalArgs[0].parent);a.useDivWrapper&&this.canvas.appendChild(this.svg);var g=[this.canvas];this.getDisplayElements=function(){return g};this.appendDisplayElement=function(a){g.push(a)};this.paint=function(b,c,d){if(null!=b){var f=[this.x,this.y],g=[this.w,this.h];null!=d&&(0>d.xmin&&(f[0]+=d.xmin),0>d.ymin&&(f[1]+=d.ymin),g[0]=
d.xmax+(0>d.xmin?-d.xmin:0),g[1]=d.ymax+(0>d.ymin?-d.ymin:0));a.useDivWrapper?(p.sizeElement(this.canvas,f[0],f[1],g[0],g[1]),f[0]=0,f[1]=0,f=h([0,0])):f=h([f[0],f[1]]);e.paint.apply(this,arguments);q(this.svg,{style:f,width:g[0]||0,height:g[1]||0})}};return{renderer:e}};p.extend(m,l.jsPlumbUIComponent,{cleanup:function(a){a||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&
this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.group=this.path=this.canvas=this.svg=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(a){a=a.getContainer();this.canvas&&null==this.canvas.parentNode&&a.appendChild(this.canvas);this.bgCanvas&&null==this.bgCanvas.parentNode&&
a.appendChild(this.bgCanvas)},setVisible:function(a){this.canvas&&(this.canvas.style.display=a?"block":"none")}});l.ConnectorRenderers.svg=function(a){var b=this,e=m.apply(this,[{cssClass:a._jsPlumb.connectorClass+(this.isEditable()?" "+a._jsPlumb.editableConnectorClass:""),originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:a._jsPlumb}]),d=this.setEditable;this.setEditable=function(a){a=d.apply(this,[a]);jsPlumb[a?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.editableConnectorClass)};
e.renderer.paint=function(c,d,e){d=b.getSegments();var f="",g=[0,0];0>e.xmin&&(g[0]=-e.xmin);0>e.ymin&&(g[1]=-e.ymin);if(0<d.length){for(e=0;e<d.length;e++)f+=l.Segments.svg.SegmentRenderer.getPath(d[e]),f+=" ";d={d:f,transform:"translate("+g[0]+","+g[1]+")","pointer-events":a["pointer-events"]||"visibleStroke"};e=[b.x,b.y,b.w,b.h];if(c.outlineColor){g=c.lineWidth+2*(c.outlineWidth||1);f=l.extend({},c);delete f.gradient;f.strokeStyle=c.outlineColor;f.lineWidth=g;if(null==b.bgPath){b.bgPath=n("path",
d);l.addClass(b.bgPath,l.connectorOutlineClass);var g=b.svg,h=b.bgPath;0<g.childNodes.length?g.insertBefore(h,g.childNodes[0]):g.appendChild(h)}else q(b.bgPath,d);r(b.svg,b.bgPath,f,e,b)}null==b.path?(b.path=n("path",d),d=b.svg,f=b.path,g=c.outlineColor?1:0,d.childNodes.length>g?d.insertBefore(f,d.childNodes[g]):d.appendChild(f)):q(b.path,d);r(b.svg,b.path,c,e,b)}}};p.extend(l.ConnectorRenderers.svg,m);l.Segments.svg={SegmentRenderer:{getPath:function(a){return{Straight:function(){var b=a.getCoordinates();
return"M "+b.x1+" "+b.y1+" L "+b.x2+" "+b.y2},Bezier:function(){var b=a.params;return"M "+b.x1+" "+b.y1+" C "+b.cp1x+" "+b.cp1y+" "+b.cp2x+" "+b.cp2y+" "+b.x2+" "+b.y2},Arc:function(){return"M"+a.x1+" "+a.y1+" A "+a.radius+" "+a.params.r+" 0 "+(a.sweep>Math.PI?1:0)+","+(a.anticlockwise?0:1)+" "+a.x2+" "+a.y2}}[a.type]()}}};var e=l.SvgEndpoint=function(a){m.apply(this,[{cssClass:a._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:a._jsPlumb}]).renderer.paint=
function(a){a=l.extend({},a);a.outlineColor&&(a.strokeWidth=a.outlineWidth,a.strokeStyle=a.outlineColor);null==this.node?(this.node=this.makeNode(a),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node);r(this.svg,this.node,a,[this.x,this.y,this.w,this.h],this);h(this.node,[this.x,this.y])}.bind(this)};p.extend(e,m);l.Endpoints.svg.Dot=function(){l.Endpoints.Dot.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(a){return n("circle",{cx:this.w/2,cy:this.h/
2,r:this.radius})};this.updateNode=function(a){q(a,{cx:this.w/2,cy:this.h/2,r:this.radius})}};p.extend(l.Endpoints.svg.Dot,[l.Endpoints.Dot,e]);l.Endpoints.svg.Rectangle=function(){l.Endpoints.Rectangle.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(a){return n("rect",{width:this.w,height:this.h})};this.updateNode=function(a){q(a,{width:this.w,height:this.h})}};p.extend(l.Endpoints.svg.Rectangle,[l.Endpoints.Rectangle,e]);l.Endpoints.svg.Image=l.Endpoints.Image;l.Endpoints.svg.Blank=
l.Endpoints.Blank;l.Overlays.svg.Label=l.Overlays.Label;l.Overlays.svg.Custom=l.Overlays.Custom;var k=function(a,b){a.apply(this,b);l.jsPlumbUIComponent.apply(this,b);this.isAppendedAtTopLevel=!1;this.path=null;this.paint=function(a,c){if(a.component.svg&&c){null==this.path&&(this.path=n("path",{"pointer-events":"all"}),a.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,a.component),this.canvas=a.component.svg);var d=b&&1==b.length?b[0].cssClass||"":"",e=[0,
0];0>c.xmin&&(e[0]=-c.xmin);0>c.ymin&&(e[1]=-c.ymin);c=this.path;var f;f=a.d;f=isNaN(f.cxy.x)||isNaN(f.cxy.y)?"":"M"+f.hxy.x+","+f.hxy.y+" L"+f.tail[0].x+","+f.tail[0].y+" L"+f.cxy.x+","+f.cxy.y+" L"+f.tail[1].x+","+f.tail[1].y+" L"+f.hxy.x+","+f.hxy.y;q(c,{d:f,"class":d,stroke:a.strokeStyle?a.strokeStyle:null,fill:a.fillStyle?a.fillStyle:null,transform:"translate("+e[0]+","+e[1]+")"})}};this.transfer=function(a){a.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),
a.canvas.appendChild(this.path))}};p.extend(k,[l.jsPlumbUIComponent,l.Overlays.AbstractOverlay],{cleanup:function(a){null!=this.path&&(a?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(a){this.path&&this.canvas&&null==this.path.parentNode&&this.canvas.appendChild(this.path)},setVisible:function(a){null!=this.path&&(this.path.style.display=a?"block":"none")}});l.Overlays.svg.Arrow=function(){k.apply(this,[l.Overlays.Arrow,
arguments])};p.extend(l.Overlays.svg.Arrow,[l.Overlays.Arrow,k]);l.Overlays.svg.PlainArrow=function(){k.apply(this,[l.Overlays.PlainArrow,arguments])};p.extend(l.Overlays.svg.PlainArrow,[l.Overlays.PlainArrow,k]);l.Overlays.svg.Diamond=function(){k.apply(this,[l.Overlays.Diamond,arguments])};p.extend(l.Overlays.svg.Diamond,[l.Overlays.Diamond,k]);l.Overlays.svg.GuideLines=function(){var a=null,b=this,e,d;l.Overlays.GuideLines.apply(this,arguments);this.paint=function(c,f){null==a&&(a=n("path"),c.connector.svg.appendChild(a),
b.attachListeners(a,c.connector),b.attachListeners(a,b),e=n("path"),c.connector.svg.appendChild(e),b.attachListeners(e,c.connector),b.attachListeners(e,b),d=n("path"),c.connector.svg.appendChild(d),b.attachListeners(d,c.connector),b.attachListeners(d,b));var h=[0,0];0>f.xmin&&(h[0]=-f.xmin);0>f.ymin&&(h[1]=-f.ymin);q(a,{d:g(c.head,c.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"});q(e,{d:g(c.tailLine[0],c.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+
h[1]+")"});q(d,{d:g(c.headLine[0],c.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};var g=function(a,b){return"M "+a.x+","+a.y+" L"+b.x+","+b.y}};p.extend(l.Overlays.svg.GuideLines,l.Overlays.GuideLines)}).call("undefined"!==typeof window?window:this);
(function(){var l=this.jsPlumb,p=this.jsPlumbUtil,t=this.Katavorio,q=this.Biltong,n=function(b,g){g="_katavorio_"+(g||"main");var h=b[g],l=b.getEventManager();h||(h=new t({bind:l.on,unbind:l.off,getSize:jsPlumb.getSize,getPosition:function(e,g){e=b.getOffset(e,g,e._katavorioDrag?e.offsetParent:null);return[e.left,e.top]},setPosition:function(b,g){b.style.left=g[0]+"px";b.style.top=g[1]+"px"},addClass:jsPlumb.addClass,removeClass:jsPlumb.removeClass,intersects:q.intersects,indexOf:function(b,g){return b.indexOf(g)},
css:{noSelect:b.dragSelectClass,droppable:"jsplumb-droppable",draggable:"jsplumb-draggable",drag:"jsplumb-drag",selected:"jsplumb-drag-selected",active:"jsplumb-drag-active",hover:"jsplumb-drag-hover",ghostProxy:"jsplumb-ghost-proxy"}}),b[g]=h,b.bind("zoom",h.setZoom));return h},h=function(b,g){var h=function(h){if(null!=g[h]){if(p.isString(g[h])){var e=g[h].match(/-=/)?-1:1,k=g[h].substring(2);return b[h]+e*k}return g[h]}return b[h]};return[h("left"),h("top")]};l.extend(this.jsPlumbInstance.prototype,
{animationSupported:!0,getElement:function(b){if(null==b)return null;b="string"===typeof b?b:null!=b.length&&null==b.enctype?b[0]:b;return"string"===typeof b?document.getElementById(b):b},removeElement:function(b){n(this).elementRemoved(b);this.getEventManager().remove(b)},doAnimate:function(b,g,l){l=l||{};var m=this.getOffset(b);g=h(m,g);var e=l.duration||250,k=e/15,a=15/e*(g[0]-m.left),c=15/e*(g[1]-m.top),f=0,d=setInterval(function(){jsPlumb.setPosition(b,{left:m.left+a*(f+1),top:m.top+c*(f+1)});
null!=l.step&&l.step(f,Math.ceil(k));f++;f>=k&&(window.clearInterval(d),null!=l.complete&&l.complete())},15)},destroyDraggable:function(b,g){n(this,g).destroyDraggable(b)},destroyDroppable:function(b,g){n(this,g).destroyDroppable(b)},initDraggable:function(b,g,h){n(this,h).draggable(b,g)},initDroppable:function(b,g,h){n(this,h).droppable(b,g)},isAlreadyDraggable:function(b){return null!=b._katavorioDrag},isDragSupported:function(b,g){return!0},isDropSupported:function(b,g){return!0},isElementDraggable:function(b){b=
jsPlumb.getElement(b);return b._katavorioDrag&&b._katavorioDrag.isEnabled()},getDragObject:function(b){return b[0].drag.getDragElement()},getDragScope:function(b){return b._katavorioDrag&&b._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(b){return b[0].e},getUIPosition:function(b,g){g=b[0].el;if(null==g.offsetParent)return null;b=b[0].finalPos||b[0].pos;b={left:b[0],top:b[1]};g._katavorioDrag&&g.offsetParent!==this.getContainer()&&(g=this.getOffset(g.offsetParent),b.left+=g.left,b.top+=
g.top);return b},setDragFilter:function(b,g,h){b._katavorioDrag&&b._katavorioDrag.setFilter(g,h)},setElementDraggable:function(b,g){b=jsPlumb.getElement(b);b._katavorioDrag&&b._katavorioDrag.setEnabled(g)},setDragScope:function(b,g){b._katavorioDrag&&b._katavorioDrag.k.setDragScope(b,g)},setDropScope:function(b,g){b._katavorioDrop&&0<b._katavorioDrop.length&&b._katavorioDrop[0].k.setDropScope(b,g)},addToPosse:function(b,g){var h=Array.prototype.slice.call(arguments,1),l=n(this);jsPlumb.each(b,function(b){b=
[jsPlumb.getElement(b)];b.push.apply(b,h);l.addToPosse.apply(l,b)})},setPosse:function(b,g){var h=Array.prototype.slice.call(arguments,1),l=n(this);jsPlumb.each(b,function(b){b=[jsPlumb.getElement(b)];b.push.apply(b,h);l.setPosse.apply(l,b)})},removeFromPosse:function(b,g){var h=Array.prototype.slice.call(arguments,1),l=n(this);jsPlumb.each(b,function(b){b=[jsPlumb.getElement(b)];b.push.apply(b,h);l.removeFromPosse.apply(l,b)})},removeFromAllPosses:function(b){var g=n(this);jsPlumb.each(b,function(b){g.removeFromAllPosses(jsPlumb.getElement(b))})},
setPosseState:function(b,g,h){var l=n(this);jsPlumb.each(b,function(b){l.setPosseState(jsPlumb.getElement(b),g,h)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(b){b._katavorioDrag&&b._katavorioDrag.abort()},addToDragSelection:function(b){n(this).select(b)},removeFromDragSelection:function(b){n(this).deselect(b)},clearDragSelection:function(){n(this).deselectAll()},
trigger:function(b,g,h,l){this.getEventManager().trigger(b,g,h,l)},doReset:function(){for(var b in this)0===b.indexOf("_katavorio_")&&this[b].reset()}});(function(b){var g=function(){/complete|loaded|interactive/.test(document.readyState)&&"undefined"!=typeof document.body&&null!=document.body?b():setTimeout(g,9)};g()})(l.init)}).call("undefined"!==typeof window?window:this);